/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 This file is part of mscgen_js.

 mscgen_js is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 mscgen_js is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
 */

/**
 * @license
 * lodash 3.10.1 (Custom Build) <https://lodash.com/>
 * Build: `lodash compat exports="umd" include="memoize,cloneDeep,flatten,defaults" --development --output src/lib/lodash/lodash.custom.js`
 * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 */

(function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.slice(0,v.length-1).concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){var n=p.call(arguments,0);return typeof n[0]!="string"&&n.length===1&&n.push(null),s.apply(r,n.concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){if(typeof e!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../../node_modules/almond/almond",function(){}),n("lib/mscgenjs-core/parse/xuparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function Mi(){return e.substring(Ni,Ti)}function _i(){return Bi(Ni,Ti)}function Di(t){throw Fi(null,[{type:"other",description:t}],e.substring(Ni,Ti),Bi(Ni,Ti))}function Pi(t){throw Fi(t,null,e.substring(Ni,Ti),Bi(Ni,Ti))}function Hi(t){var n=Ci[t],r,i;if(n)return n;r=t-1;while(!Ci[r])r--;n=Ci[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Ci[t]=n,n}function Bi(e,t){var n=Hi(e),r=Hi(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function ji(e){if(Ti<ki)return;Ti>ki&&(ki=Ti,Li=[]),Li.push(e)}function Fi(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function Ii(){var t,n,r,s,o,h,p,d,v,m;return t=Ti,n=Ns(),n!==i?(r=qi(),r!==i?(s=Ns(),s!==i?(e.charCodeAt(Ti)===123?(o=u,Ti++):(o=i,Ai===0&&ji(a)),o!==i?(h=Ns(),h!==i?(p=Ri(),p!==i?(d=Ns(),d!==i?(e.charCodeAt(Ti)===125?(v=f,Ti++):(v=i,Ai===0&&ji(l)),v!==i?(m=Ns(),m!==i?(Ni=t,n=c(n,p),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t}function qi(){var t;return e.substr(Ti,3).toLowerCase()===h?(t=e.substr(Ti,3),Ti+=3):(t=i,Ai===0&&ji(p)),t===i&&(e.substr(Ti,2).toLowerCase()===d?(t=e.substr(Ti,2),Ti+=2):(t=i,Ai===0&&ji(v))),t}function Ri(){var e,t,n,r,s;return e=Ti,t=Ti,n=Ui(),n!==i&&(Ni=t,n=m(n)),t=n,t===i&&(t=null),t!==i?(n=Ti,r=Xi(),r!==i&&(Ni=n,r=g(r)),n=r,n===i&&(n=null),n!==i?(r=Ti,s=$i(),s!==i&&(Ni=r,s=y(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(Ti=e,e=i)):(Ti=e,e=i)):(Ti=e,e=i),e}function Ui(){var t,n,r,s,o,u;t=Ti,n=Ti,r=[],s=Ti,o=zi(),o!==i?(e.charCodeAt(Ti)===44?(u=b,Ti++):(u=i,Ai===0&&ji(w)),u!==i?(Ni=s,o=E(o),s=o):(Ti=s,s=i)):(Ti=s,s=i);while(s!==i)r.push(s),s=Ti,o=zi(),o!==i?(e.charCodeAt(Ti)===44?(u=b,Ti++):(u=i,Ai===0&&ji(w)),u!==i?(Ni=s,o=E(o),s=o):(Ti=s,s=i)):(Ti=s,s=i);return r!==i?(s=Ti,o=zi(),o!==i?(e.charCodeAt(Ti)===59?(u=S,Ti++):(u=i,Ai===0&&ji(x)),u!==i?(Ni=s,o=E(o),s=o):(Ti=s,s=i)):(Ti=s,s=i),s!==i?(r=[r,s],n=r):(Ti=n,n=i)):(Ti=n,n=i),n!==i&&(Ni=t,n=T(n)),t=n,t}function zi(){var t,n,r,s,o,u,a,f;return t=Ti,n=Ns(),n!==i?(r=Wi(),r!==i?(s=Ns(),s!==i?(e.charCodeAt(Ti)===61?(o=N,Ti++):(o=i,Ai===0&&ji(C)),o!==i?(u=Ns(),u!==i?(a=Ti,f=hs(),f!==i&&(Ni=a,f=k(r,f)),a=f,a===i&&(a=Ti,f=Cs(),f!==i&&(Ni=a,f=L(r,f)),a=f,a===i&&(a=Ti,f=As(),f!==i&&(Ni=a,f=A(r,f)),a=f)),a!==i?(f=Ns(),f!==i?(Ni=t,n=O(r,a),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t}function Wi(){var t;return e.substr(Ti,6).toLowerCase()===M?(t=e.substr(Ti,6),Ti+=6):(t=i,Ai===0&&ji(_)),t===i&&(e.substr(Ti,5).toLowerCase()===D?(t=e.substr(Ti,5),Ti+=5):(t=i,Ai===0&&ji(P)),t===i&&(e.substr(Ti,11).toLowerCase()===H?(t=e.substr(Ti,11),Ti+=11):(t=i,Ai===0&&ji(B)),t===i&&(e.substr(Ti,12).toLowerCase()===j?(t=e.substr(Ti,12),Ti+=12):(t=i,Ai===0&&ji(F)),t===i&&(e.substr(Ti,9).toLowerCase()===I?(t=e.substr(Ti,9),Ti+=9):(t=i,Ai===0&&ji(q)))))),t}function Xi(){var t,n,r,s,o,u;t=Ti,n=Ti,r=[],s=Ti,o=Vi(),o!==i?(e.charCodeAt(Ti)===44?(u=b,Ti++):(u=i,Ai===0&&ji(w)),u!==i?(Ni=s,o=R(o),s=o):(Ti=s,s=i)):(Ti=s,s=i);while(s!==i)r.push(s),s=Ti,o=Vi(),o!==i?(e.charCodeAt(Ti)===44?(u=b,Ti++):(u=i,Ai===0&&ji(w)),u!==i?(Ni=s,o=R(o),s=o):(Ti=s,s=i)):(Ti=s,s=i);return r!==i?(s=Ti,o=Vi(),o!==i?(e.charCodeAt(Ti)===59?(u=S,Ti++):(u=i,Ai===0&&ji(x)),u!==i?(Ni=s,o=R(o),s=o):(Ti=s,s=i)):(Ti=s,s=i),s!==i?(r=[r,s],n=r):(Ti=n,n=i)):(Ti=n,n=i),n!==i&&(Ni=t,n=U(n)),t=n,t}function Vi(){var t,n,r,s,o,u,a,f;return Ai++,t=Ti,n=Ns(),n!==i?(r=ds(),r!==i?(s=Ns(),s!==i?(o=Ti,e.charCodeAt(Ti)===91?(u=W,Ti++):(u=i,Ai===0&&ji(X)),u!==i?(a=fs(),a!==i?(e.charCodeAt(Ti)===93?(f=V,Ti++):(f=i,Ai===0&&ji($)),f!==i?(Ni=o,u=J(r,a),o=u):(Ti=o,o=i)):(Ti=o,o=i)):(Ti=o,o=i),o===i&&(o=null),o!==i?(u=Ns(),u!==i?(Ni=t,n=K(r,o),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),Ai--,t===i&&(n=i,Ai===0&&ji(z)),t}function $i(){var t,n,r,s,o;t=[],n=Ti,r=Ji(),r!==i?(s=Ns(),s!==i?(e.charCodeAt(Ti)===59?(o=S,Ti++):(o=i,Ai===0&&ji(x)),o!==i?(Ni=n,r=Q(r),n=r):(Ti=n,n=i)):(Ti=n,n=i)):(Ti=n,n=i);if(n!==i)while(n!==i)t.push(n),n=Ti,r=Ji(),r!==i?(s=Ns(),s!==i?(e.charCodeAt(Ti)===59?(o=S,Ti++):(o=i,Ai===0&&ji(x)),o!==i?(Ni=n,r=Q(r),n=r):(Ti=n,n=i)):(Ti=n,n=i)):(Ti=n,n=i);else t=i;return t}function Ji(){var t,n,r,s,o,u,a;t=Ti,n=Ti,r=[],s=Ti,o=Ki(),o!==i?(u=Ns(),u!==i?(e.charCodeAt(Ti)===44?(a=b,Ti++):(a=i,Ai===0&&ji(w)),a!==i?(Ni=s,o=Q(o),s=o):(Ti=s,s=i)):(Ti=s,s=i)):(Ti=s,s=i);while(s!==i)r.push(s),s=Ti,o=Ki(),o!==i?(u=Ns(),u!==i?(e.charCodeAt(Ti)===44?(a=b,Ti++):(a=i,Ai===0&&ji(w)),a!==i?(Ni=s,o=Q(o),s=o):(Ti=s,s=i)):(Ti=s,s=i)):(Ti=s,s=i);return r!==i?(s=Ti,o=Ki(),o!==i&&(Ni=s,o=G(o)),s=o,s!==i?(r=[r,s],n=r):(Ti=n,n=i)):(Ti=n,n=i),n!==i&&(Ni=t,n=Y(n)),t=n,t}function Ki(){var e;return e=Qi(),e===i&&(e=es()),e}function Qi(){var t,n,r,s,o,u;return t=Ti,n=Ti,r=Gi(),r!==i&&(Ni=n,r=Q(r)),n=r,n===i&&(n=Ti,r=Zi(),r!==i&&(Ni=n,r=Q(r)),n=r,n===i&&(n=Ti,r=Yi(),r!==i&&(Ni=n,r=Q(r)),n=r)),n!==i?(r=Ti,e.charCodeAt(Ti)===91?(s=W,Ti++):(s=i,Ai===0&&ji(X)),s!==i?(o=fs(),o!==i?(e.charCodeAt(Ti)===93?(u=V,Ti++):(u=i,Ai===0&&ji($)),u!==i?(Ni=r,s=Z(n,o),r=s):(Ti=r,r=i)):(Ti=r,r=i)):(Ti=r,r=i),r===i&&(r=null),r!==i?(Ni=t,n=et(n,r),t=n):(Ti=t,t=i)):(Ti=t,t=i),t}function Gi(){var e,t,n,r;return e=Ti,t=Ns(),t!==i?(n=ts(),n!==i?(r=Ns(),r!==i?(Ni=e,t=tt(n),e=t):(Ti=e,e=i)):(Ti=e,e=i)):(Ti=e,e=i),e}function Yi(){var e,t,n,r;return e=Ti,t=Ns(),t!==i?(n=ns(),n!==i?(r=Ns(),r!==i?(Ni=e,t=tt(n),e=t):(Ti=e,e=i)):(Ti=e,e=i)):(Ti=e,e=i),e}function Zi(){var t,n,r,s,o,u,a,f;return t=Ti,n=Ns(),n!==i?(r=ds(),r!==i?(s=Ns(),s!==i?(o=rs(),o!==i?(u=Ns(),u!==i?(a=ds(),a!==i?(f=Ns(),f!==i?(Ni=t,n=nt(r,o,a),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t===i&&(t=Ti,n=Ns(),n!==i?(e.charCodeAt(Ti)===42?(r=rt,Ti++):(r=i,Ai===0&&ji(it)),r!==i?(s=Ns(),s!==i?(o=os(),o!==i?(u=Ns(),u!==i?(a=ds(),a!==i?(f=Ns(),f!==i?(Ni=t,n=st(o,a),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t===i&&(t=Ti,n=Ns(),n!==i?(r=ds(),r!==i?(s=Ns(),s!==i?(o=ss(),o!==i?(u=Ns(),u!==i?(e.charCodeAt(Ti)===42?(a=rt,Ti++):(a=i,Ai===0&&ji(it)),a!==i?(f=Ns(),f!==i?(Ni=t,n=ot(r,o),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t===i&&(t=Ti,n=Ns(),n!==i?(r=ds(),r!==i?(s=Ns(),s!==i?(o=is(),o!==i?(u=Ns(),u!==i?(e.charCodeAt(Ti)===42?(a=rt,Ti++):(a=i,Ai===0&&ji(it)),a!==i?(f=Ns(),f!==i?(Ni=t,n=ot(r,o),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)))),t}function es(){var t,n,r,s,o,c,h,p,d,v,m,g,y,b,w,E;return t=Ti,n=Ns(),n!==i?(r=ds(),r!==i?(s=Ns(),s!==i?(o=as(),o!==i?(c=Ns(),c!==i?(h=ds(),h!==i?(p=Ns(),p!==i?(d=Ti,e.charCodeAt(Ti)===91?(v=W,Ti++):(v=i,Ai===0&&ji(X)),v!==i?(m=fs(),m!==i?(e.charCodeAt(Ti)===93?(g=V,Ti++):(g=i,Ai===0&&ji($)),g!==i?(Ni=d,v=ut(r,o,h,m),d=v):(Ti=d,d=i)):(Ti=d,d=i)):(Ti=d,d=i),d===i&&(d=null),d!==i?(v=Ns(),v!==i?(e.charCodeAt(Ti)===123?(m=u,Ti++):(m=i,Ai===0&&ji(a)),m!==i?(g=Ns(),g!==i?(y=$i(),y===i&&(y=null),y!==i?(b=Ns(),b!==i?(e.charCodeAt(Ti)===125?(w=f,Ti++):(w=i,Ai===0&&ji(l)),w!==i?(E=Ns(),E!==i?(Ni=t,n=at(r,o,h,d,y),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t}function ts(){var t;return e.substr(Ti,3)===ft?(t=ft,Ti+=3):(t=i,Ai===0&&ji(lt)),t===i&&(e.substr(Ti,3)===ct?(t=ct,Ti+=3):(t=i,Ai===0&&ji(ht))),t}function ns(){var t;return e.substr(Ti,3)===pt?(t=pt,Ti+=3):(t=i,Ai===0&&ji(dt)),t}function rs(){var e,t;return e=Ti,t=is(),t===i&&(t=ss(),t===i&&(t=os(),t===i&&(t=us()))),t!==i&&(Ni=e,t=vt(t)),e=t,e}function is(){var t,n;return Ai++,e.substr(Ti,2)===gt?(t=gt,Ti+=2):(t=i,Ai===0&&ji(yt)),t===i&&(e.substr(Ti,3)===bt?(t=bt,Ti+=3):(t=i,Ai===0&&ji(wt)),t===i&&(e.substr(Ti,2)===Et?(t=Et,Ti+=2):(t=i,Ai===0&&ji(St)),t===i&&(e.substr(Ti,5)===xt?(t=xt,Ti+=5):(t=i,Ai===0&&ji(Tt)),t===i&&(e.substr(Ti,3)===Nt?(t=Nt,Ti+=3):(t=i,Ai===0&&ji(Ct)),t===i&&(e.substr(Ti,2)===kt?(t=kt,Ti+=2):(t=i,Ai===0&&ji(Lt)),t===i&&(e.substr(Ti,4)===At?(t=At,Ti+=4):(t=i,Ai===0&&ji(Ot)),t===i&&(e.substr(Ti,2)===Mt?(t=Mt,Ti+=2):(t=i,Ai===0&&ji(_t)),t===i&&(e.substr(Ti,3)===Dt?(t=Dt,Ti+=3):(t=i,Ai===0&&ji(Pt)))))))))),Ai--,t===i&&(n=i,Ai===0&&ji(mt)),t}function ss(){var t,n;return Ai++,e.substr(Ti,2)===Bt?(t=Bt,Ti+=2):(t=i,Ai===0&&ji(jt)),t===i&&(e.substr(Ti,3)===Ft?(t=Ft,Ti+=3):(t=i,Ai===0&&ji(It)),t===i&&(e.substr(Ti,2)===qt?(t=qt,Ti+=2):(t=i,Ai===0&&ji(Rt)),t===i&&(e.substr(Ti,2)===Ut?(t=Ut,Ti+=2):(t=i,Ai===0&&ji(zt)),t===i&&(e.substr(Ti,2)===Wt?(t=Wt,Ti+=2):(t=i,Ai===0&&ji(Xt)),t===i&&(e.substr(Ti,2).toLowerCase()===Vt?(t=e.substr(Ti,2),Ti+=2):(t=i,Ai===0&&ji($t))))))),Ai--,t===i&&(n=i,Ai===0&&ji(Ht)),t}function os(){var t,n;return Ai++,e.substr(Ti,2)===Kt?(t=Kt,Ti+=2):(t=i,Ai===0&&ji(Qt)),t===i&&(e.substr(Ti,3)===Gt?(t=Gt,Ti+=3):(t=i,Ai===0&&ji(Yt)),t===i&&(e.substr(Ti,2)===Zt?(t=Zt,Ti+=2):(t=i,Ai===0&&ji(en)),t===i&&(e.substr(Ti,2)===tn?(t=tn,Ti+=2):(t=i,Ai===0&&ji(nn)),t===i&&(e.substr(Ti,2)===rn?(t=rn,Ti+=2):(t=i,Ai===0&&ji(sn)),t===i&&(e.substr(Ti,2).toLowerCase()===on?(t=e.substr(Ti,2),Ti+=2):(t=i,Ai===0&&ji(un))))))),Ai--,t===i&&(n=i,Ai===0&&ji(Jt)),t}function us(){var t,n;return Ai++,e.substr(Ti,4).toLowerCase()===fn?(t=e.substr(Ti,4),Ti+=4):(t=i,Ai===0&&ji(ln)),t===i&&(e.substr(Ti,4).toLowerCase()===cn?(t=e.substr(Ti,4),Ti+=4):(t=i,Ai===0&&ji(hn)),t===i&&(e.substr(Ti,4).toLowerCase()===pn?(t=e.substr(Ti,4),Ti+=4):(t=i,Ai===0&&ji(dn)),t===i&&(e.substr(Ti,3).toLowerCase()===vn?(t=e.substr(Ti,3),Ti+=3):(t=i,Ai===0&&ji(mn))))),Ai--,t===i&&(n=i,Ai===0&&ji(an)),t}function as(){var t,n;return Ai++,t=Ti,e.substr(Ti,3).toLowerCase()===yn?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji(bn)),n===i&&(e.substr(Ti,4).toLowerCase()===wn?(n=e.substr(Ti,4),Ti+=4):(n=i,Ai===0&&ji(En)),n===i&&(e.substr(Ti,3).toLowerCase()===Sn?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji(xn)),n===i&&(e.substr(Ti,5).toLowerCase()===Tn?(n=e.substr(Ti,5),Ti+=5):(n=i,Ai===0&&ji(Nn)),n===i&&(e.substr(Ti,3).toLowerCase()===Cn?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji(kn)),n===i&&(e.substr(Ti,3).toLowerCase()===Ln?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji(An)),n===i&&(e.substr(Ti,6).toLowerCase()===On?(n=e.substr(Ti,6),Ti+=6):(n=i,Ai===0&&ji(Mn)),n===i&&(e.substr(Ti,3).toLowerCase()===_n?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji(Dn)),n===i&&(e.substr(Ti,8).toLowerCase()===Pn?(n=e.substr(Ti,8),Ti+=8):(n=i,Ai===0&&ji(Hn)),n===i&&(e.substr(Ti,6).toLowerCase()===Bn?(n=e.substr(Ti,6),Ti+=6):(n=i,Ai===0&&ji(jn)),n===i&&(e.substr(Ti,8).toLowerCase()===Fn?(n=e.substr(Ti,8),Ti+=8):(n=i,Ai===0&&ji(In)),n===i&&(e.substr(Ti,6).toLowerCase()===qn?(n=e.substr(Ti,6),Ti+=6):(n=i,Ai===0&&ji(Rn)),n===i&&(e.substr(Ti,4).toLowerCase()===Un?(n=e.substr(Ti,4),Ti+=4):(n=i,Ai===0&&ji(zn)),n===i&&(e.substr(Ti,3).toLowerCase()===Wn?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji(Xn)),n===i&&(e.substr(Ti,3).toLowerCase()===Vn?(n=e.substr(Ti,3),Ti+=3):(n=i,Ai===0&&ji($n)))))))))))))))),n!==i&&(Ni=t,n=vt(n)),t=n,Ai--,t===i&&(n=i,Ai===0&&ji(gn)),t}function fs(){var t,n,r,s,o,u;t=Ti,n=Ti,r=[],s=Ti,o=ls(),o!==i?(e.charCodeAt(Ti)===44?(u=b,Ti++):(u=i,Ai===0&&ji(w)),u!==i?(Ni=s,o=Q(o),s=o):(Ti=s,s=i)):(Ti=s,s=i);while(s!==i)r.push(s),s=Ti,o=ls(),o!==i?(e.charCodeAt(Ti)===44?(u=b,Ti++):(u=i,Ai===0&&ji(w)),u!==i?(Ni=s,o=Q(o),s=o):(Ti=s,s=i)):(Ti=s,s=i);return r!==i?(s=Ti,o=ls(),o!==i&&(Ni=s,o=Q(o)),s=o,s!==i?(r=[r,s],n=r):(Ti=n,n=i)):(Ti=n,n=i),n!==i&&(Ni=t,n=Jn(n)),t=n,t}function ls(){var t,n,r,s,o,u,a,f;return t=Ti,n=Ns(),n!==i?(r=cs(),r!==i?(s=Ns(),s!==i?(e.charCodeAt(Ti)===61?(o=N,Ti++):(o=i,Ai===0&&ji(C)),o!==i?(u=Ns(),u!==i?(a=ds(),a!==i?(f=Ns(),f!==i?(Ni=t,n=Kn(r,a),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t}function cs(){var t,n;return Ai++,e.substr(Ti,5).toLowerCase()===Gn?(t=e.substr(Ti,5),Ti+=5):(t=i,Ai===0&&ji(Yn)),t===i&&(e.substr(Ti,5).toLowerCase()===Zn?(t=e.substr(Ti,5),Ti+=5):(t=i,Ai===0&&ji(er)),t===i&&(e.substr(Ti,2).toLowerCase()===tr?(t=e.substr(Ti,2),Ti+=2):(t=i,Ai===0&&ji(nr)),t===i&&(e.substr(Ti,3).toLowerCase()===rr?(t=e.substr(Ti,3),Ti+=3):(t=i,Ai===0&&ji(ir)),t===i&&(e.substr(Ti,9).toLowerCase()===sr?(t=e.substr(Ti,9),Ti+=9):(t=i,Ai===0&&ji(or)),t===i&&(e.substr(Ti,10).toLowerCase()===ur?(t=e.substr(Ti,10),Ti+=10):(t=i,Ai===0&&ji(ar)),t===i&&(e.substr(Ti,9).toLowerCase()===fr?(t=e.substr(Ti,9),Ti+=9):(t=i,Ai===0&&ji(lr)),t===i&&(e.substr(Ti,10).toLowerCase()===cr?(t=e.substr(Ti,10),Ti+=10):(t=i,Ai===0&&ji(hr)),t===i&&(e.substr(Ti,11).toLowerCase()===pr?(t=e.substr(Ti,11),Ti+=11):(t=i,Ai===0&&ji(dr)),t===i&&(e.substr(Ti,12).toLowerCase()===vr?(t=e.substr(Ti,12),Ti+=12):(t=i,Ai===0&&ji(mr)),t===i&&(e.substr(Ti,12).toLowerCase()===gr?(t=e.substr(Ti,12),Ti+=12):(t=i,Ai===0&&ji(yr)),t===i&&(e.substr(Ti,13).toLowerCase()===br?(t=e.substr(Ti,13),Ti+=13):(t=i,Ai===0&&ji(wr)),t===i&&(e.substr(Ti,12).toLowerCase()===Er?(t=e.substr(Ti,12),Ti+=12):(t=i,Ai===0&&ji(Sr)),t===i&&(e.substr(Ti,13).toLowerCase()===xr?(t=e.substr(Ti,13),Ti+=13):(t=i,Ai===0&&ji(Tr)),t===i&&(e.substr(Ti,14).toLowerCase()===Nr?(t=e.substr(Ti,14),Ti+=14):(t=i,Ai===0&&ji(Cr)),t===i&&(e.substr(Ti,15).toLowerCase()===kr?(t=e.substr(Ti,15),Ti+=15):(t=i,Ai===0&&ji(Lr)),t===i&&(e.substr(Ti,7).toLowerCase()===Ar?(t=e.substr(Ti,7),Ti+=7):(t=i,Ai===0&&ji(Or)))))))))))))))))),Ai--,t===i&&(n=i,Ai===0&&ji(Qn)),t}function hs(){var t,n,r,s;return t=Ti,e.charCodeAt(Ti)===34?(n=Mr,Ti++):(n=i,Ai===0&&ji(_r)),n!==i?(r=ps(),r!==i?(e.charCodeAt(Ti)===34?(s=Mr,Ti++):(s=i,Ai===0&&ji(_r)),s!==i?(Ni=t,n=Dr(r),t=n):(Ti=t,t=i)):(Ti=t,t=i)):(Ti=t,t=i),t}function ps(){var t,n,r,s;t=[],n=Ti,r=Ti,Ai++,e.charCodeAt(Ti)===34?(s=Mr,Ti++):(s=i,Ai===0&&ji(_r)),Ai--,s===i?r=void 0:(Ti=r,r=i),r!==i?(e.substr(Ti,2)===Pr?(s=Pr,Ti+=2):(s=i,Ai===0&&ji(Hr)),s===i&&(e.length>Ti?(s=e.charAt(Ti),Ti++):(s=i,Ai===0&&ji(Br))),s!==i?(Ni=n,r=jr(s),n=r):(Ti=n,n=i)):(Ti=n,n=i);while(n!==i)t.push(n),n=Ti,r=Ti,Ai++,e.charCodeAt(Ti)===34?(s=Mr,Ti++):(s=i,Ai===0&&ji(_r)),Ai--,s===i?r=void 0:(Ti=r,r=i),r!==i?(e.substr(Ti,2)===Pr?(s=Pr,Ti+=2):(s=i,Ai===0&&ji(Hr)),s===i&&(e.length>Ti?(s=e.charAt(Ti),Ti++):(s=i,Ai===0&&ji(Br))),s!==i?(Ni=n,r=jr(s),n=r):(Ti=n,n=i)):(Ti=n,n=i);return t}function ds(){var t,n,r;Ai++,t=Ti,n=[],Ir.test(e.charAt(Ti))?(r=e.charAt(Ti),Ti++):(r=i,Ai===0&&ji(qr));if(r!==i)while(r!==i)n.push(r),Ir.test(e.charAt(Ti))?(r=e.charAt(Ti),Ti++):(r=i,Ai===0&&ji(qr));else n=i;return n!==i&&(Ni=t,n=Rr(n)),t=n,t===i&&(t=hs()),Ai--,t===i&&(n=i,Ai===0&&ji(Fr)),t}function vs(){var t,n;return Ai++,t=Ti,zr.test(e.charAt(Ti))?(n=e.charAt(Ti),Ti++):(n=i,Ai===0&&ji(Wr)),n!==i&&(Ni=t,n=jr(n)),t=n,Ai--,t===i&&(n=i,Ai===0&&ji(Ur)),t}function ms(){var t,n;return Ai++,t=Ti,Vr.test(e.charAt(Ti))?(n=e.charAt(Ti),Ti++):(n=i,Ai===0&&ji($r)),n!==i&&(Ni=t,n=jr(n)),t=n,Ai--,t===i&&(n=i,Ai===0&&ji(Xr)),t}function gs(){var t;return e.substr(Ti,2)===Jr?(t=Jr,Ti+=2):(t=i,Ai===0&&ji(Kr)),t}function ys(){var t;return e.substr(Ti,2)===Qr?(t=Qr,Ti+=2):(t=i,Ai===0&&ji(Gr)),t}function bs(){var t,n,r;return t=Ti,n=Ti,Ai++,e.substr(Ti,2)===Qr?(r=Qr,Ti+=2):(r=i,Ai===0&&ji(Gr)),Ai--,r===i?n=void 0:(Ti=n,n=i),n!==i?(e.length>Ti?(r=e.charAt(Ti),Ti++):(r=i,Ai===0&&ji(Br)),r!==i?(Ni=t,n=jr(r),t=n):(Ti=t,t=i)):(Ti=t,t=i),t}function ws(){var e,t,n,r;e=Ti,t=gs();if(t!==i){n=[],r=bs();while(r!==i)n.push(r),r=bs();n!==i?(r=ys(),r!==i?(Ni=e,t=Yr(t,n,r),e=t):(Ti=e,e=i)):(Ti=e,e=i)}else Ti=e,e=i;return e}function Es(){var t;return e.substr(Ti,2)===Zr?(t=Zr,Ti+=2):(t=i,Ai===0&&ji(ei)),t===i&&(e.charCodeAt(Ti)===35?(t=ti,Ti++):(t=i,Ai===0&&ji(ni))),t}function Ss(){var t;return ri.test(e.charAt(Ti))?(t=e.charAt(Ti),Ti++):(t=i,Ai===0&&ji(ii)),t}function xs(){var e,t,n,r;e=Ti,t=Es();if(t!==i){n=[],r=Ss();while(r!==i)n.push(r),r=Ss();n!==i?(Ni=e,t=si(t,n),e=t):(Ti=e,e=i)}else Ti=e,e=i;return e}function Ts(){var e,t;return Ai++,e=xs(),e===i&&(e=ws()),Ai--,e===i&&(t=i,Ai===0&&ji(oi)),e}function Ns(){var e,t;e=[],t=vs(),t===i&&(t=ms(),t===i&&(t=Ts()));while(t!==i)e.push(t),t=vs(),t===i&&(t=ms(),t===i&&(t=Ts()));return e}function Cs(){var e;return e=Ls(),e===i&&(e=ks()),e}function ks(){var t,n,r;Ai++,t=Ti,n=[],ai.test(e.charAt(Ti))?(r=e.charAt(Ti),Ti++):(r=i,Ai===0&&ji(fi));if(r!==i)while(r!==i)n.push(r),ai.test(e.charAt(Ti))?(r=e.charAt(Ti),Ti++):(r=i,Ai===0&&ji(fi));else n=i;return n!==i&&(Ni=t,n=li(n)),t=n,Ai--,t===i&&(n=i,Ai===0&&ji(ui)),t}function Ls(){var t,n,r,s,o,u;Ai++,t=Ti,n=Ti,r=[],ai.test(e.charAt(Ti))?(s=e.charAt(Ti),Ti++):(s=i,Ai===0&&ji(fi));if(s!==i)while(s!==i)r.push(s),ai.test(e.charAt(Ti))?(s=e.charAt(Ti),Ti++):(s=i,Ai===0&&ji(fi));else r=i;if(r!==i){e.charCodeAt(Ti)===46?(s=hi,Ti++):(s=i,Ai===0&&ji(pi));if(s!==i){o=[],ai.test(e.charAt(Ti))?(u=e.charAt(Ti),Ti++):(u=i,Ai===0&&ji(fi));if(u!==i)while(u!==i)o.push(u),ai.test(e.charAt(Ti))?(u=e.charAt(Ti),Ti++):(u=i,Ai===0&&ji(fi));else o=i;o!==i?(r=[r,s,o],n=r):(Ti=n,n=i)}else Ti=n,n=i}else Ti=n,n=i;return n!==i&&(Ni=t,n=di(n)),t=n,Ai--,t===i&&(n=i,Ai===0&&ji(ci)),t}function As(){var t,n;return Ai++,e.substr(Ti,4).toLowerCase()===mi?(t=e.substr(Ti,4),Ti+=4):(t=i,Ai===0&&ji(gi)),t===i&&(e.substr(Ti,5).toLowerCase()===yi?(t=e.substr(Ti,5),Ti+=5):(t=i,Ai===0&&ji(bi)),t===i&&(e.substr(Ti,2).toLowerCase()===wi?(t=e.substr(Ti,2),Ti+=2):(t=i,Ai===0&&ji(Ei)),t===i&&(e.substr(Ti,3).toLowerCase()===Si?(t=e.substr(Ti,3),Ti+=3):(t=i,Ai===0&&ji(xi))))),Ai--,t===i&&(n=i,Ai===0&&ji(vi)),t}function Os(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function Ms(e,t){return e=e?e:{},Os(e,t),e}function _s(e){var t={};return e[0].forEach(function(e){t=Ms(t,e)}),Ms(t,e[1])}function Ds(e){return(["true","on","1"].indexOf(e.toLowerCase())>-1).toString()}function Ps(e,t){return t===undefined||t==="*"||e.entities.some(function(e){return e.name===t})}function Hs(e,t){return"Entity '"+e+"' in arc "+"'"+t.from+" "+t.kind+" "+t.to+"' "+"is not defined."}function Bs(e,t){this.name="EntityNotDefinedError",this.message=Hs(e,t),!t.location||(this.location=t.location,this.location.start.line++,this.location.end.line++)}function js(e,t){return e||(e={},e.entities=[]),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){if(t.from&&!Ps(e,t.from))throw new Bs(t.from,t);if(t.to&&!Ps(e,t.to))throw new Bs(t.to,t);!t.location||delete t.location,!t.arcs||js(e,t)})}),e}function Fs(e){return e&&e.options?e.options.watermark?!0:!1:!1}function Is(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function qs(e,t){var n=Fs(e),r=Is(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:Ii},o=Ii,u="{",a={type:"literal",value:"{",description:'"{"'},f="}",l={type:"literal",value:"}",description:'"}"'},c=function(e,t){t[1]=js(t[1],t[2]);var n=Ms(t[0],Ms(t[1],t[2]));return n=Ms({meta:qs(t[0],t[2])},n),e.length>0&&(n=Ms({precomment:e},n)),n},h="msc",p={type:"literal",value:"msc",description:'"msc"'},d="xu",v={type:"literal",value:"xu",description:'"xu"'},m=function(e){return{options:e}},g=function(e){return{entities:e}},y=function(e){return{arcs:e}},b=",",w={type:"literal",value:",",description:'","'},E=function(e){return e},S=";",x={type:"literal",value:";",description:'";"'},T=function(e){return _s(e)},N="=",C={type:"literal",value:"=",description:'"="'},k=function(e,t){return t},L=function(e,t){return t.toString()},A=function(e,t){return t.toString()},O=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=Ds(t):n[e]=t,n},M="hscale",_={type:"literal",value:"hscale",description:'"hscale"'},D="width",P={type:"literal",value:"width",description:'"width"'},H="arcgradient",B={type:"literal",value:"arcgradient",description:'"arcgradient"'},j="wordwraparcs",F={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},I="watermark",q={type:"literal",value:"watermark",description:'"watermark"'},R=function(e){return e},U=function(e){return e[0].push(e[1]),e[0]},z={type:"other",description:"entity"},W="[",X={type:"literal",value:"[",description:'"["'},V="]",$={type:"literal",value:"]",description:'"]"'},J=function(e,t){return t},K=function(e,t){return Ms({name:e},t)},Q=function(e){return e},G=function(e){return[e]},Y=function(e){return e[0].push(e[1][0]),e[0]},Z=function(e,t){return t},et=function(e,t){return Ms(e,t)},tt=function(e){return{kind:e}},nt=function(e,t,n){return{kind:t,from:e,to:n,location:_i()}},rt="*",it={type:"literal",value:"*",description:'"*"'},st=function(e,t){return{kind:e,from:"*",to:t,location:_i()}},ot=function(e,t){return{kind:t,from:e,to:"*",location:_i()}},ut=function(e,t,n,r){return r},at=function(e,t,n,r,i){var s={kind:t,from:e,to:n,location:_i(),arcs:i};return Ms(s,r)},ft="|||",lt={type:"literal",value:"|||",description:'"|||"'},ct="...",ht={type:"literal",value:"...",description:'"..."'},pt="---",dt={type:"literal",value:"---",description:'"---"'},vt=function(e){return e.toLowerCase()},mt={type:"other",description:"bi-directional arrow"},gt="--",yt={type:"literal",value:"--",description:'"--"'},bt="<->",wt={type:"literal",value:"<->",description:'"<->"'},Et="==",St={type:"literal",value:"==",description:'"=="'},xt="<<=>>",Tt={type:"literal",value:"<<=>>",description:'"<<=>>"'},Nt="<=>",Ct={type:"literal",value:"<=>",description:'"<=>"'},kt="..",Lt={type:"literal",value:"..",description:'".."'},At="<<>>",Ot={type:"literal",value:"<<>>",description:'"<<>>"'},Mt="::",_t={type:"literal",value:"::",description:'"::"'},Dt="<:>",Pt={type:"literal",value:"<:>",description:'"<:>"'},Ht={type:"other",description:"left to right arrow"},Bt="->",jt={type:"literal",value:"->",description:'"->"'},Ft="=>>",It={type:"literal",value:"=>>",description:'"=>>"'},qt="=>",Rt={type:"literal",value:"=>",description:'"=>"'},Ut=">>",zt={type:"literal",value:">>",description:'">>"'},Wt=":>",Xt={type:"literal",value:":>",description:'":>"'},Vt="-x",$t={type:"literal",value:"-x",description:'"-x"'},Jt={type:"other",description:"right to left arrow"},Kt="<-",Qt={type:"literal",value:"<-",description:'"<-"'},Gt="<<=",Yt={type:"literal",value:"<<=",description:'"<<="'},Zt="<=",en={type:"literal",value:"<=",description:'"<="'},tn="<<",nn={type:"literal",value:"<<",description:'"<<"'},rn="<:",sn={type:"literal",value:"<:",description:'"<:"'},on="x-",un={type:"literal",value:"x-",description:'"x-"'},an={type:"other",description:"box"},fn="note",ln={type:"literal",value:"note",description:'"note"'},cn="abox",hn={type:"literal",value:"abox",description:'"abox"'},pn="rbox",dn={type:"literal",value:"rbox",description:'"rbox"'},vn="box",mn={type:"literal",value:"box",description:'"box"'},gn={type:"other",description:"arc spanning box"},yn="alt",bn={type:"literal",value:"alt",description:'"alt"'},wn="else",En={type:"literal",value:"else",description:'"else"'},Sn="opt",xn={type:"literal",value:"opt",description:'"opt"'},Tn="break",Nn={type:"literal",value:"break",description:'"break"'},Cn="par",kn={type:"literal",value:"par",description:'"par"'},Ln="seq",An={type:"literal",value:"seq",description:'"seq"'},On="strict",Mn={type:"literal",value:"strict",description:'"strict"'},_n="neg",Dn={type:"literal",value:"neg",description:'"neg"'},Pn="critical",Hn={type:"literal",value:"critical",description:'"critical"'},Bn="ignore",jn={type:"literal",value:"ignore",description:'"ignore"'},Fn="consider",In={type:"literal",value:"consider",description:'"consider"'},qn="assert",Rn={type:"literal",value:"assert",description:'"assert"'},Un="loop",zn={type:"literal",value:"loop",description:'"loop"'},Wn="ref",Xn={type:"literal",value:"ref",description:'"ref"'},Vn="exc",$n={type:"literal",value:"exc",description:'"exc"'},Jn=function(e){return _s(e)},Kn=function(e,t){var n={};return e=e.toLowerCase(),e=e.replace("colour","color"),n[e]=t,n},Qn={type:"other",description:"attribute name"},Gn="label",Yn={type:"literal",value:"label",description:'"label"'},Zn="idurl",er={type:"literal",value:"idurl",description:'"idurl"'},tr="id",nr={type:"literal",value:"id",description:'"id"'},rr="url",ir={type:"literal",value:"url",description:'"url"'},sr="linecolor",or={type:"literal",value:"linecolor",description:'"linecolor"'},ur="linecolour",ar={type:"literal",value:"linecolour",description:'"linecolour"'},fr="textcolor",lr={type:"literal",value:"textcolor",description:'"textcolor"'},cr="textcolour",hr={type:"literal",value:"textcolour",description:'"textcolour"'},pr="textbgcolor",dr={type:"literal",value:"textbgcolor",description:'"textbgcolor"'},vr="textbgcolour",mr={type:"literal",value:"textbgcolour",description:'"textbgcolour"'},gr="arclinecolor",yr={type:"literal",value:"arclinecolor",description:'"arclinecolor"'},br="arclinecolour",wr={type:"literal",value:"arclinecolour",description:'"arclinecolour"'},Er="arctextcolor",Sr={type:"literal",value:"arctextcolor",description:'"arctextcolor"'},xr="arctextcolour",Tr={type:"literal",value:"arctextcolour",description:'"arctextcolour"'},Nr="arctextbgcolor",Cr={type:"literal",value:"arctextbgcolor",description:'"arctextbgcolor"'},kr="arctextbgcolour",Lr={type:"literal",value:"arctextbgcolour",description:'"arctextbgcolour"'},Ar="arcskip",Or={type:"literal",value:"arcskip",description:'"arcskip"'},Mr='"',_r={type:"literal",value:'"',description:'"\\""'},Dr=function(e){return e.join("")},Pr='\\"',Hr={type:"literal",value:'\\"',description:'"\\\\\\""'},Br={type:"any",description:"any character"},jr=function(e){return e},Fr={type:"other",description:"identifier"},Ir=/^[A-Za-z_0-9]/,qr={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},Rr=function(e){return e.join("")},Ur={type:"other",description:"whitespace"},zr=/^[ \t]/,Wr={type:"class",value:"[ \\t]",description:"[ \\t]"},Xr={type:"other",description:"lineend"},Vr=/^[\r\n]/,$r={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},Jr="/*",Kr={type:"literal",value:"/*",description:'"/*"'},Qr="*/",Gr={type:"literal",value:"*/",description:'"*/"'},Yr=function(e,t,n){return e+t.join("")+n},Zr="//",ei={type:"literal",value:"//",description:'"//"'},ti="#",ni={type:"literal",value:"#",description:'"#"'},ri=/^[^\r\n]/,ii={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},si=function(e,t){return e+t.join("")},oi={type:"other",description:"comment"},ui={type:"other",description:"integer"},ai=/^[0-9]/,fi={type:"class",value:"[0-9]",description:"[0-9]"},li=function(e){return parseInt(e.join(""),10)},ci={type:"other",description:"real"},hi=".",pi={type:"literal",value:".",description:'"."'},di=function(e){return parseFloat(e.join(""))},vi={type:"other",description:"boolean"},mi="true",gi={type:"literal",value:"true",description:'"true"'},yi="false",bi={type:"literal",value:"false",description:'"false"'},wi="on",Ei={type:"literal",value:"on",description:'"on"'},Si="off",xi={type:"literal",value:"off",description:'"off"'},Ti=0,Ni=0,Ci=[{line:1,column:1,seenCR:!1}],ki=0,Li=[],Ai=0,Oi;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Oi=o();if(Oi!==i&&Ti===e.length)return Oi;throw Oi!==i&&Ti<e.length&&ji({type:"end",description:"end of input"}),Fi(null,Li,ki<e.length?e.charAt(ki):null,ki<e.length?Bi(ki,ki+1):Bi(ki,ki))}return e(t,Error),{SyntaxError:t,parse:n}}),n("lib/mscgenjs-core/parse/msgennyparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function Vr(){return e.substring(qr,Ir)}function $r(){return Gr(qr,Ir)}function Jr(t){throw Zr(null,[{type:"other",description:t}],e.substring(qr,Ir),Gr(qr,Ir))}function Kr(t){throw Zr(t,null,e.substring(qr,Ir),Gr(qr,Ir))}function Qr(t){var n=Rr[t],r,i;if(n)return n;r=t-1;while(!Rr[r])r--;n=Rr[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Rr[t]=n,n}function Gr(e,t){var n=Qr(e),r=Qr(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function Yr(e){if(Ir<Ur)return;Ir>Ur&&(Ur=Ir,zr=[]),zr.push(e)}function Zr(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function ei(){var e,t,n,r;return e=Ir,t=Ii(),t!==i?(n=ti(),n!==i?(r=Ii(),r!==i?(qr=e,t=u(t,n),e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function ti(){var e,t,n,r,s;return e=Ir,t=Ir,n=ni(),n!==i&&(qr=t,n=a(n)),t=n,t===i&&(t=null),t!==i?(n=Ir,r=si(),r!==i&&(qr=n,r=f(r)),n=r,n===i&&(n=null),n!==i?(r=Ir,s=ui(),s!==i&&(qr=r,s=l(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function ni(){var t,n,r,s,o,u;t=Ir,n=Ir,r=[],s=Ir,o=ri(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=p(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);while(s!==i)r.push(s),s=Ir,o=ri(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=p(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);return r!==i?(s=Ir,o=ri(),o!==i?(e.charCodeAt(Ir)===59?(u=d,Ir++):(u=i,Wr===0&&Yr(v)),u!==i?(qr=s,o=p(o),s=o):(Ir=s,s=i)):(Ir=s,s=i),s!==i?(r=[r,s],n=r):(Ir=n,n=i)):(Ir=n,n=i),n!==i&&(qr=t,n=m(n)),t=n,t}function ri(){var t,n,r,s,o,u,a,f;return t=Ir,n=Ii(),n!==i?(r=ii(),r!==i?(s=Ii(),s!==i?(e.charCodeAt(Ir)===61?(o=g,Ir++):(o=i,Wr===0&&Yr(y)),o!==i?(u=Ii(),u!==i?(a=Ir,f=Ti(),f!==i&&(qr=a,f=b(r,f)),a=f,a===i&&(a=Ir,f=qi(),f!==i&&(qr=a,f=w(r,f)),a=f,a===i&&(a=Ir,f=zi(),f!==i&&(qr=a,f=E(r,f)),a=f)),a!==i?(f=Ii(),f!==i?(qr=t,n=S(r,a),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t}function ii(){var t;return e.substr(Ir,6).toLowerCase()===x?(t=e.substr(Ir,6),Ir+=6):(t=i,Wr===0&&Yr(T)),t===i&&(e.substr(Ir,5).toLowerCase()===N?(t=e.substr(Ir,5),Ir+=5):(t=i,Wr===0&&Yr(C)),t===i&&(e.substr(Ir,11).toLowerCase()===k?(t=e.substr(Ir,11),Ir+=11):(t=i,Wr===0&&Yr(L)),t===i&&(e.substr(Ir,12).toLowerCase()===A?(t=e.substr(Ir,12),Ir+=12):(t=i,Wr===0&&Yr(O)),t===i&&(e.substr(Ir,9).toLowerCase()===M?(t=e.substr(Ir,9),Ir+=9):(t=i,Wr===0&&Yr(_)))))),t}function si(){var t,n,r,s,o,u;t=Ir,n=Ir,r=[],s=Ir,o=oi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=D(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);while(s!==i)r.push(s),s=Ir,o=oi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=D(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);return r!==i?(s=Ir,o=oi(),o!==i?(e.charCodeAt(Ir)===59?(u=d,Ir++):(u=i,Wr===0&&Yr(v)),u!==i?(qr=s,o=D(o),s=o):(Ir=s,s=i)):(Ir=s,s=i),s!==i?(r=[r,s],n=r):(Ir=n,n=i)):(Ir=n,n=i),n!==i&&(qr=t,n=P(n)),t=n,t}function oi(){var t,n,r,s,o,u,a,f,l;return Wr++,t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=Ir,e.charCodeAt(Ir)===58?(u=B,Ir++):(u=i,Wr===0&&Yr(j)),u!==i?(a=Ii(),a!==i?(f=xi(),f!==i?(l=Ii(),l!==i?(qr=o,u=F(r,f),o=u):(Ir=o,o=i)):(Ir=o,o=i)):(Ir=o,o=i)):(Ir=o,o=i),o===i&&(o=null),o!==i?(qr=t,n=I(r,o),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),Wr--,t===i&&(n=i,Wr===0&&Yr(H)),t}function ui(){var t,n,r,s,o;t=[],n=Ir,r=ai(),r!==i?(s=Ii(),s!==i?(e.charCodeAt(Ir)===59?(o=d,Ir++):(o=i,Wr===0&&Yr(v)),o!==i?(qr=n,r=q(r),n=r):(Ir=n,n=i)):(Ir=n,n=i)):(Ir=n,n=i);if(n!==i)while(n!==i)t.push(n),n=Ir,r=ai(),r!==i?(s=Ii(),s!==i?(e.charCodeAt(Ir)===59?(o=d,Ir++):(o=i,Wr===0&&Yr(v)),o!==i?(qr=n,r=q(r),n=r):(Ir=n,n=i)):(Ir=n,n=i)):(Ir=n,n=i);else t=i;return t}function ai(){var t,n,r,s,o,u;t=Ir,n=Ir,r=[],s=Ir,o=fi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=q(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);while(s!==i)r.push(s),s=Ir,o=fi(),o!==i?(e.charCodeAt(Ir)===44?(u=c,Ir++):(u=i,Wr===0&&Yr(h)),u!==i?(qr=s,o=q(o),s=o):(Ir=s,s=i)):(Ir=s,s=i);return r!==i?(s=Ir,o=fi(),o!==i&&(qr=s,o=R(o)),s=o,s!==i?(r=[r,s],n=r):(Ir=n,n=i)):(Ir=n,n=i),n!==i&&(qr=t,n=U(n)),t=n,t}function fi(){var e;return e=li(),e===i&&(e=di()),e}function li(){var t,n,r,s,o,u,a;return t=Ir,n=Ir,r=ci(),r!==i&&(qr=n,r=z(r)),n=r,n===i&&(n=Ir,r=pi(),r!==i&&(qr=n,r=W(r)),n=r,n===i&&(n=Ir,r=hi(),r!==i&&(qr=n,r=X(r)),n=r)),n!==i?(r=Ir,e.charCodeAt(Ir)===58?(s=B,Ir++):(s=i,Wr===0&&Yr(j)),s!==i?(o=Ii(),o!==i?(u=xi(),u!==i?(a=Ii(),a!==i?(qr=r,s=V(n,u),r=s):(Ir=r,r=i)):(Ir=r,r=i)):(Ir=r,r=i)):(Ir=r,r=i),r===i&&(r=null),r!==i?(qr=t,n=$(n,r),t=n):(Ir=t,t=i)):(Ir=t,t=i),t}function ci(){var e,t,n,r;return e=Ir,t=Ii(),t!==i?(n=vi(),n!==i?(r=Ii(),r!==i?(qr=e,t=J(n),e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function hi(){var e,t,n,r;return e=Ir,t=Ii(),t!==i?(n=mi(),n!==i?(r=Ii(),r!==i?(qr=e,t=J(n),e=t):(Ir=e,e=i)):(Ir=e,e=i)):(Ir=e,e=i),e}function pi(){var t,n,r,s,o,u,a,f;return t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=gi(),o!==i?(u=Ii(),u!==i?(a=Li(),a!==i?(f=Ii(),f!==i?(qr=t,n=K(r,o,a),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t===i&&(t=Ir,n=Ii(),n!==i?(e.charCodeAt(Ir)===42?(r=Q,Ir++):(r=i,Wr===0&&Yr(G)),r!==i?(s=Ii(),s!==i?(o=wi(),o!==i?(u=Ii(),u!==i?(a=Li(),a!==i?(f=Ii(),f!==i?(qr=t,n=Y(o,a),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t===i&&(t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=bi(),o!==i?(u=Ii(),u!==i?(e.charCodeAt(Ir)===42?(a=Q,Ir++):(a=i,Wr===0&&Yr(G)),a!==i?(f=Ii(),f!==i?(qr=t,n=Z(r,o),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t===i&&(t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=yi(),o!==i?(u=Ii(),u!==i?(e.charCodeAt(Ir)===42?(a=Q,Ir++):(a=i,Wr===0&&Yr(G)),a!==i?(f=Ii(),f!==i?(qr=t,n=Z(r,o),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)))),t}function di(){var t,n,r,s,o,u,a,f,l,c,h,p,d,v,m;return t=Ir,n=Ii(),n!==i?(r=Li(),r!==i?(s=Ii(),s!==i?(o=Si(),o!==i?(u=Ii(),u!==i?(a=Li(),a!==i?(f=Ii(),f!==i?(l=Ir,e.charCodeAt(Ir)===58?(c=B,Ir++):(c=i,Wr===0&&Yr(j)),c!==i?(h=Ii(),h!==i?(p=xi(),p!==i?(d=Ii(),d!==i?(qr=l,c=et(r,o,a,p),l=c):(Ir=l,l=i)):(Ir=l,l=i)):(Ir=l,l=i)):(Ir=l,l=i),l===i&&(l=null),l!==i?(e.charCodeAt(Ir)===123?(c=tt,Ir++):(c=i,Wr===0&&Yr(nt)),c!==i?(h=Ii(),h!==i?(p=ui(),p===i&&(p=null),p!==i?(d=Ii(),d!==i?(e.charCodeAt(Ir)===125?(v=rt,Ir++):(v=i,Wr===0&&Yr(it)),v!==i?(m=Ii(),m!==i?(qr=t,n=st(r,o,a,l,p),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t}function vi(){var t;return e.substr(Ir,3)===ot?(t=ot,Ir+=3):(t=i,Wr===0&&Yr(ut)),t===i&&(e.substr(Ir,3)===at?(t=at,Ir+=3):(t=i,Wr===0&&Yr(ft))),t}function mi(){var t;return e.substr(Ir,3)===lt?(t=lt,Ir+=3):(t=i,Wr===0&&Yr(ct)),t}function gi(){var e,t;return e=Ir,t=yi(),t===i&&(t=bi(),t===i&&(t=wi(),t===i&&(t=Ei()))),t!==i&&(qr=e,t=ht(t)),e=t,e}function yi(){var t,n;return Wr++,e.substr(Ir,2)===dt?(t=dt,Ir+=2):(t=i,Wr===0&&Yr(vt)),t===i&&(e.substr(Ir,3)===mt?(t=mt,Ir+=3):(t=i,Wr===0&&Yr(gt)),t===i&&(e.substr(Ir,2)===yt?(t=yt,Ir+=2):(t=i,Wr===0&&Yr(bt)),t===i&&(e.substr(Ir,5)===wt?(t=wt,Ir+=5):(t=i,Wr===0&&Yr(Et)),t===i&&(e.substr(Ir,3)===St?(t=St,Ir+=3):(t=i,Wr===0&&Yr(xt)),t===i&&(e.substr(Ir,2)===Tt?(t=Tt,Ir+=2):(t=i,Wr===0&&Yr(Nt)),t===i&&(e.substr(Ir,4)===Ct?(t=Ct,Ir+=4):(t=i,Wr===0&&Yr(kt)),t===i&&(e.substr(Ir,2)===Lt?(t=Lt,Ir+=2):(t=i,Wr===0&&Yr(At)),t===i&&(e.substr(Ir,3)===Ot?(t=Ot,Ir+=3):(t=i,Wr===0&&Yr(Mt)))))))))),Wr--,t===i&&(n=i,Wr===0&&Yr(pt)),t}function bi(){var t,n;return Wr++,e.substr(Ir,2)===Dt?(t=Dt,Ir+=2):(t=i,Wr===0&&Yr(Pt)),t===i&&(e.substr(Ir,3)===Ht?(t=Ht,Ir+=3):(t=i,Wr===0&&Yr(Bt)),t===i&&(e.substr(Ir,2)===jt?(t=jt,Ir+=2):(t=i,Wr===0&&Yr(Ft)),t===i&&(e.substr(Ir,2)===It?(t=It,Ir+=2):(t=i,Wr===0&&Yr(qt)),t===i&&(e.substr(Ir,2)===Rt?(t=Rt,Ir+=2):(t=i,Wr===0&&Yr(Ut)),t===i&&(e.substr(Ir,2).toLowerCase()===zt?(t=e.substr(Ir,2),Ir+=2):(t=i,Wr===0&&Yr(Wt))))))),Wr--,t===i&&(n=i,Wr===0&&Yr(_t)),t}function wi(){var t,n;return Wr++,e.substr(Ir,2)===Vt?(t=Vt,Ir+=2):(t=i,Wr===0&&Yr($t)),t===i&&(e.substr(Ir,3)===Jt?(t=Jt,Ir+=3):(t=i,Wr===0&&Yr(Kt)),t===i&&(e.substr(Ir,2)===Qt?(t=Qt,Ir+=2):(t=i,Wr===0&&Yr(Gt)),t===i&&(e.substr(Ir,2)===Yt?(t=Yt,Ir+=2):(t=i,Wr===0&&Yr(Zt)),t===i&&(e.substr(Ir,2)===en?(t=en,Ir+=2):(t=i,Wr===0&&Yr(tn)),t===i&&(e.substr(Ir,2).toLowerCase()===nn?(t=e.substr(Ir,2),Ir+=2):(t=i,Wr===0&&Yr(rn))))))),Wr--,t===i&&(n=i,Wr===0&&Yr(Xt)),t}function Ei(){var t,n;return Wr++,e.substr(Ir,4).toLowerCase()===on?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(un)),t===i&&(e.substr(Ir,4).toLowerCase()===an?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(fn)),t===i&&(e.substr(Ir,4).toLowerCase()===ln?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(cn)),t===i&&(e.substr(Ir,3).toLowerCase()===hn?(t=e.substr(Ir,3),Ir+=3):(t=i,Wr===0&&Yr(pn))))),Wr--,t===i&&(n=i,Wr===0&&Yr(sn)),t}function Si(){var t,n;return Wr++,t=Ir,e.substr(Ir,3).toLowerCase()===vn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(mn)),n===i&&(e.substr(Ir,4).toLowerCase()===gn?(n=e.substr(Ir,4),Ir+=4):(n=i,Wr===0&&Yr(yn)),n===i&&(e.substr(Ir,3).toLowerCase()===bn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(wn)),n===i&&(e.substr(Ir,5).toLowerCase()===En?(n=e.substr(Ir,5),Ir+=5):(n=i,Wr===0&&Yr(Sn)),n===i&&(e.substr(Ir,3).toLowerCase()===xn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Tn)),n===i&&(e.substr(Ir,3).toLowerCase()===Nn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Cn)),n===i&&(e.substr(Ir,6).toLowerCase()===kn?(n=e.substr(Ir,6),Ir+=6):(n=i,Wr===0&&Yr(Ln)),n===i&&(e.substr(Ir,3).toLowerCase()===An?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(On)),n===i&&(e.substr(Ir,8).toLowerCase()===Mn?(n=e.substr(Ir,8),Ir+=8):(n=i,Wr===0&&Yr(_n)),n===i&&(e.substr(Ir,6).toLowerCase()===Dn?(n=e.substr(Ir,6),Ir+=6):(n=i,Wr===0&&Yr(Pn)),n===i&&(e.substr(Ir,8).toLowerCase()===Hn?(n=e.substr(Ir,8),Ir+=8):(n=i,Wr===0&&Yr(Bn)),n===i&&(e.substr(Ir,6).toLowerCase()===jn?(n=e.substr(Ir,6),Ir+=6):(n=i,Wr===0&&Yr(Fn)),n===i&&(e.substr(Ir,4).toLowerCase()===In?(n=e.substr(Ir,4),Ir+=4):(n=i,Wr===0&&Yr(qn)),n===i&&(e.substr(Ir,3).toLowerCase()===Rn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Un)),n===i&&(e.substr(Ir,3).toLowerCase()===zn?(n=e.substr(Ir,3),Ir+=3):(n=i,Wr===0&&Yr(Wn)))))))))))))))),n!==i&&(qr=t,n=ht(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(dn)),t}function xi(){var e;return e=Ti(),e===i&&(e=Ci()),e}function Ti(){var t,n,r,s;return t=Ir,e.charCodeAt(Ir)===34?(n=Xn,Ir++):(n=i,Wr===0&&Yr(Vn)),n!==i?(r=Ni(),r!==i?(e.charCodeAt(Ir)===34?(s=Xn,Ir++):(s=i,Wr===0&&Yr(Vn)),s!==i?(qr=t,n=$n(r),t=n):(Ir=t,t=i)):(Ir=t,t=i)):(Ir=t,t=i),t}function Ni(){var t,n,r,s;t=[],n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===34?(s=Xn,Ir++):(s=i,Wr===0&&Yr(Vn)),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.substr(Ir,2)===Jn?(s=Jn,Ir+=2):(s=i,Wr===0&&Yr(Kn)),s===i&&(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn))),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);while(n!==i)t.push(n),n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===34?(s=Xn,Ir++):(s=i,Wr===0&&Yr(Vn)),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.substr(Ir,2)===Jn?(s=Jn,Ir+=2):(s=i,Wr===0&&Yr(Kn)),s===i&&(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn))),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);return t}function Ci(){var e,t;return e=Ir,t=ki(),t!==i&&(qr=e,t=Yn(t)),e=t,e}function ki(){var t,n,r,s;t=[],n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===44?(s=c,Ir++):(s=i,Wr===0&&Yr(h)),s===i&&(e.charCodeAt(Ir)===59?(s=d,Ir++):(s=i,Wr===0&&Yr(v)),s===i&&(e.charCodeAt(Ir)===123?(s=tt,Ir++):(s=i,Wr===0&&Yr(nt)))),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn)),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);while(n!==i)t.push(n),n=Ir,r=Ir,Wr++,e.charCodeAt(Ir)===44?(s=c,Ir++):(s=i,Wr===0&&Yr(h)),s===i&&(e.charCodeAt(Ir)===59?(s=d,Ir++):(s=i,Wr===0&&Yr(v)),s===i&&(e.charCodeAt(Ir)===123?(s=tt,Ir++):(s=i,Wr===0&&Yr(nt)))),Wr--,s===i?r=void 0:(Ir=r,r=i),r!==i?(e.length>Ir?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Qn)),s!==i?(qr=n,r=Gn(s),n=r):(Ir=n,n=i)):(Ir=n,n=i);return t}function Li(){var t,n,r;Wr++,t=Ir,n=[],er.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(tr));if(r!==i)while(r!==i)n.push(r),er.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(tr));else n=i;return n!==i&&(qr=t,n=nr(n)),t=n,t===i&&(t=Ti()),Wr--,t===i&&(n=i,Wr===0&&Yr(Zn)),t}function Ai(){var t,n;return Wr++,t=Ir,ir.test(e.charAt(Ir))?(n=e.charAt(Ir),Ir++):(n=i,Wr===0&&Yr(sr)),n!==i&&(qr=t,n=Gn(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(rr)),t}function Oi(){var t,n;return Wr++,t=Ir,ur.test(e.charAt(Ir))?(n=e.charAt(Ir),Ir++):(n=i,Wr===0&&Yr(ar)),n!==i&&(qr=t,n=Gn(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(or)),t}function Mi(){var t;return e.substr(Ir,2)===fr?(t=fr,Ir+=2):(t=i,Wr===0&&Yr(lr)),t}function _i(){var t;return e.substr(Ir,2)===cr?(t=cr,Ir+=2):(t=i,Wr===0&&Yr(hr)),t}function Di(){var t,n,r;return t=Ir,n=Ir,Wr++,e.substr(Ir,2)===cr?(r=cr,Ir+=2):(r=i,Wr===0&&Yr(hr)),Wr--,r===i?n=void 0:(Ir=n,n=i),n!==i?(e.length>Ir?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(Qn)),r!==i?(qr=t,n=Gn(r),t=n):(Ir=t,t=i)):(Ir=t,t=i),t}function Pi(){var e,t,n,r;e=Ir,t=Mi();if(t!==i){n=[],r=Di();while(r!==i)n.push(r),r=Di();n!==i?(r=_i(),r!==i?(qr=e,t=pr(t,n,r),e=t):(Ir=e,e=i)):(Ir=e,e=i)}else Ir=e,e=i;return e}function Hi(){var t;return e.substr(Ir,2)===dr?(t=dr,Ir+=2):(t=i,Wr===0&&Yr(vr)),t===i&&(e.charCodeAt(Ir)===35?(t=mr,Ir++):(t=i,Wr===0&&Yr(gr))),t}function Bi(){var t;return yr.test(e.charAt(Ir))?(t=e.charAt(Ir),Ir++):(t=i,Wr===0&&Yr(br)),t}function ji(){var e,t,n,r;e=Ir,t=Hi();if(t!==i){n=[],r=Bi();while(r!==i)n.push(r),r=Bi();n!==i?(qr=e,t=wr(t,n),e=t):(Ir=e,e=i)}else Ir=e,e=i;return e}function Fi(){var e,t;return Wr++,e=ji(),e===i&&(e=Pi()),Wr--,e===i&&(t=i,Wr===0&&Yr(Er)),e}function Ii(){var e,t;e=[],t=Ai(),t===i&&(t=Oi(),t===i&&(t=Fi()));while(t!==i)e.push(t),t=Ai(),t===i&&(t=Oi(),t===i&&(t=Fi()));return e}function qi(){var e;return e=Ui(),e===i&&(e=Ri()),e}function Ri(){var t,n,r;Wr++,t=Ir,n=[],xr.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(Tr));if(r!==i)while(r!==i)n.push(r),xr.test(e.charAt(Ir))?(r=e.charAt(Ir),Ir++):(r=i,Wr===0&&Yr(Tr));else n=i;return n!==i&&(qr=t,n=Nr(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(Sr)),t}function Ui(){var t,n,r,s,o,u;Wr++,t=Ir,n=Ir,r=[],xr.test(e.charAt(Ir))?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Tr));if(s!==i)while(s!==i)r.push(s),xr.test(e.charAt(Ir))?(s=e.charAt(Ir),Ir++):(s=i,Wr===0&&Yr(Tr));else r=i;if(r!==i){e.charCodeAt(Ir)===46?(s=kr,Ir++):(s=i,Wr===0&&Yr(Lr));if(s!==i){o=[],xr.test(e.charAt(Ir))?(u=e.charAt(Ir),Ir++):(u=i,Wr===0&&Yr(Tr));if(u!==i)while(u!==i)o.push(u),xr.test(e.charAt(Ir))?(u=e.charAt(Ir),Ir++):(u=i,Wr===0&&Yr(Tr));else o=i;o!==i?(r=[r,s,o],n=r):(Ir=n,n=i)}else Ir=n,n=i}else Ir=n,n=i;return n!==i&&(qr=t,n=Ar(n)),t=n,Wr--,t===i&&(n=i,Wr===0&&Yr(Cr)),t}function zi(){var t,n;return Wr++,e.substr(Ir,4).toLowerCase()===Mr?(t=e.substr(Ir,4),Ir+=4):(t=i,Wr===0&&Yr(_r)),t===i&&(e.substr(Ir,5).toLowerCase()===Dr?(t=e.substr(Ir,5),Ir+=5):(t=i,Wr===0&&Yr(Pr)),t===i&&(e.substr(Ir,2).toLowerCase()===Hr?(t=e.substr(Ir,2),Ir+=2):(t=i,Wr===0&&Yr(Br)),t===i&&(e.substr(Ir,3).toLowerCase()===jr?(t=e.substr(Ir,3),Ir+=3):(t=i,Wr===0&&Yr(Fr))))),Wr--,t===i&&(n=i,Wr===0&&Yr(Or)),t}function Wi(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function Xi(e,t){return e=e?e:{},Wi(e,t),e}function Vi(e){var t={};return e[0].forEach(function(e){t=Xi(t,e)}),Xi(t,e[1])}function $i(e){return(["true","on","1"].indexOf(e.toLowerCase())>-1).toString()}function Ji(e,t,n){return t===undefined||t==="*"?!0:e.entities.some(function(e){return e.name===t})?!0:n[t]===!0}function Ki(e){var t={};return t.name=e,t}function Qi(e,t,n){return e||(e={},e.entities=[]),n||(n={}),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){Ji(e,t.from,n)||(e.entities[e.entities.length]=Ki(t.from)),t.arcs&&(n[t.to]=!0,Xi(e,Qi(e,t,n)),delete n[t.to]),Ji(e,t.to,n)||(e.entities[e.entities.length]=Ki(t.to))})}),e}function Gi(e){return e&&e.options?e.options.watermark?!0:!1:!1}function Yi(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function Zi(e,t){var n=Gi(e),r=Yi(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:ei},o=ei,u=function(e,t){t[1]=Qi(t[1],t[2]);var n=Xi(t[0],Xi(t[1],t[2]));return n=Xi({meta:Zi(t[0],t[2])},n),e.length>0&&(n=Xi({precomment:e},n)),n},a=function(e){return{options:e}},f=function(e){return{entities:e}},l=function(e){return{arcs:e}},c=",",h={type:"literal",value:",",description:'","'},p=function(e){return e},d=";",v={type:"literal",value:";",description:'";"'},m=function(e){return Vi(e)},g="=",y={type:"literal",value:"=",description:'"="'},b=function(e,t){return t},w=function(e,t){return t.toString()},E=function(e,t){return t.toString()},S=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=$i(t):n[e]=t,n},x="hscale",T={type:"literal",value:"hscale",description:'"hscale"'},N="width",C={type:"literal",value:"width",description:'"width"'},k="arcgradient",L={type:"literal",value:"arcgradient",description:'"arcgradient"'},A="wordwraparcs",O={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},M="watermark",_={type:"literal",value:"watermark",description:'"watermark"'},D=function(e){return e},P=function(e){return e[0].push(e[1]),e[0]},H={type:"other",description:"entity"},B=":",j={type:"literal",value:":",description:'":"'},F=function(e,t){return t},I=function(e,t){var n={};return n.name=e,!t||(n.label=t),n},q=function(e){return e},R=function(e){return[e]},U=function(e){return e[0].push(e[1][0]),e[0]},z=function(e){return e},W=function(e){return e},X=function(e){return e},V=function(e,t){return t},$=function(e,t){return t&&(e.label=t),e},J=function(e){return{kind:e}},K=function(e,t,n){return{kind:t,from:e,to:n}},Q="*",G={type:"literal",value:"*",description:'"*"'},Y=function(e,t){return{kind:e,from:"*",to:t}},Z=function(e,t){return{kind:t,from:e,to:"*"}},et=function(e,t,n,r){return r},tt="{",nt={type:"literal",value:"{",description:'"{"'},rt="}",it={type:"literal",value:"}",description:'"}"'},st=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return r&&(s.label=r),s},ot="|||",ut={type:"literal",value:"|||",description:'"|||"'},at="...",ft={type:"literal",value:"...",description:'"..."'},lt="---",ct={type:"literal",value:"---",description:'"---"'},ht=function(e){return e.toLowerCase()},pt={type:"other",description:"bi-directional arrow"},dt="--",vt={type:"literal",value:"--",description:'"--"'},mt="<->",gt={type:"literal",value:"<->",description:'"<->"'},yt="==",bt={type:"literal",value:"==",description:'"=="'},wt="<<=>>",Et={type:"literal",value:"<<=>>",description:'"<<=>>"'},St="<=>",xt={type:"literal",value:"<=>",description:'"<=>"'},Tt="..",Nt={type:"literal",value:"..",description:'".."'},Ct="<<>>",kt={type:"literal",value:"<<>>",description:'"<<>>"'},Lt="::",At={type:"literal",value:"::",description:'"::"'},Ot="<:>",Mt={type:"literal",value:"<:>",description:'"<:>"'},_t={type:"other",description:"left to right arrow"},Dt="->",Pt={type:"literal",value:"->",description:'"->"'},Ht="=>>",Bt={type:"literal",value:"=>>",description:'"=>>"'},jt="=>",Ft={type:"literal",value:"=>",description:'"=>"'},It=">>",qt={type:"literal",value:">>",description:'">>"'},Rt=":>",Ut={type:"literal",value:":>",description:'":>"'},zt="-x",Wt={type:"literal",value:"-x",description:'"-x"'},Xt={type:"other",description:"right to left arrow"},Vt="<-",$t={type:"literal",value:"<-",description:'"<-"'},Jt="<<=",Kt={type:"literal",value:"<<=",description:'"<<="'},Qt="<=",Gt={type:"literal",value:"<=",description:'"<="'},Yt="<<",Zt={type:"literal",value:"<<",description:'"<<"'},en="<:",tn={type:"literal",value:"<:",description:'"<:"'},nn="x-",rn={type:"literal",value:"x-",description:'"x-"'},sn={type:"other",description:"box"},on="note",un={type:"literal",value:"note",description:'"note"'},an="abox",fn={type:"literal",value:"abox",description:'"abox"'},ln="rbox",cn={type:"literal",value:"rbox",description:'"rbox"'},hn="box",pn={type:"literal",value:"box",description:'"box"'},dn={type:"other",description:"arc spanning box"},vn="alt",mn={type:"literal",value:"alt",description:'"alt"'},gn="else",yn={type:"literal",value:"else",description:'"else"'},bn="opt",wn={type:"literal",value:"opt",description:'"opt"'},En="break",Sn={type:"literal",value:"break",description:'"break"'},xn="par",Tn={type:"literal",value:"par",description:'"par"'},Nn="seq",Cn={type:"literal",value:"seq",description:'"seq"'},kn="strict",Ln={type:"literal",value:"strict",description:'"strict"'},An="neg",On={type:"literal",value:"neg",description:'"neg"'},Mn="critical",_n={type:"literal",value:"critical",description:'"critical"'},Dn="ignore",Pn={type:"literal",value:"ignore",description:'"ignore"'},Hn="consider",Bn={type:"literal",value:"consider",description:'"consider"'},jn="assert",Fn={type:"literal",value:"assert",description:'"assert"'},In="loop",qn={type:"literal",value:"loop",description:'"loop"'},Rn="ref",Un={type:"literal",value:"ref",description:'"ref"'},zn="exc",Wn={type:"literal",value:"exc",description:'"exc"'},Xn='"',Vn={type:"literal",value:'"',description:'"\\""'},$n=function(e){return e.join("")},Jn='\\"',Kn={type:"literal",value:'\\"',description:'"\\\\\\""'},Qn={type:"any",description:"any character"},Gn=function(e){return e},Yn=function(e){return e.join("").trim()},Zn={type:"other",description:"identifier"},er=/^[^;, "\t\n\r=\-><:{*]/,tr={type:"class",value:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]',description:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]'},nr=function(e){return e.join("")},rr={type:"other",description:"whitespace"},ir=/^[ \t]/,sr={type:"class",value:"[ \\t]",description:"[ \\t]"},or={type:"other",description:"lineend"},ur=/^[\r\n]/,ar={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},fr="/*",lr={type:"literal",value:"/*",description:'"/*"'},cr="*/",hr={type:"literal",value:"*/",description:'"*/"'},pr=function(e,t,n){return e+t.join("")+n},dr="//",vr={type:"literal",value:"//",description:'"//"'},mr="#",gr={type:"literal",value:"#",description:'"#"'},yr=/^[^\r\n]/,br={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},wr=function(e,t){return e+t.join("")},Er={type:"other",description:"comment"},Sr={type:"other",description:"integer"},xr=/^[0-9]/,Tr={type:"class",value:"[0-9]",description:"[0-9]"},Nr=function(e){return parseInt(e.join(""),10)},Cr={type:"other",description:"real"},kr=".",Lr={type:"literal",value:".",description:'"."'},Ar=function(e){return parseFloat(e.join(""))},Or={type:"other",description:"boolean"},Mr="true",_r={type:"literal",value:"true",description:'"true"'},Dr="false",Pr={type:"literal",value:"false",description:'"false"'},Hr="on",Br={type:"literal",value:"on",description:'"on"'},jr="off",Fr={type:"literal",value:"off",description:'"off"'},Ir=0,qr=0,Rr=[{line:1,column:1,seenCR:!1}],Ur=0,zr=[],Wr=0,Xr;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Xr=o();if(Xr!==i&&Ir===e.length)return Xr;throw Xr!==i&&Ir<e.length&&Yr({type:"end",description:"end of input"}),Zr(null,zr,Ur<e.length?e.charAt(Ur):null,Ur<e.length?Gr(Ur,Ur+1):Gr(Ur,Ur))}return e(t,Error),{SyntaxError:t,parse:n}}),n("lib/mscgenjs-core/render/graphics/constants",[],function(){"use strict";return{SVGNS:"http://www.w3.org/2000/svg",XLINKNS:"http://www.w3.org/1999/xlink",LINE_WIDTH:2,FONT_SIZE:12}}),n("lib/mscgenjs-core/render/graphics/svgelementfactory",["./constants"],function(e){"use strict";function r(e){return t.createTextNode(e)}function i(n,r,i,s){var o=t.createElementNS(e.SVGNS,"path");return o.setAttribute("d",n),r&&o.setAttribute("class",r),u(o,i,s),o}function s(n,r){var i=t.createElementNS(e.SVGNS,"polygon");return i.setAttribute("points",n),r&&i.setAttribute("class",r),i}function o(n,r,i,s,o,a){var f=t.createElementNS(e.SVGNS,"rect");return f.setAttribute("width",n.width),f.setAttribute("height",n.height),n.x&&f.setAttribute("x",n.x),n.y&&f.setAttribute("y",n.y),o&&f.setAttribute("rx",o),a&&f.setAttribute("ry",a),r&&f.setAttribute("class",r),u(f,i,s),f}function u(e,t,n){if(!!t||!!n){var r="";n&&(r+="fill:"+n+";"),t&&(r+="stroke:"+t+";"),e.setAttribute("style",r)}}function a(e,t,n,r){var s=3;return i("M"+e.x+","+e.y+"l"+s+", -"+e.height/2+"l"+(e.width-2*s)+",0"+"l"+s+","+e.height/2+"l-"+s+","+e.height/2+"l-"+(e.width-2*s)+",0 "+"l-"+s+",-"+e.height/2,t,n,r)}function f(t,n,r,s){var o=Math.max(9,Math.min(4.5*e.LINE_WIDTH,t.height/2)),u=o.toString(10);return i("M"+t.x+","+t.y+"l"+(t.width-o)+",0 "+"l0,"+u+" l"+u+",0 m-"+u+",-"+u+" l"+u+","+u+" "+"l0,"+(t.height-o)+" "+"l-"+t.width+",0 "+"l0,-"+(t.height+e.LINE_WIDTH/2)+" ",n,r,s)}function l(e,t,n,r,s){var o=s?s:7;return i("M"+e.x+","+e.y+" l"+e.width+",0 "+" l0,"+(e.height-o)+" l-"+o.toString(10)+","+o.toString(10)+" l-"+(e.width-o)+",0 ",t,n,r)}function c(n,r){var i=t.createElementNS(e.SVGNS,"a");return i.setAttributeNS(e.XLINKNS,"xlink:href",n),i.setAttributeNS(e.XLINKNS,"xlink:title",n),i.setAttributeNS(e.XLINKNS,"xlink:show","new"),i.appendChild(r),i}function h(n,r){var i=t.createElementNS(e.SVGNS,"tspan"),s=t.createTextNode(n);return i.appendChild(s),r?c(r,i):i}function p(r,i,s,o,u,a,f){var l=t.createElementNS(e.SVGNS,"text");if(!!r&&r!==""){l.setAttribute("x",i.toString()),l.setAttribute("y",s.toString()),o&&l.setAttribute("class",o),l.appendChild(h(r,u));if(a){var c=h(" ["+a+"]",f);c.setAttribute("style",n),l.appendChild(c)}}return l}function d(e,t){var n=p(e,t.width/2,t.height/2,"watermark"),r=0-Math.atan(t.height/t.width)*360/(2*Math.PI);return n.setAttribute("transform","rotate("+r.toString()+" "+(t.width/2).toString()+" "+(t.height/2).toString()+")"),n}function v(n,r){var i=t.createElementNS(e.SVGNS,"line");return i.setAttribute("x1",n.xFrom.toString()),i.setAttribute("y1",n.yFrom.toString()),i.setAttribute("x2",n.xTo.toString()),i.setAttribute("y2",n.yTo.toString()),r&&i.setAttribute("class",r),i}function m(e){var t=-1;return e.xTo>e.xFrom&&(t=1),{dx:t,dy:t*(e.yTo-e.yFrom)/(e.xTo-e.xFrom)}}function g(t,n){var r=0;return n!=="nodi"&&(r=t.xTo>t.xFrom?-7.5*e.LINE_WIDTH:7.5*e.LINE_WIDTH),r}function y(t,n){var r=0;return n!=="nodi"&&(r=n==="bidi"?t.xTo>t.xFrom?7.5*e.LINE_WIDTH:-7.5*e.LINE_WIDTH:0),r}function b(t,n){var r=e.LINE_WIDTH,s=m(t),o=g(t,n),u=y(t,n),a=(t.xTo-t.xFrom+o-u).toString(),f=(t.yTo-t.yFrom).toString(),l="l"+s.dx.toString()+","+s.dy.toString(),c=" l"+a+","+f;return i("M"+t.xFrom.toString()+","+(t.yFrom-7.5*e.LINE_WIDTH*s.dy).toString()+l+"M"+(t.xFrom+u).toString()+","+(t.yFrom-r).toString()+c+"M"+(t.xFrom+u).toString()+","+(t.yFrom+r).toString()+c+"M"+(t.xTo-s.dx).toString()+","+(t.yTo+7.5*e.LINE_WIDTH*s.dy).toString()+l,n)}function w(e,t,n){return n?b(e,t):v(e,t)}function E(t,n,r,s){var o=s?t.x+7.5*e.LINE_WIDTH:t.x;return i("M"+t.x.toString()+", -"+t.y.toString()+" C"+(t.x+r).toString()+","+(t.y-7.5*e.LINE_WIDTH).toString()+" "+(t.x+r).toString()+","+(n+0).toString()+" "+o.toString()+","+n.toString())}function S(n){var r=t.createElementNS(e.SVGNS,"g");return!n||r.setAttribute("id",n),r}function x(n,r,i){var s=t.createElementNS(e.SVGNS,"use");return s.setAttribute("x",n.toString()),s.setAttribute("y",r.toString()),s.setAttributeNS(e.XLINKNS,"xlink:href","#"+i),s}function T(n,r,i,s){var o=s?s:"0 0 10 10",u=t.createElementNS(e.SVGNS,"marker");return u.setAttribute("orient",i),u.setAttribute("id",n),u.setAttribute("class",r),u.setAttribute("viewBox",o),u.setAttribute("refX","9"),u.setAttribute("refY","3"),u.setAttribute("markerUnits","strokeWidth"),u.setAttribute("markerWidth","10"),u.setAttribute("markerHeight","10"),u}function N(e,t,n){var r=T(e,"arrow-marker","auto"),s=i(t,"arrow-style");return s.setAttribute("style","stroke-dasharray:100,1; stroke : "+n||"black"),r.appendChild(s),r}function C(e,t,n){var r=T(e,"arrow-marker","auto"),i=s(t,"arrow-style");return i.setAttribute("stroke",n||"black"),i.setAttribute("fill",n||"black"),r.appendChild(i),r}var t,n="vertical-align : text-top;";return n+="font-size: 0.7em; text-anchor: start;",{init:function(e){t=e},createTextNode:r,createRect:o,createABox:a,createNote:f,createEdgeRemark:l,createText:p,createDiagonalText:d,createLine:w,createUTurn:E,createGroup:S,createUse:x,createMarkerPath:N,createMarkerPolygon:C}}),n("lib/mscgenjs-core/render/graphics/idmanager",[],function(){"use strict";var e="mscgen_js-svg-",t=e;return{setPrefix:function(n){t=e+n},get:function(e){return e?t+e:t}}}),function(){function R(e){return!!e&&typeof e=="object"}function ot(){}function at(){this.__data__={}}function ft(e){return this.has(e)&&delete this.__data__[e]}function lt(t){return t=="__proto__"?e:this.__data__[t]}function ct(e){return e!="__proto__"&&$.call(this.__data__,e)}function ht(e,t){return e!="__proto__"&&(this.__data__[e]=t),this}function pt(e,t){var n=-1,r=e.length;t||(t=Array(r));while(++n<r)t[n]=e[n];return t}function dt(e,t){var n=-1,r=e.length;while(++n<r)if(t(e[n],n,e)===!1)break;return e}function vt(e,t){var n=-1,r=t.length,i=e.length;while(++n<r)e[i+n]=t[n];return e}function mt(t,n){return t===e?n:t}function gt(t,n,r){var i=-1,s=Zt(n),o=s.length;while(++i<o){var u=s[i],a=t[u],f=r(a,n[u],u,t,n);if((f===f?f!==a:a===a)||a===e&&!(u in t))t[u]=f}return t}function yt(e,t){return t==null?e:bt(t,Zt(t),e)}function bt(e,t,n){n||(n={});var r=-1,i=t.length;while(++r<i){var s=t[r];n[s]=e[s]}return n}function wt(t,n,r,s,o,u,a){var l;r&&(l=o?r(t,s,o):r(t));if(l!==e)return l;if(!Jt(t))return t;var c=Vt(t);if(c){l=_t(t);if(!n)return pt(t,l)}else{var p=J.call(t),d=p==f;if(!(p==h||p==i||d&&!o))return M[p]?Pt(t,p,n):o?t:{};if(q(t))return o?t:{};l=Dt(d?{}:t);if(!n)return yt(l,t)}u||(u=[]),a||(a=[]);var v=u.length;while(v--)if(u[v]==t)return a[v];return u.push(t),a.push(l),(c?dt:xt)(t,function(e,i){l[i]=wt(e,n,r,i,t,u,a)}),l}function Et(e,t,n,r){r||(r=[]);var i=-1,s=e.length;while(++i<s){var o=e[i];R(o)&&Ht(o)&&(n||Vt(o)||Xt(o))?t?Et(o,t,n,r):vt(r,o):n||(r[r.length]=o)}return r}function xt(e,t){return St(e,t,Zt)}function Tt(t){return function(n){return n==null?e:qt(n)[t]}}function Nt(t,n,r){if(typeof t!="function")return tn;if(n===e)return t;switch(r){case 1:return function(e){return t.call(n,e)};case 3:return function(e,r,i){return t.call(n,e,r,i)};case 4:return function(e,r,i,s){return t.call(n,e,r,i,s)};case 5:return function(e,r,i,s,o){return t.call(n,e,r,i,s,o)}}return function(){return t.apply(n,arguments)}}function Ct(e){var t=new Q(e.byteLength),n=new Z(t);return n.set(new Z(e)),t}function kt(t){return zt(function(n,r){var i=-1,s=n==null?0:r.length,o=s>2?r[s-2]:e,u=s>2?r[2]:e,a=s>1?r[s-1]:e;typeof o=="function"?(o=Nt(o,a,5),s-=2):(o=typeof a=="function"?a:e,s-=o?1:0),u&&jt(r[0],r[1],u)&&(o=s<3?e:o,s=1);while(++i<s){var f=r[i];f&&t(n,f,o)}return n})}function Lt(e){return function(t,n,r){var i=qt(t),s=r(t),o=s.length,u=e?o:-1;while(e?u--:++u<o){var a=s[u];if(n(i[a],a,i)===!1)break}return t}}function At(t,n){return zt(function(r){var i=r[0];return i==null?i:(r.push(n),t.apply(e,r))})}function Mt(t,n){var r=t==null?e:t[n];return Kt(r)?r:e}function _t(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&$.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Dt(e){var t=e.constructor;return typeof t=="function"&&t instanceof t||(t=Object),new t}function Pt(e,t,n){var r=e.constructor;switch(t){case g:return Ct(e);case o:case u:return new r(+e);case y:case b:case w:case E:case S:case x:case T:case N:case C:r instanceof r&&(r=it[t]);var i=e.buffer;return new r(n?Ct(i):i,e.byteOffset,e.length);case c:case v:return new r(e);case p:var s=new r(e.source,k.exec(e));s.lastIndex=e.lastIndex}return s}function Ht(e){return e!=null&&Ft(Ot(e))}function Bt(e,t){return e=typeof e=="number"||A.test(e)?+e:-1,t=t==null?rt:t,e>-1&&e%1==0&&e<t}function jt(e,t,n){if(!Jt(n))return!1;var r=typeof t;if(r=="number"?Ht(n)&&Bt(t,n.length):r=="string"&&t in n){var i=n[t];return e===e?e===i:i!==i}return!1}function Ft(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=rt}function It(e){var t=en(e),n=t.length,r=n&&e.length,i=!!r&&Ft(r)&&(Vt(e)||Xt(e)||Qt(e)),s=-1,o=[];while(++s<n){var u=t[s];(i&&Bt(u,r)||$.call(e,u))&&o.push(u)}return o}function qt(e){if(ot.support.unindexedChars&&Qt(e)){var t=-1,n=e.length,r=Object(e);while(++t<n)r[t]=e.charAt(t);return r}return Jt(e)?e:Object(e)}function Rt(e,t,n){var r=e?e.length:0;return n&&jt(e,t,n)&&(t=!1),r?Et(e,t):[]}function Ut(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(r);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o),o};return n.cache=new Ut.Cache,n}function zt(t,n){if(typeof t!="function")throw new TypeError(r);return n=nt(n===e?t.length-1:+n||0,0),function(){var e=arguments,r=-1,i=nt(e.length-n,0),s=Array(i);while(++r<i)s[r]=e[n+r];switch(n){case 0:return t.call(this,s);case 1:return t.call(this,e[0],s);case 2:return t.call(this,e[0],e[1],s)}var o=Array(n+1);r=-1;while(++r<n)o[r]=e[r];return o[n]=s,t.apply(this,o)}}function Wt(e,t,n){return typeof t=="function"?wt(e,!0,Nt(t,n,3)):wt(e,!0)}function Xt(e){return R(e)&&Ht(e)&&$.call(e,"callee")&&!G.call(e,"callee")}function $t(e){return Jt(e)&&J.call(e)==f}function Jt(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Kt(e){return e==null?!1:$t(e)?K.test(V.call(e)):R(e)&&(q(e)?K:L).test(e)}function Qt(e){return typeof e=="string"||R(e)&&J.call(e)==v}function en(e){if(e==null)return[];Jt(e)||(e=Object(e));var t=e.length,n=ot.support;t=t&&Ft(t)&&(Vt(e)||Xt(e)||Qt(e))&&t||0;var r=e.constructor,i=-1,s=$t(r)&&r.prototype||W,o=s===e,u=Array(t),f=t>0,l=n.enumErrorProps&&(e===z||e instanceof Error),c=n.enumPrototypes&&$t(e);while(++i<t)u[i]=i+"";for(var p in e)(!c||p!="prototype")&&(!l||p!="message"&&p!="name")&&(!f||!Bt(p,t))&&(p!="constructor"||!o&&!!$.call(e,p))&&u.push(p);if(n.nonEnumShadows&&e!==W){var d=e===X?v:e===z?a:J.call(e),m=st[d]||st[h];d==h&&(s=W),t=O.length;while(t--){p=O[t];var g=m[p];(!o||!g)&&(g?$.call(e,p):e[p]!==s[p])&&u.push(p)}}return u}function tn(e){return e}var e,t="3.10.1",r="Expected a function",i="[object Arguments]",s="[object Array]",o="[object Boolean]",u="[object Date]",a="[object Error]",f="[object Function]",l="[object Map]",c="[object Number]",h="[object Object]",p="[object RegExp]",d="[object Set]",v="[object String]",m="[object WeakMap]",g="[object ArrayBuffer]",y="[object Float32Array]",b="[object Float64Array]",w="[object Int8Array]",E="[object Int16Array]",S="[object Int32Array]",x="[object Uint8Array]",T="[object Uint8ClampedArray]",N="[object Uint16Array]",C="[object Uint32Array]",k=/\w*$/,L=/^\[object .+?Constructor\]$/,A=/^\d+$/,O=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],M={};M[i]=M[s]=M[g]=M[o]=M[u]=M[y]=M[b]=M[w]=M[E]=M[S]=M[c]=M[h]=M[p]=M[v]=M[x]=M[T]=M[N]=M[C]=!0,M[a]=M[f]=M[l]=M[d]=M[m]=!1;var _={"function":!0,object:!0},D=_[typeof exports]&&exports&&!exports.nodeType&&exports,P=_[typeof module]&&module&&!module.nodeType&&module,H=D&&P&&typeof global=="object"&&global&&global.Object&&global,B=_[typeof self]&&self&&self.Object&&self,j=_[typeof window]&&window&&window.Object&&window,F=P&&P.exports===D&&D,I=H||j!==(this&&this.window)&&j||B||this,q=function(){try{Object({toString:0}+"")}catch(e){return function(){return!1}}return function(e){return typeof e.toString!="function"&&typeof (e+"")=="string"}}(),U=Array.prototype,z=Error.prototype,W=Object.prototype,X=String.prototype,V=Function.prototype.toString,$=W.hasOwnProperty,J=W.toString,K=RegExp("^"+V.call($).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Q=I.ArrayBuffer,G=W.propertyIsEnumerable,Y=U.splice,Z=I.Uint8Array,et=Mt(Array,"isArray"),tt=Mt(Object,"keys"),nt=Math.max,rt=9007199254740991,it={};it[y]=I.Float32Array,it[b]=I.Float64Array,it[w]=I.Int8Array,it[E]=I.Int16Array,it[S]=I.Int32Array,it[x]=Z,it[T]=I.Uint8ClampedArray,it[N]=I.Uint16Array,it[C]=I.Uint32Array;var st={};st[s]=st[u]=st[c]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},st[o]=st[v]={constructor:!0,toString:!0,valueOf:!0},st[a]=st[f]=st[p]={constructor:!0,toString:!0},st[h]={constructor:!0},dt(O,function(e){for(var t in st)if($.call(st,t)){var n=st[t];n[e]=$.call(n,e)}});var ut=ot.support={};(function(e){var t=function(){this.x=e},n={0:e,length:e},r=[];t.prototype={valueOf:e,y:e};for(var i in new t)r.push(i);ut.enumErrorProps=G.call(z,"message")||G.call(z,"name"),ut.enumPrototypes=G.call(t,"prototype"),ut.nonEnumShadows=!/valueOf/.test(r),ut.spliceObjects=(Y.call(n,0,1),!n[0]),ut.unindexedChars="x"[0]+Object("x")[0]!="xx"})(1,0);var St=Lt(),Ot=Tt("length"),Vt=et||function(e){return R(e)&&Ft(e.length)&&J.call(e)==s},Gt=kt(function(e,t,n){return n?gt(e,t,n):yt(e,t)}),Yt=At(Gt,mt),Zt=tt?function(t){var n=t==null?e:t.constructor;return typeof n=="function"&&n.prototype===t||(typeof t=="function"?ot.support.enumPrototypes:Ht(t))?It(t):Jt(t)?tt(t):[]}:It;at.prototype["delete"]=ft,at.prototype.get=lt,at.prototype.has=ct,at.prototype.set=ht,Ut.Cache=at,ot.assign=Gt,ot.defaults=Yt,ot.flatten=Rt,ot.keys=Zt,ot.keysIn=en,ot.memoize=Ut,ot.restParam=zt,ot.extend=Gt,ot.cloneDeep=Wt,ot.identity=tn,ot.isArguments=Xt,ot.isArray=Vt,ot.isFunction=$t,ot.isNative=Kt,ot.isObject=Jt,ot.isString=Qt,ot.VERSION=t,typeof n=="function"&&typeof n.amd=="object"&&n.amd?(I._=ot,n("lib/mscgenjs-core/lib/lodash/lodash.custom",[],function(){return ot})):D&&P?F?(P.exports=ot)._=ot:D._=ot:I._=ot}.call(this),n("lib/mscgenjs-core/render/graphics/svgutensils",["./constants","./idmanager","../../lib/lodash/lodash.custom"],function(e,t,n){"use strict";function s(t){var n=r.createElementNS(e.SVGNS,"svg");return n.setAttribute("version","1.1"),n.setAttribute("xmlns",e.SVGNS),n.setAttribute("xmlns:xlink",e.XLINKNS),n.setAttribute("id",t),n.setAttribute("width",0),n.setAttribute("height",0),r.body.appendChild(n),n}function o(e){var t=r.getElementById(i);t=t?t:s(i),t.appendChild(e);var n=e.getBBox();return t.removeChild(e),n}function u(e){var t=1e5;return Math.abs(e.height)>t||Math.abs(e.width)>t?{height:0,width:0,x:0,y:0}:e}function a(e){return typeof e.getBBox=="function"?u(o(e)):{height:15,width:15,x:2,y:2}}function f(t){var n=r.createElementNS(e.SVGNS,"tspan");return n.appendChild(r.createTextNode(t)),n}function l(t){var n=r.createElementNS(e.SVGNS,"text");return n.setAttribute("x","0"),n.setAttribute("y","0"),n.appendChild(f(t)),n}function c(){return a(l("jy9@")).height}function h(e){t.setPrefix(e);var n=r.getElementById(t.get());if(!!n){var i=r.getElementById(e);i?i.removeChild(n):r.body.removeChild(n)}}var r,i=t.get("bboxer");return{init:function(e){r=e},removeRenderedSVGFromElement:h,getBBox:a,calculateTextHeight:n.memoize(c),webkitNamespaceBugWorkaround:function(e){return e.replace(/\ xlink=/g," xmlns:xlink=","g").replace(/\ href=/g," xlink:href=","g")}}}),n("lib/mscgenjs-core/render/graphics/renderutensils",[],function(){"use strict";function e(e,t){t.scale=e/t.width,t.width*=t.scale,t.height*=t.scale,t.horizontaltransform*=t.scale,t.verticaltransform*=t.scale,t.x=0-t.horizontaltransform,t.y=0-t.verticaltransform}function t(e,t){return e?2*(e+1)*2*t:0}function n(e,t,n){return"-x"===e?t+(n-t)*.75:n}return{scaleCanvasToWidth:e,determineDepthCorrection:t,determineArcXTo:n}}),n("lib/mscgenjs-core/render/graphics/renderskeleton",["./svgelementfactory","./constants"],function(e,t){"use strict";function r(t,n){return n.forEach(function(n){n.type==="method"?t.appendChild(e.createMarkerPolygon(n.name,n.path,n.color)):t.appendChild(e.createMarkerPath(n.name,n.path,n.color))}),t}function i(){var e=n.createElement("style");return e.setAttribute("type","text/css"),e.appendChild(n.createTextNode(c())),e}function s(e){var r=n.createElementNS(t.SVGNS,"svg");return r.setAttribute("version","1.1"),r.setAttribute("id",e),r.setAttribute("xmlns",t.SVGNS),r.setAttribute("xmlns:xlink",t.XLINKNS),r}function o(s,o){var u=n.createElementNS(t.SVGNS,"defs");return u.appendChild(i()),u=r(u,o),u.appendChild(e.createGroup(s+"__defs")),u}function u(e){var r=n.createElementNS(t.SVGNS,"desc");return r.setAttribute("id",e+"__msc_source"),r}function a(t){var n=e.createGroup(t+"__body");return n.appendChild(e.createGroup(t+"__background")),n.appendChild(e.createGroup(t+"__arcspanlayer")),n.appendChild(e.createGroup(t+"__lifelinelayer")),n.appendChild(e.createGroup(t+"__sequencelayer")),n.appendChild(e.createGroup(t+"__notelayer")),n.appendChild(e.createGroup(t+"__watermark")),n}function f(t){return e.init(t.document),t.document}function l(e,t,r,i){n=f(i);var l=n.getElementById(e);l===null&&(l=n.body);var c=s(t);return c.appendChild(u(t)),c.appendChild(o(t,r)),c.appendChild(a(t)),l.appendChild(c),n}function c(){return"svg{  font-family:Helvetica,sans-serif;  font-size:"+t.FONT_SIZE+"px;  font-weight:normal;  font-style:normal;  text-decoration:none;  background-color:white;  stroke:black;  color:black;}rect{  fill:none;  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.bglayer{  fill:white;  stroke:white;  stroke-width:0;}rect.textbg{  fill:white;  stroke:white;  stroke-width:0;  opacity:0.9;}line{  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.arcrowomit{  stroke-dasharray:2,2;}text{  color:inherit;  stroke:none;  text-anchor:middle;}text.entity{  text-decoration:underline;}text.anchor-start{  text-anchor:start;}path{  stroke:black;  color:black;  stroke-width:"+t.LINE_WIDTH+";  fill:none;}.dotted{  stroke-dasharray:5,2;}.striped{  stroke-dasharray:10,5;}.arrow-marker{  overflow:visible;}.arrow-style{  stroke-width:1;}.arcrowomit{  stroke-dasharray:2,2;}.box{  /* fill: #ffc;  no-inherit */  fill:white;  opacity:0.9;}.boxtext, .arctext{  font-size:0.8em;  text-anchor:middle;}.comment{  stroke-dasharray:5,2;} .inherit{  stroke:inherit;  color:inherit;} .inherit-fill{  fill:inherit;}.watermark{  stroke:black;  color:black;  fill:black;  font-size: 48pt;  font-weight:bold;  opacity:0.14;}"}var n;return{bootstrap:l,init:f}}),n("lib/mscgenjs-core/render/text/asttransform",[],function(){"use strict";function e(e,t){e&&t&&e.forEach(function(e){t.forEach(function(t){t(e)})})}function t(e,t,n,r){r&&r.forEach(function(r){r(n,e,t)})}function n(e,n,i){n.forEach(function(s){t(e,n,s,i),s.arcs&&r(e,s.arcs,i)})}function r(e,t,r){e&&t&&r&&t.forEach(function(t){n(e,t,r)})}function i(t,n,i){return e(t.entities,n),r(t.entities,t.arcs,i),t}return{transform:i}}),n("lib/mscgenjs-core/render/text/arcmappings",[],function(){"use strict";var e={"->":"rvee","<->":"rvee","=>":"normal","<=>":"normal","-x":"oinvonormal"},t={box:"box",abox:"hexagon",rbox:"box",note:"note"},n={">>":"dashed","<<>>":"dashed","..":"dashed",":>":"bold","<:>":"bold","::":"bold",rbox:"rounded"},r={"|||":"emptyarc","...":"emptyarc","---":"emptyarc","->":"directional","=>":"directional","=>>":"directional",">>":"directional",":>":"directional","-x":"directional","<-":"directional","<=":"directional","<<=":"directional","<<":"directional","<:":"directional","x-":"directional",note:"box",box:"box",abox:"box",rbox:"box","<->":"bidirectional","<=>":"bidirectional","<<=>>":"bidirectional","<<>>":"bidirectional","<:>":"bidirectional","--":"nondirectional","==":"nondirectional","..":"nondirectional","::":"nondirectional",alt:"inline_expression","else":"inline_expression",opt:"inline_expression","break":"inline_expression",par:"inline_expression",seq:"inline_expression",strict:"inline_expression",neg:"inline_expression",critical:"inline_expression",ignore:"inline_expression",consider:"inline_expression",assert:"inline_expression",loop:"inline_expression",ref:"inline_expression",exc:"inline_expression"},i={"<-":"->","<=":"=>","<<=":"=>>","<<":">>","<:":":>","x-":"-x"};return{getArrow:function(t){return e[t]},getShape:function(e){return t[e]},getStyle:function(e){return n[e]},getAggregate:function(e){return r[e]},getNormalizedKind:function(e){return i[e]||e}}}),n("lib/mscgenjs-core/render/text/textutensils",[],function(){"use strict";return{wrap:function(e,t){var n=0,r=[],i=0,s=0,o=0,u=0,a=e.replace(/[\t\n]+/g," ").replace(/\\n/g,"\n");while(u<=a.length)u>=a.length?r.push(a.substring(i,u)):a[u]==="\n"?(n=0,o=u,r.push(a.substring(i,o)),i=o+1):n++>=t&&(o=a.substring(0,u).lastIndexOf(" "),o===-1||o<i?(n=1,o=u,s=u):(n=0,s=o+1),r.push(a.substring(i,o)),i=s),u++;return r},unescapeString:function(e){return e.replace(/\\\"/g,'"')},escapeString:function(e){return e.replace(/\\\"/g,'"').replace(/\"/g,'\\"')}}}),n("lib/mscgenjs-core/render/text/flatten",["./asttransform","./arcmappings","../../lib/lodash/lodash.custom","./textutensils"],function(e,t,n,r){"use strict";function s(e){e.label===undefined&&(e.label=e.name)}function o(e){!e.label||(e.label=r.unescapeString(e.label)),!e.id||(e.id=r.unescapeString(e.id))}function u(e){e.label=e.label?e.label:""}function a(e){if(e.kind&&t.getNormalizedKind(e.kind)!==e.kind){e.kind=t.getNormalizedKind(e.kind);var n=e.from;e.from=e.to,e.to=n}return e}function f(e,t){!e.linecolor&&t.arclinecolor&&(e.linecolor=t.arclinecolor),!e.textcolor&&t.arctextcolor&&(e.textcolor=t.arctextcolor),!e.textbgcolor&&t.arctextbgcolor&&(e.textbgcolor=t.arctextbgcolor)}function l(e,t){if(e&&e.from){var n=t.filter(function(t){return t.name===e.from});n.length>0&&f(e,n[0])}}function c(e){return e.arcs.reduce(function(e,t){return e+(t[0].arcs?c(t[0])+1:0)},e.arcs.length)}function h(e,r,s,o,u){var a={};"inline_expression"===t.getAggregate(e[0].kind)?(a=n.cloneDeep(e[0]),a.arcs?(a.numberofrows=c(a),delete a.arcs,r.arcs.push([a]),e[0].arcs.forEach(function(e){h(e,r,s+1,a.from,a.to),e.forEach(function(e){f(e,a)})}),s>i&&(i=s)):r.arcs.push([a]),r.arcs.push([{kind:"|||",from:a.from,to:a.to}]),a.depth=s):(o&&u&&e.filter(function(e){return"emptyarc"===t.getAggregate(e.kind)}).forEach(function(e){e.from=o,e.to=u,e.depth=s}),r.arcs.push(e))}function p(e){var t={};return i=0,!e.options||(t.options=n.cloneDeep(e.options)),!e.entities||(t.entities=n.cloneDeep(e.entities)),t.arcs=[],e&&e.arcs&&e.arcs.forEach(function(e){h(e,t,0)}),t.depth=i+1,t}function d(e,t){return e.filter(function(e){return t.from!==e.name}).map(function(e){return t.to=e.name,n.cloneDeep(t)})}function v(e){if(e.entities&&e.arcs){var t=[],r={};e.arcs.forEach(function(i,s){i.filter(function(e){return e.to==="*"}).forEach(function(o,u){r=n.cloneDeep(o),delete e.arcs[s][u],t=d(e.entities,r),i[u]=t.shift(),e.arcs[s]=i.concat(t)})})}return e}var i=0;return{swapRTLArc:a,unwind:p,explodeBroadcasts:v,flatten:function(t){return e.transform(p(t),[s,o],[a,l,o,u])},dotFlatten:function(t){return v(e.transform(t,[s],[a,l]))}}}),n("lib/mscgenjs-core/render/graphics/swap",[],function(){"use strict";function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}return{swapfromto:function(t){e(t,"from","to")}}}),n("lib/mscgenjs-core/render/graphics/rowmemory",[],function(){"use strict";function r(r,i){e=[],t=r,n=i}function i(r){return e[r]?e[r]:{y:t+1.5*n+r*n,height:n}}function s(){return i(e.length-1)}function o(t,r,s){if(r===undefined||r<n)r=n;if(s===undefined){var o=i(t-1);o&&o.y>0&&(s=o.y+(o.height+r)/2)}e[t]={y:s,height:r}}var e=[],t=0,n=0;return{clear:r,get:i,getLast:s,set:o}}),n("lib/mscgenjs-core/render/graphics/markermanager",["../../lib/lodash/lodash.custom","../text/arcmappings"],function(e,t){"use strict";function i(e,t,n){if(t&&n&&["<->","->"].indexOf(e>-1))return t<n?"signal":"signal-u"}function s(e,t,n){return"<->"===e&&t<=n?"signal-l":"signal-lu"}function o(e,t,r,o,u){var a=[];return n[t]&&n[t].attributes&&(a=n[t].attributes.map(function(n){return{name:n.name,value:n.value.replace(/\{\{signal-marker-end\}\}/g,i(t,o,u)).replace(/\{\{signal-marker-start\}\}/g,s(t,o,u)).replace(/\{\{id\}\}/g,e).replace(/\{\{color\}\}/g,r||"black")}})),a}function u(e,r){return n[t.getNormalizedKind(e)].marker.name+(r?" "+r:" black")}function a(e,r){function i(t){a(e,t)}return Array.isArray(r)&&r.forEach(i),!r.arcs||r.arcs.forEach(i),!!r.kind&&!!n[t.getNormalizedKind(r.kind)]&&!!n[t.getNormalizedKind(r.kind)].marker&&e.indexOf(u(r.kind,r.linecolor))<0&&e.push(u(r.kind,r.linecolor)),e}function f(e){return{kind:e.split(" ")[0],color:e.split(" ")[1]}}function l(e){return e.arcs.reduce(a,[]).sort().map(f)}var n={"->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"}],marker:{name:"signal"}},"<->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"},{name:"marker-start",value:"url(#{{id}}{{signal-marker-start}}-{{color}})"}],marker:{name:"signal"}},"=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},">>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<>>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},"..":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"}]},"--":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"==":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"::":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},":>":{attributes:[{name:"style",value:"stroke:{{color}};"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<:>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},"-x":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}lost-{{color}})"}],marker:{name:"lost",end:""}}},r={signal:{variants:[{name:"",path:"M9,3 l-8, 2"},{name:"-u",path:"M9,3 l-8,-2"},{name:"-l",path:"M9,3 l 8, 2"},{name:"-lu",path:"M9,3 l 8,-2"}]},method:{variants:[{name:"",path:"1,1  9,3  1,5"},{name:"-l",path:"17,1 9,3 17,5"}]},callback:{variants:[{name:"",path:"M 1,1 l 8,2 l-8,2"},{name:"-l",path:"M17,1 l-8,2 l 8,2"}]},lost:{variants:[{name:"",path:"M7,0 l5,6 M7,6 l5,-6"}]}};return{getAttributes:o,getMarkerDefs:function(t,n){return e.flatten(l(n).map(function(e){return r[e.kind].variants.map(function(n){return{name:t+e.kind+n.name+"-"+e.color,path:n.path,color:e.color,type:e.kind}})}))}}}),n("lib/mscgenjs-core/render/graphics/renderlabels",["./svgelementfactory","./svgutensils","./constants","../text/textutensils","../text/arcmappings"],function(e,t,n,r,i){"use strict";function s(e,t){t&&e.setAttribute("style","fill:"+t+";")}function o(e,t,n){s(e,t&&!n?"blue":n)}function u(n,r){var i=e.createRect(t.getBBox(n),"textbg");return r&&i.setAttribute("style","fill: "+r+"; stroke:"+r+";"),i}function a(t,n,r,i,s,o){var u={};return t===0?u=e.createText(n,r,i,s,o.url,o.id,o.idurl):u=e.createText(n,r,i,s,o.url),u}function f(e,r,i,u,f,l){var c=i+(f+.25)*t.calculateTextHeight(),h;!l||(l.underline&&(h="entity"),l.alignLeft&&(h="anchor-start"),l.alignAround&&(c=i+(f+.25)*(t.calculateTextHeight()+n.LINE_WIDTH)));var p=a(f,e,r,c,h,u);return s(p,u.textcolor),o(p,u.url,u.textcolor),p}function l(r,i,s,o){var a=e.createGroup(o);if(r.label){var l=i.x+i.width/2,c=h(r.label,r.kind,i.width,n.FONT_SIZE,s?s.wordWrapArcs:!1),p={};!!s&&s.alignAbove&&c.forEach(function(){c.push("")});var d=i.y-(c.length-1)/2*(t.calculateTextHeight()+1);!!s&&s.alignAround&&(c.length===1&&c.push(""),d=i.y-(c.length-1)/2*(t.calculateTextHeight()+n.LINE_WIDTH+1)),c.forEach(function(e,t){e!==""&&(p=f(e,l,d,r,t,s),!!s&&s.ownBackground&&a.appendChild(u(p,r.textbgcolor)),a.appendChild(p)),d++})}return a}function c(e,t){var n=Math.abs(e),r=12;return n<=160?n/(t/r*8):n<=320?n/(t/r*6.4):n<=480?n/(t/r*5.9):n/(t/r*5.6)}function h(e,t,n,s,o){return"box"===i.getAggregate(t)||undefined===t||o?r.wrap(e,c(n,s)):e.split("\\n")}return{createLabel:l,splitLabel:h}}),n("lib/mscgenjs-core/render/graphics/entities",["./renderlabels","./constants"],function(e,t){"use strict";function u(e){s.interEntitySpacing=n,s.height=i,s.width=r,e&&e.hscale&&(s.interEntitySpacing=e.hscale*n,s.width=e.hscale*r),o={}}function a(e,t){return{from:f(e),to:f(t)}}function f(e){return o[e]}function l(e,t){o[e.name]=t+s.width/2}function c(){return s}function h(e){s.height=e}var n=160,r=100,i=34,s={interEntitySpacing:n,height:i,width:r},o={};return{init:u,getX:f,setX:l,getOAndD:a,setHeight:h,getDims:c,getNoEntityLines:function(n){return e.splitLabel(n,"box",s.width,t.FONT_SIZE).length}}}),n("lib/mscgenjs-core/render/graphics/renderast",["./svgelementfactory","./svgutensils","./renderutensils","./renderskeleton","../text/flatten","../text/arcmappings","./swap","./rowmemory","./idmanager","./markermanager","./entities","./renderlabels","./constants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";function y(e,n,r,s){var o=i.flatten(e);b(o,n,r,s),w(o),E(o);var u=s.document.getElementById(r);return u?t.webkitNamespaceBugWorkaround(u.innerHTML):t.webkitNamespaceBugWorkaround(s.document.body.innerHTML)}function b(e,n,i,s){a.setPrefix(i),m.document=r.bootstrap(i,a.get(),f.getMarkerDefs(a.get(),e),s),t.init(m.document),S(m,e.depth),N(m,e.options),C(m,n)}function w(e){H(e.entities),u.clear(l.getDims().height,m.arcRowHeight),j(e.arcs,e.entities)}function E(e){var t=k(e);L(m,t),O(e.options,t),M(t)}function S(e,t){x(e.layer,e.document),e.maxDepth=t?t:0}function x(e,t){e.defs=t.getElementById(a.get("__defs")),e.lifeline=t.getElementById(a.get("__lifelinelayer")),e.sequence=t.getElementById(a.get("__sequencelayer")),e.notes=t.getElementById(a.get("__notelayer")),e.inline=t.getElementById(a.get("__arcspanlayer")),e.watermark=t.getElementById(a.get("__watermark"))}function T(e,t){e.arcRowHeight=d,e.arcGradient=v,e.wordWrapArcs=!1,t&&(t.arcgradient&&(e.arcRowHeight=parseInt(t.arcgradient,10)+d,e.arcGradient=parseInt(t.arcgradient,10)+v),t.wordwraparcs&&t.wordwraparcs==="true"&&(e.wordWrapArcs=!0))}function N(e,t){l.init(t),T(e,t)}function C(t,n){if(n){var r=e.createTextNode("\n\n# Generated by mscgen_js - https://sverweij.github.io/mscgen_js\n"+n);t.document.getElementById(a.get("__msc_source")).appendChild(r)}}function k(e){var t=n.determineDepthCorrection(e.depth,h.LINE_WIDTH),r=u.getLast(),i={width:e.entities.length*l.getDims().interEntitySpacing+t,height:r.y+r.height/2+2*p,horizontaltransform:(l.getDims().interEntitySpacing+t-l.getDims().width)/2,verticaltransform:p,scale:1};return i.x=0-i.horizontaltransform,i.y=0-i.verticaltransform,i}function L(t,n){var r=e.createRect(n,"bglayer");t.document.getElementById(a.get("__background")).appendChild(r)}function A(t,n){m.layer.watermark.appendChild(e.createDiagonalText(t,n))}function O(e,t){e&&(e.watermark&&A(e.watermark,t),e.width&&n.scaleCanvasToWidth(e.width,t))}function M(e){var t=m.document.getElementById(a.get()),n=m.document.getElementById(a.get("__body"));n.setAttribute("transform","translate("+e.horizontaltransform+","+e.verticaltransform+")"+" scale("+e.scale+","+e.scale+")"),t.setAttribute("width",e.width.toString()),t.setAttribute("height",e.height.toString())}function _(e){var n=e[0],r=2;return e.forEach(function(e){var t=l.getNoEntityLines(e.label);t>r&&(r=t,n=e)}),r>2?Math.max(l.getDims().height,t.getBBox(D(n)).height):l.getDims().height}function D(t){var n=e.createGroup(a.get(t.name)),r=l.getDims(),i=c.createLabel(t,{x:0,y:r.height/2,width:r.width},{underline:!0}),s=e.createRect(r,null,t.linecolor,t.textbgcolor);return n.appendChild(s),n.appendChild(i),n}function P(t,n){m.layer.defs.appendChild(D(t)),m.layer.sequence.appendChild(e.createUse(n,0,a.get(t.name)))}function H(e){var t=0;e&&(l.setHeight(_(e)+h.LINE_WIDTH*2),e.forEach(function(e){P(e,t),l.setX(e,t),t+=l.getDims().interEntitySpacing})),m.arcEndX=t-l.getDims().interEntitySpacing+l.getDims().width}function B(n,r,i){var o=!1,f=[];u.set(r),n.forEach(function(e,n){var p=a.get(r.toString()+"_"+n.toString()),d;switch(s.getAggregate(e.kind)){case"emptyarc":d=z(e,p),o="..."===e.kind,f.push({id:p,layer:m.layer.sequence});break;case"box":d=J(p,l.getOAndD(e.from,e.to),e),f.push({id:p,layer:m.layer.notes});break;case"inline_expression":d=F(p+"_label",e),f.push({id:p+"_label",layer:m.layer.notes}),g.push({id:p,arc:e,rownum:r});break;default:if(e.from&&e.to){var v=0,y=0;if(e.to==="*"){var b=e.label;y=l.getX(e.from),i.forEach(function(t,n){t.name!==e.from&&(v=l.getX(t.name),e.label="",m.layer.defs.appendChild(X(p+"bc"+n,e,y,v)),f.push({id:p+"bc"+n,layer:m.layer.sequence}))}),e.label=b,d=c.createLabel(e,{x:0,y:0,width:m.arcEndX},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs},p+"_lbl"),f.push({id:p+"_lbl",layer:m.layer.sequence})}else d=X(p,e,l.getX(e.from),l.getX(e.to)),f.push({id:p,layer:m.layer.sequence})}}d&&(u.set(r,Math.max(u.get(r).height,t.getBBox(d).height+2*h.LINE_WIDTH)),m.layer.defs.appendChild(d))});var p="arcrow_"+r.toString(),d="arcrow";o&&(d="arcrowomit"),m.layer.defs.appendChild(R(i,d,u.get(r).height,a.get(p))),m.layer.lifeline.appendChild(e.createUse(0,u.get(r).y,a.get(p))),f.forEach(function(t){t.layer.appendChild(e.createUse(0,u.get(r).y,t.id))})}function j(t,n){g=[],m.layer.defs.appendChild(R(n,a.get("arcrow"))),m.layer.lifeline.appendChild(e.createUse(0,u.get(-1).y,a.get("arcrow")));if(t){for(var r=0;r<t.length;r++)B(t[r],r,n);I(g)}}function F(n,r){var i={from:l.getX(r.from),to:l.getX(r.to)},s=7;i.from>i.to&&o.swapfromto(i);var u=i.to-i.from+(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)-s-h.LINE_WIDTH,a=i.from-(l.getDims().interEntitySpacing-3*h.LINE_WIDTH)/2-(m.maxDepth-r.depth)*2*h.LINE_WIDTH,f=e.createGroup(n);r.label=r.kind+(r.label?": "+r.label:"");var p=c.createLabel(r,{x:a+h.LINE_WIDTH-u/2,y:m.arcRowHeight/4,width:u},{alignLeft:!0,ownBackground:!1,wordWrapArcs:m.wordWrapArcs}),d=t.getBBox(p),v=Math.max(d.height+2*h.LINE_WIDTH,m.arcRowHeight/2-2*h.LINE_WIDTH),g=Math.min(d.width+2*h.LINE_WIDTH,u),y=e.createEdgeRemark({width:g-h.LINE_WIDTH+s,height:v,x:a,y:0},"box",r.linecolor,r.textbgcolor,s);return f.appendChild(y),f.appendChild(p),f}function I(t){t.forEach(function(t){m.layer.defs.appendChild(q(t)),m.layer.inline.appendChild(e.createUse(0,u.get(t.rownum).y,t.id))})}function q(e){var t=u.get(e.rownum).y,n=u.get(e.rownum+e.arc.numberofrows+1).y,r=n-t;return e.arc.label="",J(e.id,l.getOAndD(e.arc.from,e.arc.to),e.arc,r)}function R(t,n,r,i){i||(i=n);if(!r||r<m.arcRowHeight)r=m.arcRowHeight;var s=e.createGroup(i);return t.forEach(function(t){var i=e.createLine({xFrom:l.getX(t.name),yFrom:0-r/2,xTo:l.getX(t.name),yTo:r/2},n);t.linecolor&&i.setAttribute("style","stroke : "+t.linecolor+";"),s.appendChild(i)}),s}function U(t,n,r,i,s){var o=2*(m.arcRowHeight/5),u=l.getDims().interEntitySpacing/2,c={};if(i){c=e.createGroup();var p=e.createUTurn({x:n,y:o/2},r+o-2*h.LINE_WIDTH,u-2*h.LINE_WIDTH,t!=="::"),d=e.createUTurn({x:n,y:o/2},r+o-h.LINE_WIDTH,u),v=e.createUTurn({x:n,y:o/2},r+o,u,t!=="::");p.setAttribute("style","stroke:"+s),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){d.setAttribute(e.name,e.value)}),d.setAttribute("style","stroke:transparent;"),v.setAttribute("style","stroke:"+s),c.appendChild(p),c.appendChild(v),c.appendChild(d)}else c=e.createUTurn({x:n,y:o/2},r+o,u,t==="-x"),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){c.setAttribute(e.name,e.value)});return c}function z(e,t){var n;e.from&&e.to&&l.getX(e.from)>l.getX(e.to)&&o.swapfromto(e);switch(e.kind){case"...":case"|||":n=V(t,e);break;case"---":n=$(t,e)}return n}function W(e){return e.arcskip?e.arcskip*m.arcRowHeight:0}function X(t,r,i,s){var o=e.createGroup(t),u=r.kind==="<:>"?"bidi":r.kind==="::"?"nodi":"",p=[":>","::","<:>"].indexOf(r.kind)>-1,d=W(r),v=d===0?m.arcGradient:d;s=n.determineArcXTo(r.kind,i,s);if(i===s){o.appendChild(U(r.kind,i,d,p,r.linecolor));var g=2*l.getDims().interEntitySpacing/3;o.appendChild(c.createLabel(r,{x:i+1.5*h.LINE_WIDTH-g/2,y:0-m.arcRowHeight/5-h.LINE_WIDTH/2,width:g},{alignLeft:!0,alignAbove:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}else{var y=e.createLine({xFrom:i,yFrom:0,xTo:s,yTo:v},u,p);f.getAttributes(a.get(),r.kind,r.linecolor,i,s).forEach(function(e){y.setAttribute(e.name,e.value)}),o.appendChild(y),o.appendChild(c.createLabel(r,{x:i,y:0,width:s-i},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}return o}function V(t,n){var r=0,i=m.arcEndX,s=e.createGroup(t);return n.from&&n.to&&(r=l.getX(n.from),i=Math.abs(l.getX(n.to)-l.getX(n.from))),s.appendChild(c.createLabel(n,{x:r,y:0,width:i},{ownBackground:!0,wordWrapArcs:m.wordWrapArcs},t+"_lbl")),s}function $(t,n){var r=0,i=m.arcEndX,s="dotted",o=e.createGroup(t);if(n.from&&n.to){var u=(m.maxDepth-n.depth)*2*h.LINE_WIDTH;r=l.getX(n.from)-(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2-u,i=l.getX(n.to)+(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2+u,s="striped"}var a=e.createLine({xFrom:r,yFrom:0,xTo:i,yTo:0},s);return o.appendChild(a),o.appendChild(V(t+"_txt",n)),n.linecolor&&a.setAttribute("style","stroke: "+n.linecolor+";"),o}function J(n,r,i,s){r.from>r.to&&o.swapfromto(r);var u=r.to-r.from+l.getDims().interEntitySpacing-2*h.LINE_WIDTH,a=6,f=r.from-(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)/2,p=e.createGroup(n),d,v=c.createLabel(i,{x:f,y:0,width:u}),g=t.getBBox(v),y=s?s:Math.max(g.height+2*h.LINE_WIDTH,m.arcRowHeight-2*h.LINE_WIDTH),b={width:u,height:y,x:f,y:0-y/2};switch(i.kind){case"box":d=e.createRect(b,"box",i.linecolor,i.textbgcolor);break;case"rbox":d=e.createRect(b,"box",i.linecolor,i.textbgcolor,a,a);break;case"abox":b.y=0,d=e.createABox(b,"box",i.linecolor,i.textbgcolor);break;case"note":d=e.createNote(b,"box",i.linecolor,i.textbgcolor);break;default:var w=(m.maxDepth-i.depth)*2*h.LINE_WIDTH;d=e.createRect({width:u+w*2,height:y,x:f-w,y:0},"box",i.linecolor,i.textbgcolor)}return p.appendChild(d),p.appendChild(v),p}function K(e,n){m.document=r.init(n),t.init(m.document),t.removeRenderedSVGFromElement(e)}var p=3,d=38,v=0,m={arcRowHeight:d,arcGradient:v,arcEndX:0,wordWrapArcs:!1,maxDepth:0,document:{},layer:{defs:{},lifeline:{},sequence:{},notes:{},inline:{}}},g=[];return{clean:K,renderAST:y}}),n("lib/mscgenjs-core/render/text/ast2dot",["./flatten","./textutensils","./arcmappings","../../lib/lodash/lodash.custom"],function(e,t,n,r){"use strict";function o(e){var t="/* Sequence chart represented as a directed graph\n * in the graphviz dot language (http://graphviz.org/)\n *\n * Generated by mscgen_js (https://sverweij.github.io/mscgen_js)\n */\n\ngraph {\n";return t+=i+"rankdir=LR\n",t+=i+"splines=true\n",t+=i+"ordering=out\n",t+=i+'fontname="Helvetica"\n',t+=i+'fontsize="9"\n',t+=i+'node [style=filled, fillcolor=white fontname="Helvetica", fontsize="9" ]\n',t+=i+'edge [fontname="Helvetica", fontsize="9", arrowhead=vee, arrowtail=vee, dir=forward]\n',t+="\n",e&&(e.entities&&(t+=d(e.entities)+"\n"),e.arcs&&(s=0,t+=w(e.arcs,""))),t+="}"}function u(e){var n=t.wrap(e.replace(/\"/g,'\\"'),40),r=n.slice(0,-1).reduce(function(e,t){return e+t+"\n"},"");return r+=n.slice(-1),r}function a(e,t){return t+'="'+u(e)+'"'}function f(e,t,n){!t||e.push(a(t,n))}function l(e){return["label","color","fontcolor","fillcolor"].filter(function(t){return!!e[t]}).map(function(t){return a(e[t],t)})}function c(e){var t="";return e.length>0&&(t=e.slice(0,-1).reduce(function(e,t){return e+t+", "}," ["),t+=e.slice(-1)+"]"),t}function h(e){return'"'+e+'"'}function p(e){return h(e.name)+c(l(e))}function d(e){return e.reduce(function(e,t){return e+i+p(t)+";\n"},"")}function v(e,t){return e?"("+t+") "+e:"("+t+")"}function m(e,t,r){var s="",o="box"+t.toString();s+=o;var u=l(e);return f(u,n.getStyle(e.kind),"style"),f(u,n.getShape(e.kind),"shape"),s+=c(u)+"\n"+i+r,u=[],f(u,"dotted","style"),f(u,"none","dir"),s+=o+" -- {"+h(e.from)+","+h(e.to)+"}",s+=c(u),s}function g(e,t,r){var i="";e.label=v(e.label,r);var s=l(e);f(s,n.getStyle(e.kind),"style");switch(t){case"directional":f(s,n.getArrow(e.kind),"arrowhead");break;case"bidirectional":f(s,n.getArrow(e.kind),"arrowhead"),f(s,n.getArrow(e.kind),"arrowtail"),f(s,"both","dir");break;case"nondirectional":f(s,"none","dir")}return e.arcs||(i+=h(e.from)+" ",i+="--",i+=" "+h(e.to),i+=c(s)),i}function y(e,t,r){var i="",s=n.getAggregate(e.kind);return s==="box"?i+=m(e,t,r):i+=g(e,s,t),i}function b(e,t){var n="";return e.from&&e.kind&&e.to&&(n+=i+t+y(e,++s,t)+"\n",e.arcs&&(n+=i+t+"subgraph cluster_"+s.toString()+"{",e.label&&(n+="\n"+i+t+' label="'+e.kind+": "+e.label+'" labeljust="l" \n'),n+=w(e.arcs,t+i),n+=i+t+"}\n")),n}function w(e,t){return e.reduce(function(e,n){return e+n.reduce(function(e,n){return e+b(n,t)},"")},"")}var i="  ",s=0;return{render:function(t){return o(e.dotFlatten(r.cloneDeep(t)))}}}),n("lib/mscgenjs-core/render/text/ast2thing",["./textutensils"],function(e){"use strict";function o(e){Object.getOwnPropertyNames(e).forEach(function(t){s[t]=e[t]})}function u(e){o(i),o(e)}function a(e,t){return u(t),f(e)}function f(e){var t="";return e&&(e.precomment&&(t+=s.renderCommentfn(e.precomment)),t+=s.program.opener,e.options&&(t+=d(e.options)),e.entities&&(t+=m(e.entities,s.renderEntityfn)),e.arcs&&(t+=E(e.arcs,"")),t+=s.program.closer),t}function l(e,t){return t.filter(function(t){return!!e[t]}).map(function(t){return{name:t,value:e[t]}})}function c(e){return e.reduce(function(e,t){return e+t},"")}function h(e){function t(e){var t=e.match(/[a-z0-9]+/gi);return t?t.length!==1:e!=="*"}return t(e)?'"'+e+'"':e}function p(t){return t.name+'="'+e.escapeString(t.value)+'"'}function d(e){var t=l(e,s.supportedOptions),n="";if(t.length>0){var r=t.pop();n=t.reduce(function(e,t){return e+s.renderOptionfn(t)+s.option.separator},s.option.opener),n+=s.renderOptionfn(r)+s.option.closer}return n}function v(e){return s.renderEntityNamefn(e.name)+g(e,s.supportedEntityAttributes)}function m(e){var t="";return e.length>0&&(t=e.slice(0,-1).reduce(function(e,t){return e+v(t)+s.entity.separator},s.entity.opener),t+=v(e[e.length-1])+s.entity.closer),t}function g(e,t){var n="",r=l(e,t);if(r.length>0){var i=r.pop();n=r.reduce(function(e,t){return e+s.renderAttributefn(t)+s.attribute.separator},s.attribute.opener),n+=s.renderAttributefn(i)+s.attribute.closer}return n}function y(e){return e}function b(e,n){var r="";return e.from&&(r+=s.renderEntityNamefn(e.from)+" "),e.kind&&(r+=s.renderKindfn(e.kind)),e.to&&(r+=" "+s.renderEntityNamefn(e.to)),r+=g(e,s.supportedArcAttributes),e.arcs&&(r+=s.inline.opener,r+=E(e.arcs,n+t),r+=n+s.inline.closer),null===e.arcs&&(r+=s.inline.opener,r+=n+s.inline.closer),r}function w(e,t){var n="";return e.length>0&&(n=e.slice(0,-1).reduce(function(e,n){return e+t+b(n,t)+s.arcline.separator},s.arcline.opener),n+=t+b(e[e.length-1],t)+s.arcline.closer),n}function E(e,t){return e.reduce(function(e,n){return e+w(n,t)},"")}var t="  ",n=" ",r="\n",i={renderCommentfn:c,renderOptionfn:p,renderEntityNamefn:h,renderKindfn:y,supportedOptions:["hscale","width","arcgradient","wordwraparcs","watermark"],supportedEntityAttributes:["label"],supportedArcAttributes:["label"],program:{opener:"",closer:""},option:{opener:"",separator:","+r,closer:";"+r+r},entity:{opener:"",separator:","+n,closer:";"+r+r},arcline:{opener:"",separator:","+r,closer:";"+r},inline:{opener:" {"+r,closer:"}"},attribute:{opener:"",separator:"",closer:""}},s={};return{render:a}}),n("lib/mscgenjs-core/render/text/ast2mscgen",["./arcmappings","./textutensils","./ast2thing"],function(e,t,n){"use strict";function u(e){!0===e?(o=!0,r="",i="",s=""):(o=!1,r="  ",i=" ",s="\n")}function a(t){return"inline_expression"===e.getAggregate(t)?"--":t}function f(e){var n="";return e.name&&e.value&&(n+=e.name+'="'+t.escapeString(e.value)+'"'),n}var r="  ",i=" ",s="\n",o=!1;return{render:function(e,t){return u(t),n.render(e,{renderAttributefn:f,renderKindfn:a,supportedOptions:["hscale","width","arcgradient","wordwraparcs"],supportedEntityAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],supportedArcAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],program:{opener:"msc"+i+"{"+s,closer:"}"},option:{opener:r,separator:","+s,closer:";"+s+s},entity:{opener:r,separator:","+s+r,closer:";"+s+s},attribute:{opener:i+"[",separator:","+i,closer:"]"},arcline:{opener:r,separator:","+s,closer:";"+s},inline:{opener:";"+s,closer:"#"}})}}}),n("lib/mscgenjs-core/render/text/ast2doxygen",["./arcmappings","./textutensils","./ast2thing"],function(e,t,n){"use strict";function u(t){return"inline_expression"===e.getAggregate(t)?"--":t}function a(e){var n="";return e.name&&e.value&&(n+=e.name+'="'+t.escapeString(e.value)+'"'),n}function f(){return""}var r="  ",i=" ",s="\n",o=" * ";return{render:function(e){return n.render(e,{renderCommentfn:f,renderAttributefn:a,renderKindfn:u,supportedOptions:["hscale","width","arcgradient","wordwraparcs"],supportedEntityAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],supportedArcAttributes:["label","idurl","id","url","linecolor","textcolor","textbgcolor","arclinecolor","arctextcolor","arctextbgcolor","arcskip"],program:{opener:o+"\\msc"+s,closer:o+"\\endmsc"},option:{opener:o+r,separator:","+s+o+r,closer:";"+s+o+s},entity:{opener:o+r,separator:","+s+o+r,closer:";"+s+o+s},attribute:{opener:i+"[",separator:","+i,closer:"]"},arcline:{opener:o+r,separator:","+s+o+r,closer:";"+s},inline:{opener:";"+s,closer:o+"#"}})}}}),n("utl/paramslikker",[],function(){"use strict";return{getParams:function(e){var t={};if(e){var n;e.slice(1).split("&").forEach(function(e){n=e.split("="),2===n.length&&(t[n[0]]=decodeURIComponent(n[1]))})}return t}}}),n("utl/exporter",["../lib/mscgenjs-core/render/text/ast2dot","../lib/mscgenjs-core/render/text/ast2mscgen","../lib/mscgenjs-core/render/text/ast2doxygen","./paramslikker"],function(e,t,n,r){"use strict";function u(e,t,n){return s.replace(/{{config}}/g,n?o:"").replace(/{{language}}/g,t).replace(/{{source}}/g,e.replace(/</g,"&lt;"))}function a(e){var t=r.getParams(e.search),n="";return t.donottrack&&(n+="&donottrack="+t.donottrack),t.debug&&(n+="&debug="+t.debug),n}function f(e,t,n){return e.pathname+"?lang="+n+a(e)+"&msc="+encodeURIComponent(t)}function l(e,t,n){return f(e,t,n).length<i}var i=4094,s="<!DOCTYPE html>\n<html>\n  <head>\n    <meta content='text/html;charset=utf-8' http-equiv='Content-Type'>\n{{config}}    <script src='https://sverweij.github.io/mscgen_js/mscgen-inpage.js' defer>\n    </script>\n  </head>\n  <body>\n    <pre class='code {{language}} mscgen_js' data-language='{{language}}'>\n{{source}}\n    </pre>\n  </body>\n</html>",o="    <script>\n      var mscgen_js_config = {\n        clickable: true\n      }\n    </script>\n";return{toVectorURI:function(e,t){t=t?t:window;var n=t.btoa(unescape(encodeURIComponent(e)));return"data:image/svg+xml;charset=utf-8;base64,"+n},toHTMLSnippet:u,toHTMLSnippetURI:function(e,t,n){return"data:text/plain;charset=utf-8,"+encodeURIComponent(u(e,t,n))},todotURI:function(t){return"data:text/plain;charset=utf-8,"+encodeURIComponent(e.render(t))},toVanillaMscGenURI:function(e){return"data:text/plain;charset=utf-8,"+encodeURIComponent(t.render(e))},toDoxygenURI:function(e){return"data:text/plain;charset=utf-8,"+encodeURIComponent(n.render(e))},toLocationString:function(e,t,n){var r="# source too long for an URL";return l(e,t,n)&&(r=t),f(e,r,n)}}}),n("embedding/config",[],function(){"use strict";function t(e,t){Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}var e={defaultLanguage:"mscgen",parentElementPrefix:"mscgen_js-parent_",clickable:!1,clickURL:"https://sverweij.github.io/mscgen_js/",loadFromSrcAttribute:!1};return{getConfig:function(){return"undefined"!=typeof mscgen_js_config&&mscgen_js_config&&"object"==typeof mscgen_js_config&&t(e,mscgen_js_config),e}}}),n("embedding/error-rendering",[],function(){"use strict";function e(e,t){var n=e.toString(),r=t-n.length;for(var i=0;i<r;i++)n=" "+n;return n}function t(t,n){return e(n,3)+" "+t}function n(e,t){return e.split("").reduce(function(e,n,i){return i===t?e+"<span style='text-decoration:underline'>"+r(n)+"</span>":e+r(n)},"")}function r(e){return e.replace(/</g,"&lt;")}return{formatNumber:e,deHTMLize:r,renderError:function(i,s,o){var u=s?"<pre><div style='color: red'># ERROR on line "+s.start.line+", column "+s.start.column+" - "+o+"</div>":"<pre><div style='color: red'># ERROR "+o+"</div>";return i.split("\n").reduce(function(e,i,o){return!s||o!==s.start.line-1?e+r(t(i,o+1))+"\n":e+"<mark>"+t(n(i,s.start.column-1),o+1)+"\n"+"</mark>"},u)+"</pre>"}}}),n("utl/domutl",[],function(){"use strict";return{SS:function(t){return{show:function(e){t.removeAttribute("style"),e&&(t.style.display=e)},hide:function(){t.style.display="none"},toggle:function(){t.style.display==="none"?t.removeAttribute("style"):t.style.display="none"}}},attachEventHandler:function(e,t,n){var r=document.querySelectorAll(e);for(var i=0;i<r.length;i++)r[i].addEventListener(t,n,!1)},doForAllOfClass:function(e,t){var n=document.getElementsByClassName(e);for(var r=0;r<n.length;r++)t(n[r])},ajax:function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(e){e.target.readyState===XMLHttpRequest.DONE&&(200===r.status?t(e):n(e))},r.open("GET",e),r.responseType="text";try{r.send()}catch(i){n()}}}}),t(["lib/mscgenjs-core/parse/xuparser","lib/mscgenjs-core/parse/msgennyparser","lib/mscgenjs-core/render/graphics/renderast","utl/exporter","embedding/config","embedding/error-rendering","utl/domutl"],function(e,t,n,r,i,s,o){"use strict";function u(){var e=document.getElementsByClassName("mscgen_js");a(e,0),a(document.getElementsByTagName("mscgen"),e.length)}function a(e,t){for(var n=0;n<e.length;n++)f(e[n],t+n)}function f(e,t){e.hasAttribute("data-renderedby")||c(e,t)}function l(e,t){e.innerHTML="<div style='color: red'>"+t+"</div>"}function c(e,t){d(e,t),e.setAttribute("data-renderedby","mscgen_js"),i.getConfig().loadFromSrcAttribute&&!!e.getAttribute("data-src")?o.ajax(e.getAttribute("data-src"),function(n){h(e,n.target.response)},function(){l(e,"ERROR: Could not find or open the URL '"+e.getAttribute("data-src")+"' specified in the <code>data-src</code> attribute.")}):!i.getConfig().loadFromSrcAttribute&&!!e.getAttribute("data-src")?l(e,"ERROR: Won't load the chart specified in <code>data-src='"+e.getAttribute("data-src")+"'</code>, "+"because loading from separate files is switched off in the "+"mscgen_js configuration."+"<br><br>See "+"<a href='https://sverweij.github.io/mscgen_js/embed.html#loading-from-separate-files'>Loading charts from separate files</a>"+" in the mscgen_js embedding guide how to enable it."):h(e,e.textContent)}function h(e,t){var n=v(e),r=m(t,n);r.entities?g(r,e.id,t,n):e.innerHTML=s.renderError(t,r.location,r.message)}function p(e,t,n){var s={pathname:"index.html"},o=document.createElement("a");return o.setAttribute("href",i.getConfig().clickURL+r.toLocationString(s,e,t)),o.setAttribute("id",n+"link"),o.setAttribute("style","text-decoration: none;"),o.setAttribute("title","click to edit in the mscgen_js interpreter"),o}function d(e,t){e.id||(e.id=i.getConfig().parentElementPrefix+t.toString())}function v(e){var t=e.getAttribute("data-language");return t||(t=i.getConfig().defaultLanguage),t}function m(n,r){var i={};try{"msgenny"===r?i=t.parse(n):"json"===r?i=JSON.parse(n):i=e.parse(n)}catch(s){return s}return i}function g(e,t,r,s){var o=document.getElementById(t);o.innerHTML="",!0===i.getConfig().clickable&&(o.appendChild(p(r,s,t)),t+="link"),n.clean(t,window),n.renderAST(e,r,t,window)}u()}),n("mscgen-inpage",function(){})})();