/**
     * Renders individual elements in sequence charts
     * @exports renderutensils
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/*
 This file is part of mscgen_js.

 mscgen_js is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 mscgen_js is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
 */

/**
     * sets up a skeleton svg, with the skeleton for rendering an msc ready
     *
     *  desc with id __msc_source - will contain the msc source
     *  defs
     *      a list of markers used as arrow heads (each with an own id)
     *      a stylesheet (without an id)
     *      __defs - placeholder to put the msc elements in
     *  __body - a stack of layers, from bottom to top:
     *      __background    -
     *      __arcspanlayer  - for inline expressions ("arc spanning arcs")
     *      __lifelinelayer - for the lifelines
     *      __sequencelayer - for arcs and associated text
     *      __notelayer     - for notes and boxes - the labels of arcspanning arcs
     *                        will go in here as well
     * @exports renderskeleton
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/**
 * A hodge podge of functions manipulating text
 *
 * @exports node/textutensils
 * @license GPLv3
 * @author {@link https://github.com/sverweij | Sander Verweij}
 */

/**
     *
     * @exports node/asttransform
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/**
 * Defines several mappings of arckinds to agregations
 *
 * @exports node/dotmap
 * @license GPLv3
 * @author {@link https://github.com/sverweij | Sander Verweij}
 */

/**
 * Defines some functions to simplify a given abstract syntax tree.
 *
 * @exports node/flatten
 * @license GPLv3
 * @author {@link https://github.com/sverweij | Sander Verweij}
 */

/**
     *
     * renders an abstract syntax tree of a sequence chart
     *
     * knows of:
     *  - the syntax tree
     *  - the target canvasf
     *
     * Defines default sizes and distances for all objects.

     issue #13
     To get markers to work in canvg and to color them the same color as
     the associate line, we'll need to do something like this:

     <svg xmlns="http://www.w3.org/2000/svg" version="1.1">
     <g transform="translate(10,20)">
     <defs>
     <marker viewBox="0 0 10 10" id="end" refX="9" refY="3" markerUnits="strokeWidth" markerWidth="10" markerHeight="10" orient="auto">
     <path d="M 1 1 l 8 2 l -8 2 " fill="none" stroke="#ABCDEF" stroke-width="1"/>
     </marker>
     </defs>
     <line x1="50" y1="20" x2="210" y2="20" stroke-width="2" stroke="#ABCDEF" marker-end="url(#end)"/>
     </g>
     </svg>
     * @exports renderast
     * @license GPLv3
     * @author {@link https://github.com/sverweij | Sander Verweij}
     */

/*
    This file is part of mscgen_js.

    mscgen_js is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    mscgen_js is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
*/

define("xuparser",[],function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i,s){this.message=e,this.expected=t,this.found=n,this.offset=r,this.line=i,this.column=s,this.name="SyntaxError"}function n(e){function Ai(){return e.substring(Si,Ei)}function Oi(){return Si}function Mi(){return Hi(Si).line}function _i(){return Hi(Si).column}function Di(e){throw ji(null,[{type:"other",description:e}],Si)}function Pi(e){throw ji(e,null,Si)}function Hi(t){function n(t,n,r){var i,s;for(i=n;i<r;i++)s=e.charAt(i),s==="\n"?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):s==="\r"||s==="\u2028"||s==="\u2029"?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return xi!==t&&(xi>t&&(xi=0,Ti={line:1,column:1,seenCR:!1}),n(Ti,xi,t),xi=t),Ti}function Bi(e){if(Ei<Ni)return;Ei>Ni&&(Ni=Ei,Ci=[]),Ci.push(e)}function ji(n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}var u=Hi(i),a=i<e.length?e.charAt(i):null;return r!==null&&s(r),new t(n!==null?n:o(r,a),r,a,i,u.line,u.column)}function Fi(){var t,n,i,s,h,p,d,v,m,g;return t=Ei,n=gs(),n!==r?(i=Ii(),i!==r?(s=gs(),s!==r?(e.charCodeAt(Ei)===123?(h=u,Ei++):(h=r,ki===0&&Bi(a)),h!==r?(p=gs(),p!==r?(d=qi(),d!==r?(v=gs(),v!==r?(e.charCodeAt(Ei)===125?(m=f,Ei++):(m=r,ki===0&&Bi(l)),m!==r?(g=gs(),g!==r?(Si=t,n=c(i,d),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t}function Ii(){var t;return e.substr(Ei,3).toLowerCase()===h?(t=e.substr(Ei,3),Ei+=3):(t=r,ki===0&&Bi(p)),t}function qi(){var e,t,n,i,s;return e=Ei,t=Ei,n=Ri(),n!==r&&(Si=t,n=v(n)),t=n,t===r&&(t=d),t!==r?(n=Ei,i=Wi(),i!==r&&(Si=n,i=m(i)),n=i,n===r&&(n=d),n!==r?(i=Ei,s=Vi(),s!==r&&(Si=i,s=g(s)),i=s,i===r&&(i=d),i!==r?(t=[t,n,i],e=t):(Ei=e,e=o)):(Ei=e,e=o)):(Ei=e,e=o),e}function Ri(){var t,n,i,s,u,a;t=Ei,n=Ei,i=[],s=Ei,u=Ui(),u!==r?(e.charCodeAt(Ei)===44?(a=b,Ei++):(a=r,ki===0&&Bi(w)),a!==r?(Si=s,u=E(u),s=u):(Ei=s,s=o)):(Ei=s,s=o);while(s!==r)i.push(s),s=Ei,u=Ui(),u!==r?(e.charCodeAt(Ei)===44?(a=b,Ei++):(a=r,ki===0&&Bi(w)),a!==r?(Si=s,u=E(u),s=u):(Ei=s,s=o)):(Ei=s,s=o);return i!==r?(s=Ei,u=Ui(),u!==r?(e.charCodeAt(Ei)===59?(a=S,Ei++):(a=r,ki===0&&Bi(x)),a!==r?(Si=s,u=E(u),s=u):(Ei=s,s=o)):(Ei=s,s=o),s!==r?(i=[i,s],n=i):(Ei=n,n=o)):(Ei=n,n=o),n!==r&&(Si=t,n=T(n)),t=n,t}function Ui(){var t,n,i,s,u,a,f,l;return t=Ei,n=gs(),n!==r?(i=zi(),i!==r?(s=gs(),s!==r?(e.charCodeAt(Ei)===61?(u=N,Ei++):(u=r,ki===0&&Bi(C)),u!==r?(a=gs(),a!==r?(f=Ei,l=cs(),l!==r&&(Si=f,l=k(l)),f=l,f===r&&(f=Ei,l=ys(),l!==r&&(Si=f,l=L(l)),f=l,f===r&&(f=Ei,l=Es(),l!==r&&(Si=f,l=A(l)),f=l)),f!==r?(l=gs(),l!==r?(Si=t,n=O(i,f),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t}function zi(){var t;return e.substr(Ei,6).toLowerCase()===M?(t=e.substr(Ei,6),Ei+=6):(t=r,ki===0&&Bi(_)),t===r&&(e.substr(Ei,5).toLowerCase()===D?(t=e.substr(Ei,5),Ei+=5):(t=r,ki===0&&Bi(P)),t===r&&(e.substr(Ei,11).toLowerCase()===H?(t=e.substr(Ei,11),Ei+=11):(t=r,ki===0&&Bi(B)),t===r&&(e.substr(Ei,12).toLowerCase()===j?(t=e.substr(Ei,12),Ei+=12):(t=r,ki===0&&Bi(F)),t===r&&(e.substr(Ei,9).toLowerCase()===I?(t=e.substr(Ei,9),Ei+=9):(t=r,ki===0&&Bi(q)))))),t}function Wi(){var t,n,i,s,u,a;t=Ei,n=Ei,i=[],s=Ei,u=Xi(),u!==r?(e.charCodeAt(Ei)===44?(a=b,Ei++):(a=r,ki===0&&Bi(w)),a!==r?(Si=s,u=R(u),s=u):(Ei=s,s=o)):(Ei=s,s=o);while(s!==r)i.push(s),s=Ei,u=Xi(),u!==r?(e.charCodeAt(Ei)===44?(a=b,Ei++):(a=r,ki===0&&Bi(w)),a!==r?(Si=s,u=R(u),s=u):(Ei=s,s=o)):(Ei=s,s=o);return i!==r?(s=Ei,u=Xi(),u!==r?(e.charCodeAt(Ei)===59?(a=S,Ei++):(a=r,ki===0&&Bi(x)),a!==r?(Si=s,u=R(u),s=u):(Ei=s,s=o)):(Ei=s,s=o),s!==r?(i=[i,s],n=i):(Ei=n,n=o)):(Ei=n,n=o),n!==r&&(Si=t,n=U(n)),t=n,t}function Xi(){var t,n,i,s,u,a,f,l;return ki++,t=Ei,n=gs(),n!==r?(i=ps(),i!==r?(s=gs(),s!==r?(u=Ei,e.charCodeAt(Ei)===91?(a=W,Ei++):(a=r,ki===0&&Bi(X)),a!==r?(f=as(),f!==r?(e.charCodeAt(Ei)===93?(l=V,Ei++):(l=r,ki===0&&Bi($)),l!==r?(Si=u,a=J(f),u=a):(Ei=u,u=o)):(Ei=u,u=o)):(Ei=u,u=o),u===r&&(u=d),u!==r?(a=gs(),a!==r?(Si=t,n=K(i,u),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),ki--,t===r&&(n=r,ki===0&&Bi(z)),t}function Vi(){var t,n,i,s,u;t=[],n=Ei,i=$i(),i!==r?(s=gs(),s!==r?(e.charCodeAt(Ei)===59?(u=S,Ei++):(u=r,ki===0&&Bi(x)),u!==r?(Si=n,i=J(i),n=i):(Ei=n,n=o)):(Ei=n,n=o)):(Ei=n,n=o);if(n!==r)while(n!==r)t.push(n),n=Ei,i=$i(),i!==r?(s=gs(),s!==r?(e.charCodeAt(Ei)===59?(u=S,Ei++):(u=r,ki===0&&Bi(x)),u!==r?(Si=n,i=J(i),n=i):(Ei=n,n=o)):(Ei=n,n=o)):(Ei=n,n=o);else t=o;return t}function $i(){var t,n,i,s,u,a,f;t=Ei,n=Ei,i=[],s=Ei,u=Ji(),u!==r?(a=gs(),a!==r?(e.charCodeAt(Ei)===44?(f=b,Ei++):(f=r,ki===0&&Bi(w)),f!==r?(Si=s,u=J(u),s=u):(Ei=s,s=o)):(Ei=s,s=o)):(Ei=s,s=o);while(s!==r)i.push(s),s=Ei,u=Ji(),u!==r?(a=gs(),a!==r?(e.charCodeAt(Ei)===44?(f=b,Ei++):(f=r,ki===0&&Bi(w)),f!==r?(Si=s,u=J(u),s=u):(Ei=s,s=o)):(Ei=s,s=o)):(Ei=s,s=o);return i!==r?(s=Ei,u=Ji(),u!==r&&(Si=s,u=Q(u)),s=u,s!==r?(i=[i,s],n=i):(Ei=n,n=o)):(Ei=n,n=o),n!==r&&(Si=t,n=G(n)),t=n,t}function Ji(){var e;return e=Ki(),e===r&&(e=Zi()),e}function Ki(){var t,n,i,s,u,a;return t=Ei,n=Ei,i=Qi(),i!==r&&(Si=n,i=J(i)),n=i,n===r&&(n=Ei,i=Yi(),i!==r&&(Si=n,i=J(i)),n=i,n===r&&(n=Ei,i=Gi(),i!==r&&(Si=n,i=J(i)),n=i)),n!==r?(i=Ei,e.charCodeAt(Ei)===91?(s=W,Ei++):(s=r,ki===0&&Bi(X)),s!==r?(u=as(),u!==r?(e.charCodeAt(Ei)===93?(a=V,Ei++):(a=r,ki===0&&Bi($)),a!==r?(Si=i,s=Y(u),i=s):(Ei=i,i=o)):(Ei=i,i=o)):(Ei=i,i=o),i===r&&(i=d),i!==r?(Si=t,n=Z(n,i),t=n):(Ei=t,t=o)):(Ei=t,t=o),t}function Qi(){var e,t,n,i;return e=Ei,t=gs(),t!==r?(n=es(),n!==r?(i=gs(),i!==r?(Si=e,t=et(n),e=t):(Ei=e,e=o)):(Ei=e,e=o)):(Ei=e,e=o),e}function Gi(){var e,t,n,i;return e=Ei,t=gs(),t!==r?(n=ts(),n!==r?(i=gs(),i!==r?(Si=e,t=et(n),e=t):(Ei=e,e=o)):(Ei=e,e=o)):(Ei=e,e=o),e}function Yi(){var t,n,i,s,u,a,f,l;return t=Ei,n=gs(),n!==r?(i=ps(),i!==r?(s=gs(),s!==r?(u=ns(),u!==r?(a=gs(),a!==r?(f=ps(),f!==r?(l=gs(),l!==r?(Si=t,n=tt(i,u,f),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t===r&&(t=Ei,n=gs(),n!==r?(e.charCodeAt(Ei)===42?(i=nt,Ei++):(i=r,ki===0&&Bi(rt)),i!==r?(s=gs(),s!==r?(u=ss(),u!==r?(a=gs(),a!==r?(f=ps(),f!==r?(l=gs(),l!==r?(Si=t,n=it(u,f),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t===r&&(t=Ei,n=gs(),n!==r?(i=ps(),i!==r?(s=gs(),s!==r?(u=is(),u!==r?(a=gs(),a!==r?(e.charCodeAt(Ei)===42?(f=nt,Ei++):(f=r,ki===0&&Bi(rt)),f!==r?(l=gs(),l!==r?(Si=t,n=st(i,u),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o))),t}function Zi(){var t,n,i,s,c,h,p,v,m,g,y,b,w,E,S,x;return t=Ei,n=gs(),n!==r?(i=ps(),i!==r?(s=gs(),s!==r?(c=us(),c!==r?(h=gs(),h!==r?(p=ps(),p!==r?(v=gs(),v!==r?(m=Ei,e.charCodeAt(Ei)===91?(g=W,Ei++):(g=r,ki===0&&Bi(X)),g!==r?(y=as(),y!==r?(e.charCodeAt(Ei)===93?(b=V,Ei++):(b=r,ki===0&&Bi($)),b!==r?(Si=m,g=Y(y),m=g):(Ei=m,m=o)):(Ei=m,m=o)):(Ei=m,m=o),m===r&&(m=d),m!==r?(g=gs(),g!==r?(e.charCodeAt(Ei)===123?(y=u,Ei++):(y=r,ki===0&&Bi(a)),y!==r?(b=gs(),b!==r?(w=Vi(),w!==r?(E=gs(),E!==r?(e.charCodeAt(Ei)===125?(S=f,Ei++):(S=r,ki===0&&Bi(l)),S!==r?(x=gs(),x!==r?(Si=t,n=ot(i,c,p,m,w),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t}function es(){var t;return e.substr(Ei,3)===ut?(t=ut,Ei+=3):(t=r,ki===0&&Bi(at)),t===r&&(e.substr(Ei,3)===ft?(t=ft,Ei+=3):(t=r,ki===0&&Bi(lt))),t}function ts(){var t;return e.substr(Ei,3)===ct?(t=ct,Ei+=3):(t=r,ki===0&&Bi(ht)),t}function ns(){var e,t;return e=Ei,t=rs(),t===r&&(t=is(),t===r&&(t=ss(),t===r&&(t=os()))),t!==r&&(Si=e,t=pt(t)),e=t,e}function rs(){var t,n;return ki++,e.substr(Ei,2)===vt?(t=vt,Ei+=2):(t=r,ki===0&&Bi(mt)),t===r&&(e.substr(Ei,3)===gt?(t=gt,Ei+=3):(t=r,ki===0&&Bi(yt)),t===r&&(e.substr(Ei,2)===bt?(t=bt,Ei+=2):(t=r,ki===0&&Bi(wt)),t===r&&(e.substr(Ei,5)===Et?(t=Et,Ei+=5):(t=r,ki===0&&Bi(St)),t===r&&(e.substr(Ei,3)===xt?(t=xt,Ei+=3):(t=r,ki===0&&Bi(Tt)),t===r&&(e.substr(Ei,2)===Nt?(t=Nt,Ei+=2):(t=r,ki===0&&Bi(Ct)),t===r&&(e.substr(Ei,4)===kt?(t=kt,Ei+=4):(t=r,ki===0&&Bi(Lt)),t===r&&(e.substr(Ei,2)===At?(t=At,Ei+=2):(t=r,ki===0&&Bi(Ot)),t===r&&(e.substr(Ei,3)===Mt?(t=Mt,Ei+=3):(t=r,ki===0&&Bi(_t)))))))))),ki--,t===r&&(n=r,ki===0&&Bi(dt)),t}function is(){var t,n;return ki++,e.substr(Ei,2)===Pt?(t=Pt,Ei+=2):(t=r,ki===0&&Bi(Ht)),t===r&&(e.substr(Ei,3)===Bt?(t=Bt,Ei+=3):(t=r,ki===0&&Bi(jt)),t===r&&(e.substr(Ei,2)===Ft?(t=Ft,Ei+=2):(t=r,ki===0&&Bi(It)),t===r&&(e.substr(Ei,2)===qt?(t=qt,Ei+=2):(t=r,ki===0&&Bi(Rt)),t===r&&(e.substr(Ei,2)===Ut?(t=Ut,Ei+=2):(t=r,ki===0&&Bi(zt)),t===r&&(e.substr(Ei,2).toLowerCase()===Wt?(t=e.substr(Ei,2),Ei+=2):(t=r,ki===0&&Bi(Xt))))))),ki--,t===r&&(n=r,ki===0&&Bi(Dt)),t}function ss(){var t,n;return ki++,e.substr(Ei,2)===$t?(t=$t,Ei+=2):(t=r,ki===0&&Bi(Jt)),t===r&&(e.substr(Ei,3)===Kt?(t=Kt,Ei+=3):(t=r,ki===0&&Bi(Qt)),t===r&&(e.substr(Ei,2)===Gt?(t=Gt,Ei+=2):(t=r,ki===0&&Bi(Yt)),t===r&&(e.substr(Ei,2)===Zt?(t=Zt,Ei+=2):(t=r,ki===0&&Bi(en)),t===r&&(e.substr(Ei,2)===tn?(t=tn,Ei+=2):(t=r,ki===0&&Bi(nn)),t===r&&(e.substr(Ei,2).toLowerCase()===rn?(t=e.substr(Ei,2),Ei+=2):(t=r,ki===0&&Bi(sn))))))),ki--,t===r&&(n=r,ki===0&&Bi(Vt)),t}function os(){var t,n;return ki++,e.substr(Ei,4).toLowerCase()===un?(t=e.substr(Ei,4),Ei+=4):(t=r,ki===0&&Bi(an)),t===r&&(e.substr(Ei,4).toLowerCase()===fn?(t=e.substr(Ei,4),Ei+=4):(t=r,ki===0&&Bi(ln)),t===r&&(e.substr(Ei,4).toLowerCase()===cn?(t=e.substr(Ei,4),Ei+=4):(t=r,ki===0&&Bi(hn)),t===r&&(e.substr(Ei,3).toLowerCase()===pn?(t=e.substr(Ei,3),Ei+=3):(t=r,ki===0&&Bi(dn))))),ki--,t===r&&(n=r,ki===0&&Bi(on)),t}function us(){var t,n;return ki++,t=Ei,e.substr(Ei,3).toLowerCase()===mn?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(gn)),n===r&&(e.substr(Ei,4).toLowerCase()===yn?(n=e.substr(Ei,4),Ei+=4):(n=r,ki===0&&Bi(bn)),n===r&&(e.substr(Ei,3).toLowerCase()===wn?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(En)),n===r&&(e.substr(Ei,5).toLowerCase()===Sn?(n=e.substr(Ei,5),Ei+=5):(n=r,ki===0&&Bi(xn)),n===r&&(e.substr(Ei,3).toLowerCase()===Tn?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(Nn)),n===r&&(e.substr(Ei,3).toLowerCase()===Cn?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(kn)),n===r&&(e.substr(Ei,6).toLowerCase()===Ln?(n=e.substr(Ei,6),Ei+=6):(n=r,ki===0&&Bi(An)),n===r&&(e.substr(Ei,3).toLowerCase()===On?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(Mn)),n===r&&(e.substr(Ei,8).toLowerCase()===_n?(n=e.substr(Ei,8),Ei+=8):(n=r,ki===0&&Bi(Dn)),n===r&&(e.substr(Ei,6).toLowerCase()===Pn?(n=e.substr(Ei,6),Ei+=6):(n=r,ki===0&&Bi(Hn)),n===r&&(e.substr(Ei,8).toLowerCase()===Bn?(n=e.substr(Ei,8),Ei+=8):(n=r,ki===0&&Bi(jn)),n===r&&(e.substr(Ei,6).toLowerCase()===Fn?(n=e.substr(Ei,6),Ei+=6):(n=r,ki===0&&Bi(In)),n===r&&(e.substr(Ei,4).toLowerCase()===qn?(n=e.substr(Ei,4),Ei+=4):(n=r,ki===0&&Bi(Rn)),n===r&&(e.substr(Ei,3).toLowerCase()===Un?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(zn)),n===r&&(e.substr(Ei,3).toLowerCase()===Wn?(n=e.substr(Ei,3),Ei+=3):(n=r,ki===0&&Bi(Xn)))))))))))))))),n!==r&&(Si=t,n=pt(n)),t=n,ki--,t===r&&(n=r,ki===0&&Bi(vn)),t}function as(){var t,n,i,s,u,a;t=Ei,n=Ei,i=[],s=Ei,u=fs(),u!==r?(e.charCodeAt(Ei)===44?(a=b,Ei++):(a=r,ki===0&&Bi(w)),a!==r?(Si=s,u=J(u),s=u):(Ei=s,s=o)):(Ei=s,s=o);while(s!==r)i.push(s),s=Ei,u=fs(),u!==r?(e.charCodeAt(Ei)===44?(a=b,Ei++):(a=r,ki===0&&Bi(w)),a!==r?(Si=s,u=J(u),s=u):(Ei=s,s=o)):(Ei=s,s=o);return i!==r?(s=Ei,u=fs(),u!==r&&(Si=s,u=J(u)),s=u,s!==r?(i=[i,s],n=i):(Ei=n,n=o)):(Ei=n,n=o),n!==r&&(Si=t,n=Vn(n)),t=n,t}function fs(){var t,n,i,s,u,a,f,l;return t=Ei,n=gs(),n!==r?(i=ls(),i!==r?(s=gs(),s!==r?(e.charCodeAt(Ei)===61?(u=N,Ei++):(u=r,ki===0&&Bi(C)),u!==r?(a=gs(),a!==r?(f=ps(),f!==r?(l=gs(),l!==r?(Si=t,n=$n(i,f),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t}function ls(){var t,n;return ki++,e.substr(Ei,5).toLowerCase()===Kn?(t=e.substr(Ei,5),Ei+=5):(t=r,ki===0&&Bi(Qn)),t===r&&(e.substr(Ei,5).toLowerCase()===Gn?(t=e.substr(Ei,5),Ei+=5):(t=r,ki===0&&Bi(Yn)),t===r&&(e.substr(Ei,2).toLowerCase()===Zn?(t=e.substr(Ei,2),Ei+=2):(t=r,ki===0&&Bi(er)),t===r&&(e.substr(Ei,3).toLowerCase()===tr?(t=e.substr(Ei,3),Ei+=3):(t=r,ki===0&&Bi(nr)),t===r&&(e.substr(Ei,9).toLowerCase()===rr?(t=e.substr(Ei,9),Ei+=9):(t=r,ki===0&&Bi(ir)),t===r&&(e.substr(Ei,10).toLowerCase()===sr?(t=e.substr(Ei,10),Ei+=10):(t=r,ki===0&&Bi(or)),t===r&&(e.substr(Ei,9).toLowerCase()===ur?(t=e.substr(Ei,9),Ei+=9):(t=r,ki===0&&Bi(ar)),t===r&&(e.substr(Ei,10).toLowerCase()===fr?(t=e.substr(Ei,10),Ei+=10):(t=r,ki===0&&Bi(lr)),t===r&&(e.substr(Ei,11).toLowerCase()===cr?(t=e.substr(Ei,11),Ei+=11):(t=r,ki===0&&Bi(hr)),t===r&&(e.substr(Ei,12).toLowerCase()===pr?(t=e.substr(Ei,12),Ei+=12):(t=r,ki===0&&Bi(dr)),t===r&&(e.substr(Ei,12).toLowerCase()===vr?(t=e.substr(Ei,12),Ei+=12):(t=r,ki===0&&Bi(mr)),t===r&&(e.substr(Ei,13).toLowerCase()===gr?(t=e.substr(Ei,13),Ei+=13):(t=r,ki===0&&Bi(yr)),t===r&&(e.substr(Ei,12).toLowerCase()===br?(t=e.substr(Ei,12),Ei+=12):(t=r,ki===0&&Bi(wr)),t===r&&(e.substr(Ei,13).toLowerCase()===Er?(t=e.substr(Ei,13),Ei+=13):(t=r,ki===0&&Bi(Sr)),t===r&&(e.substr(Ei,14).toLowerCase()===xr?(t=e.substr(Ei,14),Ei+=14):(t=r,ki===0&&Bi(Tr)),t===r&&(e.substr(Ei,15).toLowerCase()===Nr?(t=e.substr(Ei,15),Ei+=15):(t=r,ki===0&&Bi(Cr)),t===r&&(e.substr(Ei,7).toLowerCase()===kr?(t=e.substr(Ei,7),Ei+=7):(t=r,ki===0&&Bi(Lr)))))))))))))))))),ki--,t===r&&(n=r,ki===0&&Bi(Jn)),t}function cs(){var t,n,i,s;return t=Ei,e.charCodeAt(Ei)===34?(n=Ar,Ei++):(n=r,ki===0&&Bi(Or)),n!==r?(i=hs(),i!==r?(e.charCodeAt(Ei)===34?(s=Ar,Ei++):(s=r,ki===0&&Bi(Or)),s!==r?(Si=t,n=Mr(i),t=n):(Ei=t,t=o)):(Ei=t,t=o)):(Ei=t,t=o),t}function hs(){var t,n,i,s;t=[],n=Ei,i=Ei,ki++,e.charCodeAt(Ei)===34?(s=Ar,Ei++):(s=r,ki===0&&Bi(Or)),ki--,s===r?i=_r:(Ei=i,i=o),i!==r?(e.substr(Ei,2)===Dr?(s=Dr,Ei+=2):(s=r,ki===0&&Bi(Pr)),s===r&&(e.length>Ei?(s=e.charAt(Ei),Ei++):(s=r,ki===0&&Bi(Hr))),s!==r?(Si=n,i=Br(s),n=i):(Ei=n,n=o)):(Ei=n,n=o);while(n!==r)t.push(n),n=Ei,i=Ei,ki++,e.charCodeAt(Ei)===34?(s=Ar,Ei++):(s=r,ki===0&&Bi(Or)),ki--,s===r?i=_r:(Ei=i,i=o),i!==r?(e.substr(Ei,2)===Dr?(s=Dr,Ei+=2):(s=r,ki===0&&Bi(Pr)),s===r&&(e.length>Ei?(s=e.charAt(Ei),Ei++):(s=r,ki===0&&Bi(Hr))),s!==r?(Si=n,i=Br(s),n=i):(Ei=n,n=o)):(Ei=n,n=o);return t}function ps(){var t,n,i;ki++,t=Ei,n=[],Fr.test(e.charAt(Ei))?(i=e.charAt(Ei),Ei++):(i=r,ki===0&&Bi(Ir));if(i!==r)while(i!==r)n.push(i),Fr.test(e.charAt(Ei))?(i=e.charAt(Ei),Ei++):(i=r,ki===0&&Bi(Ir));else n=o;return n!==r&&(Si=t,n=qr(n)),t=n,t===r&&(t=cs()),ki--,t===r&&(n=r,ki===0&&Bi(jr)),t}function ds(){var t,n;return ki++,Ur.test(e.charAt(Ei))?(t=e.charAt(Ei),Ei++):(t=r,ki===0&&Bi(zr)),ki--,t===r&&(n=r,ki===0&&Bi(Rr)),t}function vs(){var t,n;return ki++,Xr.test(e.charAt(Ei))?(t=e.charAt(Ei),Ei++):(t=r,ki===0&&Bi(Vr)),ki--,t===r&&(n=r,ki===0&&Bi(Wr)),t}function ms(){var t,n,i,s,u,a;ki++,t=Ei,e.substr(Ei,2)===Jr?(n=Jr,Ei+=2):(n=r,ki===0&&Bi(Kr)),n===r&&(e.charCodeAt(Ei)===35?(n=Qr,Ei++):(n=r,ki===0&&Bi(Gr)));if(n!==r){i=[],Yr.test(e.charAt(Ei))?(s=e.charAt(Ei),Ei++):(s=r,ki===0&&Bi(Zr));while(s!==r)i.push(s),Yr.test(e.charAt(Ei))?(s=e.charAt(Ei),Ei++):(s=r,ki===0&&Bi(Zr));i!==r?(n=[n,i],t=n):(Ei=t,t=o)}else Ei=t,t=o;if(t===r){t=Ei,e.substr(Ei,2)===ei?(n=ei,Ei+=2):(n=r,ki===0&&Bi(ti));if(n!==r){i=[],s=Ei,u=Ei,ki++,e.substr(Ei,2)===ni?(a=ni,Ei+=2):(a=r,ki===0&&Bi(ri)),ki--,a===r?u=_r:(Ei=u,u=o),u!==r?(e.length>Ei?(a=e.charAt(Ei),Ei++):(a=r,ki===0&&Bi(Hr)),a!==r?(u=[u,a],s=u):(Ei=s,s=o)):(Ei=s,s=o);while(s!==r)i.push(s),s=Ei,u=Ei,ki++,e.substr(Ei,2)===ni?(a=ni,Ei+=2):(a=r,ki===0&&Bi(ri)),ki--,a===r?u=_r:(Ei=u,u=o),u!==r?(e.length>Ei?(a=e.charAt(Ei),Ei++):(a=r,ki===0&&Bi(Hr)),a!==r?(u=[u,a],s=u):(Ei=s,s=o)):(Ei=s,s=o);i!==r?(e.substr(Ei,2)===ni?(s=ni,Ei+=2):(s=r,ki===0&&Bi(ri)),s!==r?(n=[n,i,s],t=n):(Ei=t,t=o)):(Ei=t,t=o)}else Ei=t,t=o}return ki--,t===r&&(n=r,ki===0&&Bi($r)),t}function gs(){var e,t,n;e=[],t=[],n=ds();if(n!==r)while(n!==r)t.push(n),n=ds();else t=o;if(t===r){t=[],n=vs();if(n!==r)while(n!==r)t.push(n),n=vs();else t=o;if(t===r){t=[],n=ms();if(n!==r)while(n!==r)t.push(n),n=ms();else t=o}}while(t!==r){e.push(t),t=[],n=ds();if(n!==r)while(n!==r)t.push(n),n=ds();else t=o;if(t===r){t=[],n=vs();if(n!==r)while(n!==r)t.push(n),n=vs();else t=o;if(t===r){t=[],n=ms();if(n!==r)while(n!==r)t.push(n),n=ms();else t=o}}}return e}function ys(){var e;return e=ws(),e===r&&(e=bs()),e}function bs(){var t,n,i;ki++,t=Ei,n=[],si.test(e.charAt(Ei))?(i=e.charAt(Ei),Ei++):(i=r,ki===0&&Bi(oi));if(i!==r)while(i!==r)n.push(i),si.test(e.charAt(Ei))?(i=e.charAt(Ei),Ei++):(i=r,ki===0&&Bi(oi));else n=o;return n!==r&&(Si=t,n=ui(n)),t=n,ki--,t===r&&(n=r,ki===0&&Bi(ii)),t}function ws(){var t,n,i,s,u,a;ki++,t=Ei,n=Ei,i=[],si.test(e.charAt(Ei))?(s=e.charAt(Ei),Ei++):(s=r,ki===0&&Bi(oi));if(s!==r)while(s!==r)i.push(s),si.test(e.charAt(Ei))?(s=e.charAt(Ei),Ei++):(s=r,ki===0&&Bi(oi));else i=o;if(i!==r){e.charCodeAt(Ei)===46?(s=fi,Ei++):(s=r,ki===0&&Bi(li));if(s!==r){u=[],si.test(e.charAt(Ei))?(a=e.charAt(Ei),Ei++):(a=r,ki===0&&Bi(oi));if(a!==r)while(a!==r)u.push(a),si.test(e.charAt(Ei))?(a=e.charAt(Ei),Ei++):(a=r,ki===0&&Bi(oi));else u=o;u!==r?(i=[i,s,u],n=i):(Ei=n,n=o)}else Ei=n,n=o}else Ei=n,n=o;return n!==r&&(Si=t,n=ci(n)),t=n,ki--,t===r&&(n=r,ki===0&&Bi(ai)),t}function Es(){var t,n;return ki++,e.substr(Ei,4).toLowerCase()===pi?(t=e.substr(Ei,4),Ei+=4):(t=r,ki===0&&Bi(di)),t===r&&(e.substr(Ei,5).toLowerCase()===vi?(t=e.substr(Ei,5),Ei+=5):(t=r,ki===0&&Bi(mi)),t===r&&(e.substr(Ei,2).toLowerCase()===gi?(t=e.substr(Ei,2),Ei+=2):(t=r,ki===0&&Bi(yi)),t===r&&(e.substr(Ei,3).toLowerCase()===bi?(t=e.substr(Ei,3),Ei+=3):(t=r,ki===0&&Bi(wi))))),ki--,t===r&&(n=r,ki===0&&Bi(hi)),t}function Ss(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function xs(e){var t="false";switch(e.toLowerCase()){case"true":case"on":case"1":t="true"}return t}function Ts(e,t){var n=0;if(t===undefined||t==="*")return!0;if(e&&e.entities&&t)for(n=0;n<e.entities.length;n++)if(e.entities[n].name===t)return!0;return!1}function Ns(e,t){this.message="Entity '"+e+"' in arc ",this.message+="'"+t.from+" "+t.kind+" "+t.to+"' ",this.message+="is not defined.",this.name="EntityNotDefinedError"}function Cs(e,t){var n=0,r=0,i={};e?i=e:i.entities=[];if(t&&t.arcs)for(n=0;n<t.arcs.length;n++)for(r=0;r<t.arcs[n].length;r++){if(!Ts(i,t.arcs[n][r].from))throw new Ns(t.arcs[n][r].from,t.arcs[n][r]);if(!Ts(i,t.arcs[n][r].to))throw new Ns(t.arcs[n][r].to,t.arcs[n][r])}return i}var n=arguments.length>1?arguments[1]:{},r={},i={program:Fi},s=Fi,o=r,u="{",a={type:"literal",value:"{",description:'"{"'},f="}",l={type:"literal",value:"}",description:'"}"'},c=function(e,t){return t[1]=Cs(t[1],t[2]),Ss(t[0],Ss(t[1],t[2]))},h="msc",p={type:"literal",value:"msc",description:'"msc"'},d=null,v=function(e){return{options:e}},m=function(e){return{entities:e}},g=function(e){return{arcs:e}},y=[],b=",",w={type:"literal",value:",",description:'","'},E=function(e){return e},S=";",x={type:"literal",value:";",description:'";"'},T=function(e){var t={},n,r;for(n in e[0])for(r in e[0][n])t[r]=e[0][n][r];return t=Ss(t,e[1]),t},N="=",C={type:"literal",value:"=",description:'"="'},k=function(e){return e},L=function(e){return e.toString()},A=function(e){return e.toString()},O=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=xs(t):n[e]=t,n},M="hscale",_={type:"literal",value:"hscale",description:'"hscale"'},D="width",P={type:"literal",value:"width",description:'"width"'},H="arcgradient",B={type:"literal",value:"arcgradient",description:'"arcgradient"'},j="wordwraparcs",F={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},I="watermark",q={type:"literal",value:"watermark",description:'"watermark"'},R=function(e){return e},U=function(e){return e[0].push(e[1]),e[0]},z={type:"other",description:"entity"},W="[",X={type:"literal",value:"[",description:'"["'},V="]",$={type:"literal",value:"]",description:'"]"'},J=function(e){return e},K=function(e,t){var n={};return n.name=e,n=Ss(n,t),n},Q=function(e){return[e]},G=function(e){return e[0].push(e[1][0]),e[0]},Y=function(e){return e},Z=function(e,t){return e=Ss(e,t),e},et=function(e){return{kind:e}},tt=function(e,t,n){return{kind:t,from:e,to:n}},nt="*",rt={type:"literal",value:"*",description:'"*"'},it=function(e,t){return{kind:e,from:"*",to:t}},st=function(e,t){return{kind:t,from:e,to:"*"}},ot=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return s=Ss(s,r),s},ut="|||",at={type:"literal",value:"|||",description:'"|||"'},ft="...",lt={type:"literal",value:"...",description:'"..."'},ct="---",ht={type:"literal",value:"---",description:'"---"'},pt=function(e){return e.toLowerCase()},dt={type:"other",description:"bi-directional arrow"},vt="--",mt={type:"literal",value:"--",description:'"--"'},gt="<->",yt={type:"literal",value:"<->",description:'"<->"'},bt="==",wt={type:"literal",value:"==",description:'"=="'},Et="<<=>>",St={type:"literal",value:"<<=>>",description:'"<<=>>"'},xt="<=>",Tt={type:"literal",value:"<=>",description:'"<=>"'},Nt="..",Ct={type:"literal",value:"..",description:'".."'},kt="<<>>",Lt={type:"literal",value:"<<>>",description:'"<<>>"'},At="::",Ot={type:"literal",value:"::",description:'"::"'},Mt="<:>",_t={type:"literal",value:"<:>",description:'"<:>"'},Dt={type:"other",description:"left to right arrow"},Pt="->",Ht={type:"literal",value:"->",description:'"->"'},Bt="=>>",jt={type:"literal",value:"=>>",description:'"=>>"'},Ft="=>",It={type:"literal",value:"=>",description:'"=>"'},qt=">>",Rt={type:"literal",value:">>",description:'">>"'},Ut=":>",zt={type:"literal",value:":>",description:'":>"'},Wt="-x",Xt={type:"literal",value:"-x",description:'"-x"'},Vt={type:"other",description:"right to left arrow"},$t="<-",Jt={type:"literal",value:"<-",description:'"<-"'},Kt="<<=",Qt={type:"literal",value:"<<=",description:'"<<="'},Gt="<=",Yt={type:"literal",value:"<=",description:'"<="'},Zt="<<",en={type:"literal",value:"<<",description:'"<<"'},tn="<:",nn={type:"literal",value:"<:",description:'"<:"'},rn="x-",sn={type:"literal",value:"x-",description:'"x-"'},on={type:"other",description:"box"},un="note",an={type:"literal",value:"note",description:'"note"'},fn="abox",ln={type:"literal",value:"abox",description:'"abox"'},cn="rbox",hn={type:"literal",value:"rbox",description:'"rbox"'},pn="box",dn={type:"literal",value:"box",description:'"box"'},vn={type:"other",description:"arc spanning box"},mn="alt",gn={type:"literal",value:"alt",description:'"alt"'},yn="else",bn={type:"literal",value:"else",description:'"else"'},wn="opt",En={type:"literal",value:"opt",description:'"opt"'},Sn="break",xn={type:"literal",value:"break",description:'"break"'},Tn="par",Nn={type:"literal",value:"par",description:'"par"'},Cn="seq",kn={type:"literal",value:"seq",description:'"seq"'},Ln="strict",An={type:"literal",value:"strict",description:'"strict"'},On="neg",Mn={type:"literal",value:"neg",description:'"neg"'},_n="critical",Dn={type:"literal",value:"critical",description:'"critical"'},Pn="ignore",Hn={type:"literal",value:"ignore",description:'"ignore"'},Bn="consider",jn={type:"literal",value:"consider",description:'"consider"'},Fn="assert",In={type:"literal",value:"assert",description:'"assert"'},qn="loop",Rn={type:"literal",value:"loop",description:'"loop"'},Un="ref",zn={type:"literal",value:"ref",description:'"ref"'},Wn="exc",Xn={type:"literal",value:"exc",description:'"exc"'},Vn=function(e){var t={},n,r;for(n in e[0])for(r in e[0][n])t[r]=e[0][n][r];return t=Ss(t,e[1]),t},$n=function(e,t){var n={};return e=e.toLowerCase(),e=e.replace("colour","color"),n[e]=t,n},Jn={type:"other",description:"attribute name"},Kn="label",Qn={type:"literal",value:"label",description:'"label"'},Gn="idurl",Yn={type:"literal",value:"idurl",description:'"idurl"'},Zn="id",er={type:"literal",value:"id",description:'"id"'},tr="url",nr={type:"literal",value:"url",description:'"url"'},rr="linecolor",ir={type:"literal",value:"linecolor",description:'"linecolor"'},sr="linecolour",or={type:"literal",value:"linecolour",description:'"linecolour"'},ur="textcolor",ar={type:"literal",value:"textcolor",description:'"textcolor"'},fr="textcolour",lr={type:"literal",value:"textcolour",description:'"textcolour"'},cr="textbgcolor",hr={type:"literal",value:"textbgcolor",description:'"textbgcolor"'},pr="textbgcolour",dr={type:"literal",value:"textbgcolour",description:'"textbgcolour"'},vr="arclinecolor",mr={type:"literal",value:"arclinecolor",description:'"arclinecolor"'},gr="arclinecolour",yr={type:"literal",value:"arclinecolour",description:'"arclinecolour"'},br="arctextcolor",wr={type:"literal",value:"arctextcolor",description:'"arctextcolor"'},Er="arctextcolour",Sr={type:"literal",value:"arctextcolour",description:'"arctextcolour"'},xr="arctextbgcolor",Tr={type:"literal",value:"arctextbgcolor",description:'"arctextbgcolor"'},Nr="arctextbgcolour",Cr={type:"literal",value:"arctextbgcolour",description:'"arctextbgcolour"'},kr="arcskip",Lr={type:"literal",value:"arcskip",description:'"arcskip"'},Ar='"',Or={type:"literal",value:'"',description:'"\\""'},Mr=function(e){return e.join("")},_r=void 0,Dr='\\"',Pr={type:"literal",value:'\\"',description:'"\\\\\\""'},Hr={type:"any",description:"any character"},Br=function(e){return e},jr={type:"other",description:"identifier"},Fr=/^[A-Za-z_0-9]/,Ir={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},qr=function(e){return e.join("")},Rr={type:"other",description:"whitespace"},Ur=/^[ \t]/,zr={type:"class",value:"[ \\t]",description:"[ \\t]"},Wr={type:"other",description:"lineend"},Xr=/^[\r\n]/,Vr={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},$r={type:"other",description:"comment"},Jr="//",Kr={type:"literal",value:"//",description:'"//"'},Qr="#",Gr={type:"literal",value:"#",description:'"#"'},Yr=/^[^\r\n]/,Zr={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},ei="/*",ti={type:"literal",value:"/*",description:'"/*"'},ni="*/",ri={type:"literal",value:"*/",description:'"*/"'},ii={type:"other",description:"integer"},si=/^[0-9]/,oi={type:"class",value:"[0-9]",description:"[0-9]"},ui=function(e){return parseInt(e.join(""),10)},ai={type:"other",description:"real"},fi=".",li={type:"literal",value:".",description:'"."'},ci=function(e){return parseFloat(e.join(""))},hi={type:"other",description:"boolean"},pi="true",di={type:"literal",value:"true",description:'"true"'},vi="false",mi={type:"literal",value:"false",description:'"false"'},gi="on",yi={type:"literal",value:"on",description:'"on"'},bi="off",wi={type:"literal",value:"off",description:'"off"'},Ei=0,Si=0,xi=0,Ti={line:1,column:1,seenCR:!1},Ni=0,Ci=[],ki=0,Li;if("startRule"in n){if(!(n.startRule in i))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=i[n.startRule]}Li=s();if(Li!==r&&Ei===e.length)return Li;throw Li!==r&&Ei<e.length&&Bi({type:"end",description:"end of input"}),ji(null,Ci,Ni)}return e(t,Error),{SyntaxError:t,parse:n}}),define("msgennyparser",[],function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,r,i,s){this.message=e,this.expected=t,this.found=n,this.offset=r,this.line=i,this.column=s,this.name="SyntaxError"}function n(e){function Vr(){return e.substring(Ir,Fr)}function $r(){return Ir}function Jr(){return Yr(Ir).line}function Kr(){return Yr(Ir).column}function Qr(e){throw ei(null,[{type:"other",description:e}],Ir)}function Gr(e){throw ei(e,null,Ir)}function Yr(t){function n(t,n,r){var i,s;for(i=n;i<r;i++)s=e.charAt(i),s==="\n"?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):s==="\r"||s==="\u2028"||s==="\u2029"?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return qr!==t&&(qr>t&&(qr=0,Rr={line:1,column:1,seenCR:!1}),n(Rr,qr,t),qr=t),Rr}function Zr(e){if(Fr<Ur)return;Fr>Ur&&(Ur=Fr,zr=[]),zr.push(e)}function ei(n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}var u=Yr(i),a=i<e.length?e.charAt(i):null;return r!==null&&s(r),new t(n!==null?n:o(r,a),r,a,i,u.line,u.column)}function ti(){var e,t,n,i;return e=Fr,t=Di(),t!==r?(n=ni(),n!==r?(i=Di(),i!==r?(Ir=e,t=u(n),e=t):(Fr=e,e=o)):(Fr=e,e=o)):(Fr=e,e=o),e}function ni(){var e,t,n,i,s;return e=Fr,t=Fr,n=ri(),n!==r&&(Ir=t,n=f(n)),t=n,t===r&&(t=a),t!==r?(n=Fr,i=oi(),i!==r&&(Ir=n,i=l(i)),n=i,n===r&&(n=a),n!==r?(i=Fr,s=ai(),s!==r&&(Ir=i,s=c(s)),i=s,i===r&&(i=a),i!==r?(t=[t,n,i],e=t):(Fr=e,e=o)):(Fr=e,e=o)):(Fr=e,e=o),e}function ri(){var t,n,i,s,u,a;t=Fr,n=Fr,i=[],s=Fr,u=ii(),u!==r?(e.charCodeAt(Fr)===44?(a=p,Fr++):(a=r,Wr===0&&Zr(d)),a!==r?(Ir=s,u=v(u),s=u):(Fr=s,s=o)):(Fr=s,s=o);while(s!==r)i.push(s),s=Fr,u=ii(),u!==r?(e.charCodeAt(Fr)===44?(a=p,Fr++):(a=r,Wr===0&&Zr(d)),a!==r?(Ir=s,u=v(u),s=u):(Fr=s,s=o)):(Fr=s,s=o);return i!==r?(s=Fr,u=ii(),u!==r?(e.charCodeAt(Fr)===59?(a=m,Fr++):(a=r,Wr===0&&Zr(g)),a!==r?(Ir=s,u=v(u),s=u):(Fr=s,s=o)):(Fr=s,s=o),s!==r?(i=[i,s],n=i):(Fr=n,n=o)):(Fr=n,n=o),n!==r&&(Ir=t,n=y(n)),t=n,t}function ii(){var t,n,i,s,u,a,f,l;return t=Fr,n=Di(),n!==r?(i=si(),i!==r?(s=Di(),s!==r?(e.charCodeAt(Fr)===61?(u=b,Fr++):(u=r,Wr===0&&Zr(w)),u!==r?(a=Di(),a!==r?(f=Fr,l=Ni(),l!==r&&(Ir=f,l=E(l)),f=l,f===r&&(f=Fr,l=Pi(),l!==r&&(Ir=f,l=S(l)),f=l,f===r&&(f=Fr,l=ji(),l!==r&&(Ir=f,l=x(l)),f=l)),f!==r?(l=Di(),l!==r?(Ir=t,n=T(i,f),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o),t}function si(){var t;return e.substr(Fr,6).toLowerCase()===N?(t=e.substr(Fr,6),Fr+=6):(t=r,Wr===0&&Zr(C)),t===r&&(e.substr(Fr,5).toLowerCase()===k?(t=e.substr(Fr,5),Fr+=5):(t=r,Wr===0&&Zr(L)),t===r&&(e.substr(Fr,11).toLowerCase()===A?(t=e.substr(Fr,11),Fr+=11):(t=r,Wr===0&&Zr(O)),t===r&&(e.substr(Fr,12).toLowerCase()===M?(t=e.substr(Fr,12),Fr+=12):(t=r,Wr===0&&Zr(_)),t===r&&(e.substr(Fr,9).toLowerCase()===D?(t=e.substr(Fr,9),Fr+=9):(t=r,Wr===0&&Zr(P)))))),t}function oi(){var t,n,i,s,u,a;t=Fr,n=Fr,i=[],s=Fr,u=ui(),u!==r?(e.charCodeAt(Fr)===44?(a=p,Fr++):(a=r,Wr===0&&Zr(d)),a!==r?(Ir=s,u=H(u),s=u):(Fr=s,s=o)):(Fr=s,s=o);while(s!==r)i.push(s),s=Fr,u=ui(),u!==r?(e.charCodeAt(Fr)===44?(a=p,Fr++):(a=r,Wr===0&&Zr(d)),a!==r?(Ir=s,u=H(u),s=u):(Fr=s,s=o)):(Fr=s,s=o);return i!==r?(s=Fr,u=ui(),u!==r?(e.charCodeAt(Fr)===59?(a=m,Fr++):(a=r,Wr===0&&Zr(g)),a!==r?(Ir=s,u=H(u),s=u):(Fr=s,s=o)):(Fr=s,s=o),s!==r?(i=[i,s],n=i):(Fr=n,n=o)):(Fr=n,n=o),n!==r&&(Ir=t,n=B(n)),t=n,t}function ui(){var t,n,i,s,u,f,l,c,h;return Wr++,t=Fr,n=Di(),n!==r?(i=Ai(),i!==r?(s=Di(),s!==r?(u=Fr,e.charCodeAt(Fr)===58?(f=F,Fr++):(f=r,Wr===0&&Zr(I)),f!==r?(l=Di(),l!==r?(c=Ti(),c!==r?(h=Di(),h!==r?(Ir=u,f=q(c),u=f):(Fr=u,u=o)):(Fr=u,u=o)):(Fr=u,u=o)):(Fr=u,u=o),u===r&&(u=a),u!==r?(Ir=t,n=R(i,u),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o),Wr--,t===r&&(n=r,Wr===0&&Zr(j)),t}function ai(){var t,n,i,s,u;t=[],n=Fr,i=fi(),i!==r?(s=Di(),s!==r?(e.charCodeAt(Fr)===59?(u=m,Fr++):(u=r,Wr===0&&Zr(g)),u!==r?(Ir=n,i=U(i),n=i):(Fr=n,n=o)):(Fr=n,n=o)):(Fr=n,n=o);if(n!==r)while(n!==r)t.push(n),n=Fr,i=fi(),i!==r?(s=Di(),s!==r?(e.charCodeAt(Fr)===59?(u=m,Fr++):(u=r,Wr===0&&Zr(g)),u!==r?(Ir=n,i=U(i),n=i):(Fr=n,n=o)):(Fr=n,n=o)):(Fr=n,n=o);else t=o;return t}function fi(){var t,n,i,s,u,a;t=Fr,n=Fr,i=[],s=Fr,u=li(),u!==r?(e.charCodeAt(Fr)===44?(a=p,Fr++):(a=r,Wr===0&&Zr(d)),a!==r?(Ir=s,u=U(u),s=u):(Fr=s,s=o)):(Fr=s,s=o);while(s!==r)i.push(s),s=Fr,u=li(),u!==r?(e.charCodeAt(Fr)===44?(a=p,Fr++):(a=r,Wr===0&&Zr(d)),a!==r?(Ir=s,u=U(u),s=u):(Fr=s,s=o)):(Fr=s,s=o);return i!==r?(s=Fr,u=li(),u!==r&&(Ir=s,u=z(u)),s=u,s!==r?(i=[i,s],n=i):(Fr=n,n=o)):(Fr=n,n=o),n!==r&&(Ir=t,n=W(n)),t=n,t}function li(){var e;return e=ci(),e===r&&(e=vi()),e}function ci(){var t,n,i,s,u,f,l;return t=Fr,n=Fr,i=hi(),i!==r&&(Ir=n,i=X(i)),n=i,n===r&&(n=Fr,i=di(),i!==r&&(Ir=n,i=V(i)),n=i,n===r&&(n=Fr,i=pi(),i!==r&&(Ir=n,i=$(i)),n=i)),n!==r?(i=Fr,e.charCodeAt(Fr)===58?(s=F,Fr++):(s=r,Wr===0&&Zr(I)),s!==r?(u=Di(),u!==r?(f=Ti(),f!==r?(l=Di(),l!==r?(Ir=i,s=E(f),i=s):(Fr=i,i=o)):(Fr=i,i=o)):(Fr=i,i=o)):(Fr=i,i=o),i===r&&(i=a),i!==r?(Ir=t,n=J(n,i),t=n):(Fr=t,t=o)):(Fr=t,t=o),t}function hi(){var e,t,n,i;return e=Fr,t=Di(),t!==r?(n=mi(),n!==r?(i=Di(),i!==r?(Ir=e,t=K(n),e=t):(Fr=e,e=o)):(Fr=e,e=o)):(Fr=e,e=o),e}function pi(){var e,t,n,i;return e=Fr,t=Di(),t!==r?(n=gi(),n!==r?(i=Di(),i!==r?(Ir=e,t=K(n),e=t):(Fr=e,e=o)):(Fr=e,e=o)):(Fr=e,e=o),e}function di(){var t,n,i,s,u,a,f,l;return t=Fr,n=Di(),n!==r?(i=Ai(),i!==r?(s=Di(),s!==r?(u=yi(),u!==r?(a=Di(),a!==r?(f=Ai(),f!==r?(l=Di(),l!==r?(Ir=t,n=Q(i,u,f),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o),t===r&&(t=Fr,n=Di(),n!==r?(e.charCodeAt(Fr)===42?(i=G,Fr++):(i=r,Wr===0&&Zr(Y)),i!==r?(s=Di(),s!==r?(u=Ei(),u!==r?(a=Di(),a!==r?(f=Ai(),f!==r?(l=Di(),l!==r?(Ir=t,n=Z(u,f),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o),t===r&&(t=Fr,n=Di(),n!==r?(i=Ai(),i!==r?(s=Di(),s!==r?(u=wi(),u!==r?(a=Di(),a!==r?(e.charCodeAt(Fr)===42?(f=G,Fr++):(f=r,Wr===0&&Zr(Y)),f!==r?(l=Di(),l!==r?(Ir=t,n=et(i,u),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o))),t}function vi(){var t,n,i,s,u,f,l,c,h,p,d,v,m,g,y;return t=Fr,n=Di(),n!==r?(i=Ai(),i!==r?(s=Di(),s!==r?(u=xi(),u!==r?(f=Di(),f!==r?(l=Ai(),l!==r?(c=Di(),c!==r?(h=Fr,e.charCodeAt(Fr)===58?(p=F,Fr++):(p=r,Wr===0&&Zr(I)),p!==r?(d=Di(),d!==r?(v=Ti(),v!==r?(m=Di(),m!==r?(Ir=h,p=E(v),h=p):(Fr=h,h=o)):(Fr=h,h=o)):(Fr=h,h=o)):(Fr=h,h=o),h===r&&(h=a),h!==r?(e.charCodeAt(Fr)===123?(p=tt,Fr++):(p=r,Wr===0&&Zr(nt)),p!==r?(d=Di(),d!==r?(v=ai(),v!==r?(m=Di(),m!==r?(e.charCodeAt(Fr)===125?(g=rt,Fr++):(g=r,Wr===0&&Zr(it)),g!==r?(y=Di(),y!==r?(Ir=t,n=st(i,u,l,h,v),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o),t}function mi(){var t;return e.substr(Fr,3)===ot?(t=ot,Fr+=3):(t=r,Wr===0&&Zr(ut)),t===r&&(e.substr(Fr,3)===at?(t=at,Fr+=3):(t=r,Wr===0&&Zr(ft))),t}function gi(){var t;return e.substr(Fr,3)===lt?(t=lt,Fr+=3):(t=r,Wr===0&&Zr(ct)),t}function yi(){var e,t;return e=Fr,t=bi(),t===r&&(t=wi(),t===r&&(t=Ei(),t===r&&(t=Si()))),t!==r&&(Ir=e,t=ht(t)),e=t,e}function bi(){var t,n;return Wr++,e.substr(Fr,2)===dt?(t=dt,Fr+=2):(t=r,Wr===0&&Zr(vt)),t===r&&(e.substr(Fr,3)===mt?(t=mt,Fr+=3):(t=r,Wr===0&&Zr(gt)),t===r&&(e.substr(Fr,2)===yt?(t=yt,Fr+=2):(t=r,Wr===0&&Zr(bt)),t===r&&(e.substr(Fr,5)===wt?(t=wt,Fr+=5):(t=r,Wr===0&&Zr(Et)),t===r&&(e.substr(Fr,3)===St?(t=St,Fr+=3):(t=r,Wr===0&&Zr(xt)),t===r&&(e.substr(Fr,2)===Tt?(t=Tt,Fr+=2):(t=r,Wr===0&&Zr(Nt)),t===r&&(e.substr(Fr,4)===Ct?(t=Ct,Fr+=4):(t=r,Wr===0&&Zr(kt)),t===r&&(e.substr(Fr,2)===Lt?(t=Lt,Fr+=2):(t=r,Wr===0&&Zr(At)),t===r&&(e.substr(Fr,3)===Ot?(t=Ot,Fr+=3):(t=r,Wr===0&&Zr(Mt)))))))))),Wr--,t===r&&(n=r,Wr===0&&Zr(pt)),t}function wi(){var t,n;return Wr++,e.substr(Fr,2)===Dt?(t=Dt,Fr+=2):(t=r,Wr===0&&Zr(Pt)),t===r&&(e.substr(Fr,3)===Ht?(t=Ht,Fr+=3):(t=r,Wr===0&&Zr(Bt)),t===r&&(e.substr(Fr,2)===jt?(t=jt,Fr+=2):(t=r,Wr===0&&Zr(Ft)),t===r&&(e.substr(Fr,2)===It?(t=It,Fr+=2):(t=r,Wr===0&&Zr(qt)),t===r&&(e.substr(Fr,2)===Rt?(t=Rt,Fr+=2):(t=r,Wr===0&&Zr(Ut)),t===r&&(e.substr(Fr,2).toLowerCase()===zt?(t=e.substr(Fr,2),Fr+=2):(t=r,Wr===0&&Zr(Wt))))))),Wr--,t===r&&(n=r,Wr===0&&Zr(_t)),t}function Ei(){var t,n;return Wr++,e.substr(Fr,2)===Vt?(t=Vt,Fr+=2):(t=r,Wr===0&&Zr($t)),t===r&&(e.substr(Fr,3)===Jt?(t=Jt,Fr+=3):(t=r,Wr===0&&Zr(Kt)),t===r&&(e.substr(Fr,2)===Qt?(t=Qt,Fr+=2):(t=r,Wr===0&&Zr(Gt)),t===r&&(e.substr(Fr,2)===Yt?(t=Yt,Fr+=2):(t=r,Wr===0&&Zr(Zt)),t===r&&(e.substr(Fr,2)===en?(t=en,Fr+=2):(t=r,Wr===0&&Zr(tn)),t===r&&(e.substr(Fr,2).toLowerCase()===nn?(t=e.substr(Fr,2),Fr+=2):(t=r,Wr===0&&Zr(rn))))))),Wr--,t===r&&(n=r,Wr===0&&Zr(Xt)),t}function Si(){var t,n;return Wr++,e.substr(Fr,4).toLowerCase()===on?(t=e.substr(Fr,4),Fr+=4):(t=r,Wr===0&&Zr(un)),t===r&&(e.substr(Fr,4).toLowerCase()===an?(t=e.substr(Fr,4),Fr+=4):(t=r,Wr===0&&Zr(fn)),t===r&&(e.substr(Fr,4).toLowerCase()===ln?(t=e.substr(Fr,4),Fr+=4):(t=r,Wr===0&&Zr(cn)),t===r&&(e.substr(Fr,3).toLowerCase()===hn?(t=e.substr(Fr,3),Fr+=3):(t=r,Wr===0&&Zr(pn))))),Wr--,t===r&&(n=r,Wr===0&&Zr(sn)),t}function xi(){var t,n;return Wr++,t=Fr,e.substr(Fr,3).toLowerCase()===vn?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(mn)),n===r&&(e.substr(Fr,4).toLowerCase()===gn?(n=e.substr(Fr,4),Fr+=4):(n=r,Wr===0&&Zr(yn)),n===r&&(e.substr(Fr,3).toLowerCase()===bn?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(wn)),n===r&&(e.substr(Fr,5).toLowerCase()===En?(n=e.substr(Fr,5),Fr+=5):(n=r,Wr===0&&Zr(Sn)),n===r&&(e.substr(Fr,3).toLowerCase()===xn?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(Tn)),n===r&&(e.substr(Fr,3).toLowerCase()===Nn?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(Cn)),n===r&&(e.substr(Fr,6).toLowerCase()===kn?(n=e.substr(Fr,6),Fr+=6):(n=r,Wr===0&&Zr(Ln)),n===r&&(e.substr(Fr,3).toLowerCase()===An?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(On)),n===r&&(e.substr(Fr,8).toLowerCase()===Mn?(n=e.substr(Fr,8),Fr+=8):(n=r,Wr===0&&Zr(_n)),n===r&&(e.substr(Fr,6).toLowerCase()===Dn?(n=e.substr(Fr,6),Fr+=6):(n=r,Wr===0&&Zr(Pn)),n===r&&(e.substr(Fr,8).toLowerCase()===Hn?(n=e.substr(Fr,8),Fr+=8):(n=r,Wr===0&&Zr(Bn)),n===r&&(e.substr(Fr,6).toLowerCase()===jn?(n=e.substr(Fr,6),Fr+=6):(n=r,Wr===0&&Zr(Fn)),n===r&&(e.substr(Fr,4).toLowerCase()===In?(n=e.substr(Fr,4),Fr+=4):(n=r,Wr===0&&Zr(qn)),n===r&&(e.substr(Fr,3).toLowerCase()===Rn?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(Un)),n===r&&(e.substr(Fr,3).toLowerCase()===zn?(n=e.substr(Fr,3),Fr+=3):(n=r,Wr===0&&Zr(Wn)))))))))))))))),n!==r&&(Ir=t,n=ht(n)),t=n,Wr--,t===r&&(n=r,Wr===0&&Zr(dn)),t}function Ti(){var e;return e=Ni(),e===r&&(e=ki()),e}function Ni(){var t,n,i,s;return t=Fr,e.charCodeAt(Fr)===34?(n=Xn,Fr++):(n=r,Wr===0&&Zr(Vn)),n!==r?(i=Ci(),i!==r?(e.charCodeAt(Fr)===34?(s=Xn,Fr++):(s=r,Wr===0&&Zr(Vn)),s!==r?(Ir=t,n=$n(i),t=n):(Fr=t,t=o)):(Fr=t,t=o)):(Fr=t,t=o),t}function Ci(){var t,n,i,s;t=[],n=Fr,i=Fr,Wr++,e.charCodeAt(Fr)===34?(s=Xn,Fr++):(s=r,Wr===0&&Zr(Vn)),Wr--,s===r?i=Jn:(Fr=i,i=o),i!==r?(e.substr(Fr,2)===Kn?(s=Kn,Fr+=2):(s=r,Wr===0&&Zr(Qn)),s===r&&(e.length>Fr?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(Gn))),s!==r?(Ir=n,i=Yn(s),n=i):(Fr=n,n=o)):(Fr=n,n=o);while(n!==r)t.push(n),n=Fr,i=Fr,Wr++,e.charCodeAt(Fr)===34?(s=Xn,Fr++):(s=r,Wr===0&&Zr(Vn)),Wr--,s===r?i=Jn:(Fr=i,i=o),i!==r?(e.substr(Fr,2)===Kn?(s=Kn,Fr+=2):(s=r,Wr===0&&Zr(Qn)),s===r&&(e.length>Fr?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(Gn))),s!==r?(Ir=n,i=Yn(s),n=i):(Fr=n,n=o)):(Fr=n,n=o);return t}function ki(){var e,t;return e=Fr,t=Li(),t!==r&&(Ir=e,t=Zn(t)),e=t,e}function Li(){var t,n,i,s;t=[],n=Fr,i=Fr,Wr++,e.charCodeAt(Fr)===44?(s=p,Fr++):(s=r,Wr===0&&Zr(d)),s===r&&(e.charCodeAt(Fr)===59?(s=m,Fr++):(s=r,Wr===0&&Zr(g)),s===r&&(e.charCodeAt(Fr)===123?(s=tt,Fr++):(s=r,Wr===0&&Zr(nt)))),Wr--,s===r?i=Jn:(Fr=i,i=o),i!==r?(e.length>Fr?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(Gn)),s!==r?(Ir=n,i=Yn(s),n=i):(Fr=n,n=o)):(Fr=n,n=o);while(n!==r)t.push(n),n=Fr,i=Fr,Wr++,e.charCodeAt(Fr)===44?(s=p,Fr++):(s=r,Wr===0&&Zr(d)),s===r&&(e.charCodeAt(Fr)===59?(s=m,Fr++):(s=r,Wr===0&&Zr(g)),s===r&&(e.charCodeAt(Fr)===123?(s=tt,Fr++):(s=r,Wr===0&&Zr(nt)))),Wr--,s===r?i=Jn:(Fr=i,i=o),i!==r?(e.length>Fr?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(Gn)),s!==r?(Ir=n,i=Yn(s),n=i):(Fr=n,n=o)):(Fr=n,n=o);return t}function Ai(){var t,n,i;Wr++,t=Fr,n=[],tr.test(e.charAt(Fr))?(i=e.charAt(Fr),Fr++):(i=r,Wr===0&&Zr(nr));if(i!==r)while(i!==r)n.push(i),tr.test(e.charAt(Fr))?(i=e.charAt(Fr),Fr++):(i=r,Wr===0&&Zr(nr));else n=o;return n!==r&&(Ir=t,n=rr(n)),t=n,t===r&&(t=Ni()),Wr--,t===r&&(n=r,Wr===0&&Zr(er)),t}function Oi(){var t,n;return Wr++,sr.test(e.charAt(Fr))?(t=e.charAt(Fr),Fr++):(t=r,Wr===0&&Zr(or)),Wr--,t===r&&(n=r,Wr===0&&Zr(ir)),t}function Mi(){var t,n;return Wr++,ar.test(e.charAt(Fr))?(t=e.charAt(Fr),Fr++):(t=r,Wr===0&&Zr(fr)),Wr--,t===r&&(n=r,Wr===0&&Zr(ur)),t}function _i(){var t,n,i,s,u,a;Wr++,t=Fr,e.substr(Fr,2)===cr?(n=cr,Fr+=2):(n=r,Wr===0&&Zr(hr)),n===r&&(e.charCodeAt(Fr)===35?(n=pr,Fr++):(n=r,Wr===0&&Zr(dr)));if(n!==r){i=[],vr.test(e.charAt(Fr))?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(mr));while(s!==r)i.push(s),vr.test(e.charAt(Fr))?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(mr));i!==r?(n=[n,i],t=n):(Fr=t,t=o)}else Fr=t,t=o;if(t===r){t=Fr,e.substr(Fr,2)===gr?(n=gr,Fr+=2):(n=r,Wr===0&&Zr(yr));if(n!==r){i=[],s=Fr,u=Fr,Wr++,e.substr(Fr,2)===br?(a=br,Fr+=2):(a=r,Wr===0&&Zr(wr)),Wr--,a===r?u=Jn:(Fr=u,u=o),u!==r?(e.length>Fr?(a=e.charAt(Fr),Fr++):(a=r,Wr===0&&Zr(Gn)),a!==r?(u=[u,a],s=u):(Fr=s,s=o)):(Fr=s,s=o);while(s!==r)i.push(s),s=Fr,u=Fr,Wr++,e.substr(Fr,2)===br?(a=br,Fr+=2):(a=r,Wr===0&&Zr(wr)),Wr--,a===r?u=Jn:(Fr=u,u=o),u!==r?(e.length>Fr?(a=e.charAt(Fr),Fr++):(a=r,Wr===0&&Zr(Gn)),a!==r?(u=[u,a],s=u):(Fr=s,s=o)):(Fr=s,s=o);i!==r?(e.substr(Fr,2)===br?(s=br,Fr+=2):(s=r,Wr===0&&Zr(wr)),s!==r?(n=[n,i,s],t=n):(Fr=t,t=o)):(Fr=t,t=o)}else Fr=t,t=o}return Wr--,t===r&&(n=r,Wr===0&&Zr(lr)),t}function Di(){var e,t,n;e=[],t=[],n=Oi();if(n!==r)while(n!==r)t.push(n),n=Oi();else t=o;if(t===r){t=[],n=Mi();if(n!==r)while(n!==r)t.push(n),n=Mi();else t=o;if(t===r){t=[],n=_i();if(n!==r)while(n!==r)t.push(n),n=_i();else t=o}}while(t!==r){e.push(t),t=[],n=Oi();if(n!==r)while(n!==r)t.push(n),n=Oi();else t=o;if(t===r){t=[],n=Mi();if(n!==r)while(n!==r)t.push(n),n=Mi();else t=o;if(t===r){t=[],n=_i();if(n!==r)while(n!==r)t.push(n),n=_i();else t=o}}}return e}function Pi(){var e;return e=Bi(),e===r&&(e=Hi()),e}function Hi(){var t,n,i;Wr++,t=Fr,n=[],Sr.test(e.charAt(Fr))?(i=e.charAt(Fr),Fr++):(i=r,Wr===0&&Zr(xr));if(i!==r)while(i!==r)n.push(i),Sr.test(e.charAt(Fr))?(i=e.charAt(Fr),Fr++):(i=r,Wr===0&&Zr(xr));else n=o;return n!==r&&(Ir=t,n=Tr(n)),t=n,Wr--,t===r&&(n=r,Wr===0&&Zr(Er)),t}function Bi(){var t,n,i,s,u,a;Wr++,t=Fr,n=Fr,i=[],Sr.test(e.charAt(Fr))?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(xr));if(s!==r)while(s!==r)i.push(s),Sr.test(e.charAt(Fr))?(s=e.charAt(Fr),Fr++):(s=r,Wr===0&&Zr(xr));else i=o;if(i!==r){e.charCodeAt(Fr)===46?(s=Cr,Fr++):(s=r,Wr===0&&Zr(kr));if(s!==r){u=[],Sr.test(e.charAt(Fr))?(a=e.charAt(Fr),Fr++):(a=r,Wr===0&&Zr(xr));if(a!==r)while(a!==r)u.push(a),Sr.test(e.charAt(Fr))?(a=e.charAt(Fr),Fr++):(a=r,Wr===0&&Zr(xr));else u=o;u!==r?(i=[i,s,u],n=i):(Fr=n,n=o)}else Fr=n,n=o}else Fr=n,n=o;return n!==r&&(Ir=t,n=Lr(n)),t=n,Wr--,t===r&&(n=r,Wr===0&&Zr(Nr)),t}function ji(){var t,n;return Wr++,e.substr(Fr,4).toLowerCase()===Or?(t=e.substr(Fr,4),Fr+=4):(t=r,Wr===0&&Zr(Mr)),t===r&&(e.substr(Fr,5).toLowerCase()===_r?(t=e.substr(Fr,5),Fr+=5):(t=r,Wr===0&&Zr(Dr)),t===r&&(e.substr(Fr,2).toLowerCase()===Pr?(t=e.substr(Fr,2),Fr+=2):(t=r,Wr===0&&Zr(Hr)),t===r&&(e.substr(Fr,3).toLowerCase()===Br?(t=e.substr(Fr,3),Fr+=3):(t=r,Wr===0&&Zr(jr))))),Wr--,t===r&&(n=r,Wr===0&&Zr(Ar)),t}function Fi(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function Ii(e){var t="false";switch(e.toLowerCase()){case"true":case"on":case"1":t="true"}return t}function qi(e,t,n){var r=0;if(t===undefined||t==="*")return!0;if(e&&e.entities&&t)for(r=0;r<e.entities.length;r++)if(e.entities[r].name===t)return!0;return n?n[t]===!0:!1}function Ri(e){var t={};return t.name=e,t}function Ui(e,t,n){var r=0,i=0,s={};e?s=e:s.entities=[],n||(n={});if(t&&t.arcs)for(r=0;r<t.arcs.length;r++)for(i=0;i<t.arcs[r].length;i++)qi(s,t.arcs[r][i].from,n)||(s.entities[s.entities.length]=Ri(t.arcs[r][i].from)),t.arcs[r][i].arcs&&(n[t.arcs[r][i].to]=!0,Fi(s,Ui(s,t.arcs[r][i],n)),delete n[t.arcs[r][i].to]),qi(s,t.arcs[r][i].to,n)||(s.entities[s.entities.length]=Ri(t.arcs[r][i].to));return s}var n=arguments.length>1?arguments[1]:{},r={},i={program:ti},s=ti,o=r,u=function(e){return e[1]=Ui(e[1],e[2]),Fi(e[0],Fi(e[1],e[2]))},a=null,f=function(e){return{options:e}},l=function(e){return{entities:e}},c=function(e){return{arcs:e}},h=[],p=",",d={type:"literal",value:",",description:'","'},v=function(e){return e},m=";",g={type:"literal",value:";",description:'";"'},y=function(e){var t={},n,r;for(n in e[0])for(r in e[0][n])t[r]=e[0][n][r];return t=Fi(t,e[1]),t},b="=",w={type:"literal",value:"=",description:'"="'},E=function(e){return e},S=function(e){return e.toString()},x=function(e){return e.toString()},T=function(e,t){var n={};return e=e.toLowerCase(),e==="wordwraparcs"?n[e]=Ii(t):n[e]=t,n},N="hscale",C={type:"literal",value:"hscale",description:'"hscale"'},k="width",L={type:"literal",value:"width",description:'"width"'},A="arcgradient",O={type:"literal",value:"arcgradient",description:'"arcgradient"'},M="wordwraparcs",_={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},D="watermark",P={type:"literal",value:"watermark",description:'"watermark"'},H=function(e){return e},B=function(e){return e[0].push(e[1]),e[0]},j={type:"other",description:"entity"},F=":",I={type:"literal",value:":",description:'":"'},q=function(e){return e},R=function(e,t){var n={};return n.name=e,t&&(n.label=t),n},U=function(e){return e},z=function(e){return[e]},W=function(e){return e[0].push(e[1][0]),e[0]},X=function(e){return e},V=function(e){return e},$=function(e){return e},J=function(e,t){return t&&(e.label=t),e},K=function(e){return{kind:e}},Q=function(e,t,n){return{kind:t,from:e,to:n}},G="*",Y={type:"literal",value:"*",description:'"*"'},Z=function(e,t){return{kind:e,from:"*",to:t}},et=function(e,t){return{kind:t,from:e,to:"*"}},tt="{",nt={type:"literal",value:"{",description:'"{"'},rt="}",it={type:"literal",value:"}",description:'"}"'},st=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return r&&(s.label=r),s},ot="|||",ut={type:"literal",value:"|||",description:'"|||"'},at="...",ft={type:"literal",value:"...",description:'"..."'},lt="---",ct={type:"literal",value:"---",description:'"---"'},ht=function(e){return e.toLowerCase()},pt={type:"other",description:"bi-directional arrow"},dt="--",vt={type:"literal",value:"--",description:'"--"'},mt="<->",gt={type:"literal",value:"<->",description:'"<->"'},yt="==",bt={type:"literal",value:"==",description:'"=="'},wt="<<=>>",Et={type:"literal",value:"<<=>>",description:'"<<=>>"'},St="<=>",xt={type:"literal",value:"<=>",description:'"<=>"'},Tt="..",Nt={type:"literal",value:"..",description:'".."'},Ct="<<>>",kt={type:"literal",value:"<<>>",description:'"<<>>"'},Lt="::",At={type:"literal",value:"::",description:'"::"'},Ot="<:>",Mt={type:"literal",value:"<:>",description:'"<:>"'},_t={type:"other",description:"left to right arrow"},Dt="->",Pt={type:"literal",value:"->",description:'"->"'},Ht="=>>",Bt={type:"literal",value:"=>>",description:'"=>>"'},jt="=>",Ft={type:"literal",value:"=>",description:'"=>"'},It=">>",qt={type:"literal",value:">>",description:'">>"'},Rt=":>",Ut={type:"literal",value:":>",description:'":>"'},zt="-x",Wt={type:"literal",value:"-x",description:'"-x"'},Xt={type:"other",description:"right to left arrow"},Vt="<-",$t={type:"literal",value:"<-",description:'"<-"'},Jt="<<=",Kt={type:"literal",value:"<<=",description:'"<<="'},Qt="<=",Gt={type:"literal",value:"<=",description:'"<="'},Yt="<<",Zt={type:"literal",value:"<<",description:'"<<"'},en="<:",tn={type:"literal",value:"<:",description:'"<:"'},nn="x-",rn={type:"literal",value:"x-",description:'"x-"'},sn={type:"other",description:"box"},on="note",un={type:"literal",value:"note",description:'"note"'},an="abox",fn={type:"literal",value:"abox",description:'"abox"'},ln="rbox",cn={type:"literal",value:"rbox",description:'"rbox"'},hn="box",pn={type:"literal",value:"box",description:'"box"'},dn={type:"other",description:"arc spanning box"},vn="alt",mn={type:"literal",value:"alt",description:'"alt"'},gn="else",yn={type:"literal",value:"else",description:'"else"'},bn="opt",wn={type:"literal",value:"opt",description:'"opt"'},En="break",Sn={type:"literal",value:"break",description:'"break"'},xn="par",Tn={type:"literal",value:"par",description:'"par"'},Nn="seq",Cn={type:"literal",value:"seq",description:'"seq"'},kn="strict",Ln={type:"literal",value:"strict",description:'"strict"'},An="neg",On={type:"literal",value:"neg",description:'"neg"'},Mn="critical",_n={type:"literal",value:"critical",description:'"critical"'},Dn="ignore",Pn={type:"literal",value:"ignore",description:'"ignore"'},Hn="consider",Bn={type:"literal",value:"consider",description:'"consider"'},jn="assert",Fn={type:"literal",value:"assert",description:'"assert"'},In="loop",qn={type:"literal",value:"loop",description:'"loop"'},Rn="ref",Un={type:"literal",value:"ref",description:'"ref"'},zn="exc",Wn={type:"literal",value:"exc",description:'"exc"'},Xn='"',Vn={type:"literal",value:'"',description:'"\\""'},$n=function(e){return e.join("")},Jn=void 0,Kn='\\"',Qn={type:"literal",value:'\\"',description:'"\\\\\\""'},Gn={type:"any",description:"any character"},Yn=function(e){return e},Zn=function(e){return e.join("").trim()},er={type:"other",description:"identifier"},tr=/^[A-Za-z_0-9]/,nr={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},rr=function(e){return e.join("")},ir={type:"other",description:"whitespace"},sr=/^[ \t]/,or={type:"class",value:"[ \\t]",description:"[ \\t]"},ur={type:"other",description:"lineend"},ar=/^[\r\n]/,fr={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},lr={type:"other",description:"comment"},cr="//",hr={type:"literal",value:"//",description:'"//"'},pr="#",dr={type:"literal",value:"#",description:'"#"'},vr=/^[^\r\n]/,mr={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},gr="/*",yr={type:"literal",value:"/*",description:'"/*"'},br="*/",wr={type:"literal",value:"*/",description:'"*/"'},Er={type:"other",description:"integer"},Sr=/^[0-9]/,xr={type:"class",value:"[0-9]",description:"[0-9]"},Tr=function(e){return parseInt(e.join(""),10)},Nr={type:"other",description:"real"},Cr=".",kr={type:"literal",value:".",description:'"."'},Lr=function(e){return parseFloat(e.join(""))},Ar={type:"other",description:"boolean"},Or="true",Mr={type:"literal",value:"true",description:'"true"'},_r="false",Dr={type:"literal",value:"false",description:'"false"'},Pr="on",Hr={type:"literal",value:"on",description:'"on"'},Br="off",jr={type:"literal",value:"off",description:'"off"'},Fr=0,Ir=0,qr=0,Rr={line:1,column:1,seenCR:!1},Ur=0,zr=[],Wr=0,Xr;if("startRule"in n){if(!(n.startRule in i))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=i[n.startRule]}Xr=s();if(Xr!==r&&Fr===e.length)return Xr;throw Xr!==r&&Fr<e.length&&Zr({type:"end",description:"end of input"}),ei(null,zr,Ur)}return e(t,Error),{SyntaxError:t,parse:n}}),define("renderutensils",[],function(){function i(e){var t={height:15,width:15,x:2,y:2};if(typeof e.getBBox=="function"){var n=document.getElementsByTagName("svg")[0];n.appendChild(e),t=e.getBBox(),n.removeChild(e)}return t}function s(t,r){var i=n.createElementNS(e,"path");return i.setAttribute("d",t),r&&i.setAttribute("class",r),i}function o(t,r){var i=n.createElementNS(e,"polygon");return i.setAttribute("points",t),r&&i.setAttribute("class",r),i}function u(t,r,i,s,o,u,a){var f=n.createElementNS(e,"rect");return f.setAttribute("width",t),f.setAttribute("height",r),s&&f.setAttribute("x",s),o&&f.setAttribute("y",o),u&&f.setAttribute("rx",u),a&&f.setAttribute("ry",a),i&&f.setAttribute("class",i),f}function a(e,t,n,r,i){var o=3,u="M"+r+","+i;return u+="l"+o+", -"+t/2,u+="l"+(e-2*o)+",0",u+="l"+o+","+t/2,u+="l-"+o+","+t/2,u+="l-"+(e-2*o)+",0 ",u+="l-"+o+",-"+t/2,s(u,n)}function f(e,t,n,r,i,o){var u=o?o:9,a=u.toString(10),f="M"+r+","+i;return f+="l"+(e-u)+",0 ",f+="l0,"+a+" l"+a+",0 m-"+a+",-"+a+" l"+a+","+a+" ",f+="l0,"+(t-u)+" ",f+="l-"+e+",0 ",f+="l0,-"+t+" ",s(f,n)}function l(e,t,n,r,i,o){var u=o?o:7,a="M"+r+","+i;return a+=" l"+e+",0 ",a+=" l0,"+(t-u),a+=" l-"+u.toString(10)+","+u.toString(10),a+=" l-"+(e-u)+",0 ",a+="H",s(a,n)}function c(i,s,o,u,a,f,l){var c=n.createElementNS(e,"text"),h=n.createElementNS(e,"tspan"),p=n.createElementNS(e,"tspan"),d=n.createTextNode(i);c.setAttribute("x",s.toString()),c.setAttribute("y",o.toString()),u&&c.setAttribute("class",u),h.appendChild(d);if(a){var v=n.createElementNS(e,"a");v.setAttributeNS(t,"xlink:href",a),v.setAttributeNS(t,"xlink:title",a),v.setAttributeNS(t,"xlink:show","new"),v.appendChild(h),c.appendChild(v)}else c.appendChild(h);if(f){p.appendChild(n.createTextNode(" ["+f+"]")),p.setAttribute("style",r);if(l){var m=n.createElementNS(e,"a");m.setAttributeNS(t,"xlink:href",l),m.setAttributeNS(t,"xlink:title",l),m.setAttributeNS(t,"xlink:show","new"),m.appendChild(p),c.appendChild(m)}else c.appendChild(p)}return c}function h(t,r,i,s,o){var u=n.createElementNS(e,"line");return u.setAttribute("x1",t.toString()),u.setAttribute("y1",r.toString()),u.setAttribute("x2",i.toString()),u.setAttribute("y2",s.toString()),o&&u.setAttribute("class",o),u}function p(e,t,n,r,i){var o=2,u="M"+e.toString()+","+t.toString(),a=n>e?a=1:a=-1,f=a*(r-t)/(n-e),l=n-e,c=r-t;return u+="l"+a.toString()+","+f.toString(),u+="M"+e.toString()+","+(t-o).toString(),u+=" l"+l.toString()+","+c.toString(),u+="M"+e.toString()+","+(t+o).toString(),u+=" l"+l.toString()+","+c.toString(),u+="M"+(n-a).toString()+","+r.toString(),u+="l"+a.toString()+","+f.toString(),s(u,i)}function d(e,t,n,r,i,s){return s?p(e,t,n,r,i):h(e,t,n,r,i)}function v(e){var t={"->":{pathEnd:"M 9 3 l -8 2",linestyle:"stroke: inherit",headclass:"arrow-style inherit"},"<->":{pathEnd:"M 9 3 l -8 2",pathStart:"M 9 3 l 8 2",linestyle:"stroke: inherit",headclass:"arrow-style inherit"},"=>":{pathEnd:"M 1,1 9,3 1,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"<=>":{pathEnd:"M 1,1 9,3 1,5 z",pathStart:"M 17,1 9,3 17,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"=>>":{pathEnd:"M 1 1 l 8 2 l -8 2",linestyle:"stroke: inherit",headclass:"arrow-style inherit"},"<<=>>":{pathEnd:"M 1 1 l 8 2 l -8 2",pathStart:"M 17 1 l -8 2 l 8 2",linestyle:"stroke: inherit;",headclass:"arrow-style inherit"},">>":{pathEnd:"M 1 1 l 8 2 l -8 2",linestyle:"stroke-dasharray: 5,2; stroke: inherit;",headclass:"arrow-style inherit"},"<<>>":{pathEnd:"M 1 1 l 8 2 l -8 2",pathStart:"M 17 1 l -8 2 l 8 2",linestyle:"stroke-dasharray: 5,2; stroke: inherit;",headclass:"arrow-style inherit"},"..":{linestyle:"stroke-dasharray: 5,2; stroke: inherit;",headclass:"arrow-style inherit"},":>":{pathEnd:"M 1,1 9,3 1,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"<:>":{pathEnd:"M 1,1 9,3 1,5 z",pathStart:"M 17,1 9,3 17,5 z",linestyle:"stroke: inherit",headclass:"filled arrow-style inherit inherit-fill"},"-x":{pathEnd:"M6.5,-0.5 L11.5,5.5 M6.5,5.5 L11.5,-0.5",linestyle:"stroke: inherit",headclass:"arrow-style inherit"}},n=t[e];return n===undefined?{linestyle:"stroke: inherit;",headclass:"arrow-style inherit"}:n}function m(e,t,n,r,i,s){var o=d(t,n,r,i,undefined,s.indexOf(":")>-1),u=v(s),a=y(e);return u.pathEnd&&(u.headclass?a.appendChild(E(e+"_end","arrow-marker","auto",u.pathEnd,u.headclass)):a.appendChild(E(e+"_end","arrow-marker","auto",u.pathEnd,"arrow-style")),o.setAttribute("marker-end","url(#"+e+"_end"+")")),u.pathStart&&(u.headclass?a.appendChild(E(e+"_start","arrow-marker","auto",u.pathStart,u.headclass)):a.appendChild(E(e+"_start","arrow-marker","auto",u.pathStart,"arrow-style")),o.setAttribute("marker-start","url(#"+e+"_start"+")")),u.linestyle&&o.setAttribute("style",u.linestyle),a.appendChild(o),a}function g(e,t,n,r,i){var o="M"+e.toString()+", -"+t.toString();return o+=" l"+r.toString()+",0",o+=" l0,"+n.toString(),o+=" l-"+r.toString()+",0",s(o,i)}function y(t){var r=n.createElementNS(e,"g");return r.setAttribute("id",t),r}function b(r,i,s){var o=n.createElementNS(e,"use");return o.setAttribute("x",r.toString()),o.setAttribute("y",i.toString()),o.setAttributeNS(t,"xlink:href","#"+s),o}function w(t,r,i){var s=n.createElementNS(e,"marker");return s.setAttribute("orient",i),s.setAttribute("id",t),s.setAttribute("class",r),s.setAttribute("viewBox","0 0 10 10"),s.setAttribute("refX","9"),s.setAttribute("refY","3"),s.setAttribute("markerUnits","strokeWidth"),s.setAttribute("markerWidth","10"),s.setAttribute("markerHeight","10"),s.setAttribute("refX","9"),s.setAttribute("refX","9"),s}function E(e,t,n,r,i){var o=w(e,t,n),u=s(r,i);return o.appendChild(u),o}function S(e,t,n,r,i){var s=w(e,t,n),u=o(r,i);return s.appendChild(u),s}var e="http://www.w3.org/2000/svg",t="http://www.w3.org/1999/xlink",n,r="vertical-align : text-top;";return r+="font-size: 0.7em; text-anchor: start;",{init:function(e){n=e},createPath:function(e,t){return s(e,t)},createRect:function(e,t,n,r,i,s,o){return u(e,t,n,r,i,s,o)},createABox:function(e,t,n,r,i){return a(e,t,n,r,i)},createNote:function(e,t,n,r,i,s){return f(e,t,n,r,i,s)},createEdgeRemark:function(e,t,n,r,i,s){return l(e,t,n,r,i,s)},createText:function(e,t,n,r,i,s,o){return c(e,t,n,r,i,s,o)},createLine:function(e,t,n,r,i,s){return d(e,t,n,r,i,s)},createArrow:function(e,t,n,r,i,s){return m(e,t,n,r,i,s)},createUTurn:function(e,t,n,r,i){return g(e,t,n,r,i)},createGroup:function(e){return y(e)},createUse:function(e,t,n){return b(e,t,n)},createMarkerPath:function(e,t,n,r,i){return E(e,t,n,r,i)},createMarkerPolygon:function(e,t,n,r,i){return S(e,t,n,r,i)},getBBox:function(e){return i(e)},SVGNS:e,XLINKNS:t}}),define("renderskeleton",["./renderutensils"],function(e){function r(t){var n=t;return n.appendChild(e.createMarkerPath("signal","arrow-marker","auto","M 9 3 l -8 2","arrow-style")),n.appendChild(e.createMarkerPath("signal-u","arrow-marker","auto","M 9 3 l -8 -2","arrow-style")),n.appendChild(e.createMarkerPath("signal-l","arrow-marker","auto","M 9 3 l 8 2","arrow-style")),n.appendChild(e.createMarkerPath("signal-lu","arrow-marker","auto","M 9 3 l 8 -2","arrow-style")),n.appendChild(e.createMarkerPolygon("method","arrow-marker","auto","1,1 9,3 1,5","filled arrow-style")),n.appendChild(e.createMarkerPolygon("method-l","arrow-marker","auto","17,1 9,3 17,5","filled arrow-style")),n.appendChild(e.createMarkerPath("callback","arrow-marker","auto","M 1 1 l 8 2 l -8 2","arrow-style")),n.appendChild(e.createMarkerPath("callback-l","arrow-marker","auto","M 17 1 l -8 2 l 8 2","arrow-style")),n.appendChild(e.createMarkerPath("lost","arrow-marker","auto","M6.5,-0.5 L11.5,5.5 M6.5,5.5 L11.5,-0.5","arrow-style")),n}function i(){var e=t.createElement("style");return e.setAttribute("type","text/css"),e.appendChild(t.createTextNode(c)),e}function s(n){var r=t.createElementNS(e.SVGNS,"svg");return r.setAttribute("version","1.1"),r.setAttribute("id",n),r.setAttribute("xmlns",e.SVGNS),r.setAttribute("xmlns:xlink",e.XLINKNS),r}function o(){var s=t.createElementNS(e.SVGNS,"defs");return s.appendChild(i(t)),s=r(s),s.appendChild(e.createGroup(n+"__defs")),s}function u(){var r=t.createElementNS(e.SVGNS,"desc");return r.setAttribute("id",n+"__msc_source"),r}function a(){var t=e.createGroup(n+"__body");return t.appendChild(e.createGroup(n+"__background")),t.appendChild(e.createGroup(n+"__arcspanlayer")),t.appendChild(e.createGroup(n+"__lifelinelayer")),t.appendChild(e.createGroup(n+"__sequencelayer")),t.appendChild(e.createGroup(n+"__notelayer")),t.appendChild(e.createGroup(n+"__watermark")),t}function f(t){var n;return"object"!=typeof document?n=t.document:n=window.document,e.init(n),n}function l(e,r,i){t=f(i),n=r;var l=t.getElementById(e);l===null&&(l=t.body);var c=s(r);c.appendChild(u()),c.appendChild(o()),c.appendChild(a()),l.appendChild(c)}var t,n="mscgen_js$svg$",c="svg {     font-family: Helvetica, sans-serif;     font-size: 9pt;     background-color: white;     stroke : black;     color  : black; } rect {     fill: none;     stroke: black;     stroke-width: 2; } .bglayer {     fill:white;     stroke: white;     stroke-width: 0; } rect.textbg {     fill:white;     stroke:white;     stroke-width:0;     opacity: 0.9; } line {     stroke: black;     stroke-width: 2; } .arcrowomit {     stroke-dasharray: 2,2; } text {     color: inherit;     stroke: none;     text-anchor: middle; } text.entity {     text-decoration : underline; } text.anchor-start {     text-anchor: start; }path {     stroke: black;     color: black;     stroke-width: 2;     fill: none; } .dotted {    stroke-dasharray: 5,2; } .striped {     stroke-dasharray: 10,5; } .arrow-marker {     overflow:visible; } .arrow-style {     stroke : black;     stroke-dasharray : 100,1; /* 'none' should work, but doesn't in webkit */     stroke-width : 1; } .filled {     stroke:inherit;     fill:black; /* no-inherit */ } .arcrowomit {     stroke-dasharray: 2,2; } .box {     /* fill: #ffc;  no-inherit */     fill : white;     opacity: 0.9; } .boxtext, .arctext {     font-size: 0.8em;     text-anchor: middle; } .comment {     stroke-dasharray: 5,2; } .signal {     marker-end : url(#signal); } .signal-u {     marker-end : url(#signal-u); } .signal-both {     marker-end : url(#signal);     marker-start : url(#signal-l); } .signal-both-u {     marker-end : url(#signal-u);     marker-start : url(#signal-lu); } .signal-both-self {     marker-end : url(#signal-u);     marker-start : url(#signal-l); } .method {     marker-end : url(#method); } .method-both {     marker-end : url(#method);     marker-start : url(#method-l); } .returnvalue {     stroke-dasharray: 5,2;     marker-end : url(#callback); } .returnvalue-both {     stroke-dasharray: 5,2;     marker-end : url(#callback);     marker-start : url(#callback-l); } .callback {     marker-end : url(#callback); } .callback-both {     marker-end : url(#callback);     marker-start : url(#callback-l); } .emphasised {     marker-end : url(#method); } .emphasised-both {     marker-end : url(#method);     marker-start : url(#method-l); } .lost {     marker-end : url(#lost); } .inherit {     stroke : inherit;     color : inherit; } .inherit-fill {     fill : inherit; } .watermark {     stroke: black;     color : black;     fill  : black;     font-size: 48pt;     font-weight: bold;     opacity : 0.14; }";return{bootstrap:function(e,t,n){return l(e,t,n)},init:function(e){return f(e)}}}),define("node/textutensils",[],function(){function e(e,t){var n=0,r=[],i=0,s=0,o=0,u=0,a=e.replace(/[\t\n]+/g," ").replace(/\\n/g,"\n");while(u<=a.length)u>=a.length?r.push(a.substring(i,u)):a[u]==="\n"?(n=0,o=u,r.push(a.substring(i,o)),i=o+1):n++>=t&&(o=a.substring(0,u).lastIndexOf(" "),o===-1||o<i?(n=1,o=u,s=u):(n=0,s=o+1),r.push(a.substring(i,o)),i=s),u++;return r}function t(e){var t=Math.abs(e),n=t/8;return t>160&&t<=320?n=t/6.4:t>320&&t<=480?n=t/5.9:t>480&&(n=t/5.6),n}function n(e){var t=e.replace(/\\\"/g,'"');return t}function r(e){var t={msgenny:"msgenny",mscgen:"mscgen",msc:"mscgen",mscin:"mscgen",json:"json",ast:"json"},n=e.lastIndexOf(".");if(n>-1){var r=e.slice(n+1);if(t[r])return t[r]}return"mscgen"}return{wrap:function(t,n){return e(t,n)},determineMaxTextWidth:function(e){return t(e)},unescapeString:function(e){return n(e)},classifyExtension:function(e){return r(e)}}}),define("node/asttransform",[],function(){function e(e,t){var n,r,i=e;if(i&&t)for(n=0;n<i.length;n++)for(r=0;r<t.length;r++)i[n]=t[r](i[n]);return i}function t(e,n,r,i){var s,o,u,a,f=n;if(e&&f&&(r||i))for(s=0;s<f.length;s++){if(r)for(u=0;u<r.length;u++)f[s]=r[u](f[s],e);for(o=0;o<f[s].length;o++){if(i)for(a=0;a<i.length;a++)f[s][o]=i[a](f[s][o],e,f[s]);f[s][o].arcs&&t(e,f[s][o].arcs,r,i)}}return f}function n(n,r,i,s){var o=n;return o.entities=e(o.entities,r),o.arcs=t(n.entities,n.arcs,s,i),o}return{transform:function(e,t,r,i){return n(e,t,r,i)}}}),define("node/dotmap",[],function(){function i(e,t,n){var r={"->":"signal","<->":"signal-both","=>":"method","<=>":"method-both",">>":"returnvalue","<<>>":"returnvalue-both","..":"dotted","=>>":"callback","<<=>>":"callback-both",":>":"emphasised","<:>":"emphasised-both","::":"double","-x":"lost"},i="";return e&&r[e]&&(i=r[e],t&&n&&t>=n&&(i==="signal"&&(i="signal-u"),i==="signal-both"&&(t===n?i="signal-both-self":i="signal-both-u"))),i}var e={"->":"rvee","<->":"rvee","=>":"normal","<=>":"normal","-x":"oinvonormal"},t={box:"box",abox:"hexagon",rbox:"box",note:"note"},n={">>":"dashed","<<>>":"dashed","..":"dashed",":>":"bold","<:>":"bold","::":"bold",rbox:"rounded"},r={"|||":"emptyarc","...":"emptyarc","---":"emptyarc","->":"directional","=>":"directional","=>>":"directional",">>":"directional",":>":"directional","-x":"directional",note:"box",box:"box",abox:"box",rbox:"box","<->":"bidirectional","<=>":"bidirectional","<<=>>":"bidirectional","<<>>":"bidirectional","<:>":"bidirectional","--":"nondirectional","==":"nondirectional","..":"nondirectional","::":"nondirectional",alt:"inline_expression","else":"inline_expression",opt:"inline_expression","break":"inline_expression",par:"inline_expression",seq:"inline_expression",strict:"inline_expression",neg:"inline_expression",critical:"inline_expression",ignore:"inline_expression",consider:"inline_expression",assert:"inline_expression",loop:"inline_expression",ref:"inline_expression",exc:"inline_expression"};return{getArrow:function(t){return e[t]},getShape:function(e){return t[e]},getStyle:function(e){return n[e]},getAggregate:function(e){return r[e]},determineArcClass:function(e,t,n){return i(e,t,n)}}}),define("node/flatten",["./asttransform","./dotmap"],function(e,t){function r(e){var t=e;return t.label===undefined&&(t.label=t.name),t}function i(e){var t={"<-":"->","<=":"=>","<<=":"=>>","<<":">>","<:":":>","x-":"-x"},n=e;if(n.kind&&t[n.kind]){n.kind=t[n.kind];var r=n.from;n.from=n.to,n.to=r}return n}function s(e,t){var n=e;return!n.linecolor&&t.arclinecolor&&(n.linecolor=t.arclinecolor),!n.textcolor&&t.arctextcolor&&(n.textcolor=t.arctextcolor),!n.textbgcolor&&t.arctextbgcolor&&(n.textbgcolor=t.arctextbgcolor),n}function o(e,t){function n(e,t){var n;for(n=0;n<e.length;n++)if(e[n].name===t)return n;return-1}var r=e;if(r&&r.from){var i=n(t,r.from);i>-1&&(r=s(e,t[i]))}return r}function u(e){var t=e.arcs.length;for(var n=0;n<e.arcs.length;n++)e.arcs[n][0].arcs&&(t+=u(e.arcs[n][0])+1);return t}function a(e,r,i,o,f){var l={};if("inline_expression"===t.getAggregate(e[0].kind)){l=JSON.parse(JSON.stringify(e[0]));if(l)if(l.arcs){l.numberofrows=u(l),delete l.arcs,r.arcs.push([l]);for(var c=0;c<e[0].arcs.length;c++){a(e[0].arcs[c],r,l.from,l.to,f+1);for(var h=0;h<e[0].arcs[c].length;h++)s(e[0].arcs[c][h],l)}l.depth=f,f>n&&(n=f),r.arcs.push([{kind:"|||",from:l.from,to:l.to}])}else r.arcs.push([l])}else{if(i&&o)for(var p=0;p<e.length;p++)"emptyarc"===t.getAggregate(e[p].kind)&&(e[p].from=i,e[p].to=o,e[p].depth=f);r.arcs.push(e)}}function f(e){var t,r={};n=0,r.options=e.options?JSON.parse(JSON.stringify(e.options)):undefined,r.entities=e.entities?JSON.parse(JSON.stringify(e.entities)):undefined,r.arcs=[];if(e&&e.arcs)for(t=0;t<e.arcs.length;t++)a(e.arcs[t],r,undefined,undefined,0);return r.depth=n+1,r}function l(e){if(e.entities&&e.arcs){var t,n;for(t=0;t<e.arcs.length;t++)for(n=0;n<e.arcs[t].length;n++)if(e.arcs[t][n].to==="*"){var r=JSON.parse(JSON.stringify(e.arcs[t][n]));delete e.arcs[t][n];var i=!0,s=0;for(s=0;s<e.entities.length;s++)r.from!==e.entities[s].name&&(r.to=e.entities[s].name,i?(i=!1,e.arcs[t][n]=JSON.parse(JSON.stringify(r))):e.arcs[t].push(JSON.parse(JSON.stringify(r))))}}return e}var n=0;return{swapRTLArc:function(e){return i(e)},unwind:function(e){return f(e)},explodeBroadcasts:function(e){return l(e)},flatten:function(t){return e.transform(f(t),[r],[i,o])},dotFlatten:function(t){return l(e.transform(t,[r],[i,o]))}}}),define("renderast",["./renderutensils","./renderskeleton","./node/textutensils","./node/flatten","./node/dotmap"],function(e,t,n,r,i){function k(){C=[]}function L(e){return C[e]?C[e]:{y:c+1.5*v+e*v,height:v}}function A(e,t,n){if(t===undefined||t<v)t=v;if(n===undefined){var r=L(e-1);r&&r.y>0?n=r.y+(r.height+t)/2:n=c+1.5*v+e*v}C[e]={y:n,height:t}}function O(e,n){N=t.init(n);var r=N.getElementById(d+e);if(r&&r!==null&&r!==undefined){var i=N.getElementById(e);i.removeChild(r)}}function M(e){u=o,c=l,f=a,v=h,g=m,y=!1,e&&(e.hscale&&(u=e.hscale*o,f=e.hscale*a),e.arcgradient&&(v=parseInt(e.arcgradient,10)+h,g=parseInt(e.arcgradient,10)+m),e.wordwraparcs&&e.wordwraparcs==="true"&&(y=!0))}function _(e){return T+e}function D(n,i,o,a){n=r.flatten(n),T=d+o,t.bootstrap(o,T,a),x=e.getBBox(e.createText("jy9@",0,0)).height,M(n.options);var l=0;b=0,n.depth&&(l=2*(n.depth+1)*2*p,b=n.depth),H(n.entities),B(n.arcs,n.entities);var c=n.entities.length*u+l,h=n.arcs?n.arcs.length:0,v=L(h-1),m=v.y+v.height/2+2*s,g=(u+l-f)/2,y=s,w=1;if(i){var E=N.getElementById(_("__msc_source")),S=N.createTextNode("\n\n# Generated by mscgen_js - http://sverweij.github.io/mscgen_js\n"+i);E.appendChild(S)}var C=N.getElementById(_("__background")),k=e.createRect(c,m,"bglayer",0-g,0-y);C.appendChild(k);if(n.options&&n.options.watermark){var A=N.getElementById(_("__watermark")),O=e.createText(n.options.watermark,c/2,m/2,"watermark"),D=0-Math.atan(m/c)*360/(2*Math.PI);O.setAttribute("transform","rotate("+D.toString()+" "+(c/2).toString()+" "+(m/2).toString()+")"),A.appendChild(O)}n.options&&n.options.width&&(w=n.options.width/c,c*=w,m*=w,g*=w,y*=w);var P=N.getElementById(T),j=N.getElementById(_("__body"));j.setAttribute("transform","translate("+g+","+y+")"+" scale("+w+","+w+")"),P.setAttribute("width",c.toString()),P.setAttribute("height",m.toString())}function P(t){var n=c,r=[],i=0;for(i=0;i<t.length;i++){r[i]=q(t[i].name,t[i]);var s=e.getBBox(r[i]).height;s>n&&(n=s)}return n}function H(t){var n=N.getElementById(_("__defs")),r=N.getElementById(_("__sequencelayer")),i=0,s;E={},S={};var o={};if(t){c=P(t)+p*2;for(s=0;s<t.length;s++)o={},n.appendChild(q(_(t[s].name),t[s])),r.appendChild(e.createUse(i,0,_(t[s].name))),E[t[s].name]=i+f/2,i+=u,t[s].arclinecolor&&(o.arclinecolor=t[s].arclinecolor),t[s].arctextcolor&&(o.arctextcolor=t[s].arctextcolor),t[s].arctextbgcolor&&(o.arctextbgcolor=t[s].arctextbgcolor),S[t[s].name]=o}w=i}function B(t,n){var r=N.getElementById(_("__defs")),s=N.getElementById(_("__lifelinelayer")),o=N.getElementById(_("__sequencelayer")),a=N.getElementById(_("__notelayer")),l=[],c="",h=w-u+f,d,v,m=0;r.appendChild(R(n,_("arcrow"))),s.appendChild(e.createUse(0,L(-1).y,_("arcrow"))),k();if(t){for(d=0;d<t.length;d++){var g=!1,y=[];A(d);for(v=0;v<t[d].length;v++){var b=_(d.toString()+"_"+v.toString()),S;c="",t[d][v].label&&(c=t[d][v].label);switch(i.getAggregate(t[d][v].kind)){case"emptyarc":S=z(t[d][v],b),g="..."===t[d][v].kind,y.push({id:b,layer:o});break;case"box":S=Y(b,E[t[d][v].from],E[t[d][v].to],t[d][v]),y.push({id:b,layer:a});break;case"inline_expression":S=j(b+"_label",t[d][v]),y.push({id:b+"_label",layer:a}),l.push({id:b,arc:t[d][v],rownum:d});break;default:if(t[d][v].from&&t[d][v].to){var T=t[d][v].from,C=t[d][v].to,O=0,M=0;if(C==="*"){M=E[T];for(m=0;m<n.length;m++)n[m].name!=T&&(O=E[n[m].name],t[d][v].label="",r.appendChild(W(b+"bc"+m,t[d][v],M,O)),y.push({id:b+"bc"+m,layer:o}));t[d][v].label=c,S=$(b+"_txt",t[d][v],0,0-x/2-p,h),y.push({id:b+"_txt",layer:o})}else M=E[T],O=E[C],S=W(b,t[d][v],M,O),y.push({id:b,layer:o})}}S&&(A(d,Math.max(L(d).height,e.getBBox(S).height+2*p)),r.appendChild(S))}var D="arcrow_"+d.toString(),P="arcrow";g&&(P="arcrowomit"),r.appendChild(R(n,P,L(d).height,_(D))),s.appendChild(e.createUse(0,L(d).y,_(D)));for(var H=0;H<y.length;H++)y[H].layer.appendChild(e.createUse(0,L(d).y,y[H].id))}F(l)}}function j(t,n){var r=E[n.from],i=E[n.to],s=7;if(r>i){var o=r;r=i,i=o}var a=i-r+(u-2*p)-s-p,f=r-(u-3*p)/2-(b-n.depth)*2*p,l=e.createGroup(t);n.label=n.kind+(n.label?": "+n.label:"");var c=$(t+"_txt",n,f+p-a/2,v/4,a,"anchor-start"),h=e.getBBox(c),d=Math.max(h.height+2*p,v/2-2*p),m=Math.min(h.width+2*p,a),g=e.createEdgeRemark(m-p+s,d,"box",f,0,s);return G(g,n),l.appendChild(g),l.appendChild(c),l}function F(t){var n=N.getElementById(_("__defs")),r=N.getElementById(_("__arcspanlayer"));for(var i=0;i<t.length;i++)n.appendChild(I(t[i])),r.appendChild(e.createUse(0,L(t[i].rownum).y,t[i].id))}function I(e){var t=L(e.rownum).y,n=L(e.rownum+e.arc.numberofrows+1).y,r=n-t;return e.arc.label="",Y(e.id,E[e.arc.from],E[e.arc.to],e.arc,r)}function q(t,n){var r=e.createGroup(t),i=$(t+"_txt",n,0,c/2,f,"entity"),s=e.createRect(f,c);return G(s,n),r.appendChild(s),r.appendChild(i),r}function R(t,n,r,i){var s=0;if(i===undefined||i===null)i=n;if(r===undefined||r===null||r<v)r=v;var o=e.createGroup(i),a=0;for(s=0;s<t.length;s++){var l=e.createLine(a+f/2,0-r/2,a+f/2,r/2,n);t[s].linecolor&&l.setAttribute("style","stroke : "+t[s].linecolor+";"),o.appendChild(l),a+=u}return o}function U(t,n,r,i,s){var o=2*(v/5),a=u/3,f=e.createGroup("selfie");if(i){var l=e.createUTurn(n,(o-4)/2,r-2+o,a-4,"none"),c=e.createUTurn(n,(o+4)/2,r+6+o,a,t);s&&(l.setAttribute("style","stroke: "+s+";"),c.setAttribute("style","stroke: "+s+";")),f.appendChild(l),f.appendChild(c)}else{var h=e.createUTurn(n,o/2,r+o,a,t);s&&h.setAttribute("style","stroke: "+s+";"),f.appendChild(h)}return f}function z(e,t){var n;if(e.from&&e.to&&E[e.from]>E[e.to]){var r=e.from;e.from=e.to,e.to=r}switch(e.kind){case"...":case"|||":n=J(t,e);break;case"---":n=K(t,e)}return n}function W(t,n,r,s){var o=e.createGroup(t),a="",f=g,l=":>"===n.kind||"::"===n.kind||"<:>"===n.kind;a=i.determineArcClass(n.kind,r,s),"-x"===n.kind&&(s=r+(s-r)*.75);var c=0;n.arcskip&&(c=n.arcskip*v,f=c),n.label&&n.label.indexOf("\\n")===-1&&(n.label+="\\n");if(r===s)o.appendChild(U(a,r,c,l,n.linecolor)),o.appendChild($(t+"_txt",n,r+2-u/2,0-v/5,u,"anchor-start"));else{var h=e.createLine(r,0,s,f,a,l);n.linecolor&&h.setAttribute("style","stroke:"+n.linecolor+"; fill: "+n.linecolor+";"),o.appendChild(h),o.appendChild($(t+"_txt",n,r,0,s-r))}return o}function X(e,t,r){var i=e.split("\\n"),s=n.determineMaxTextWidth(r);switch(t){case"box":case"rbox":case"abox":case"note":case undefined:i=n.wrap(e,s);break;default:y&&(i=n.wrap(e,s))}return i}function V(t,n,r,i,s,o,u){var a=t,f={};u===0?f=e.createText(n,r,i+x/4+u*x,s,o.url,o.id,o.idurl):f=e.createText(n,r,i+x/4+u*x,s,o.url);var l=e.getBBox(f),c=e.createRect(l.width,l.height,"textbg",l.x,l.y);return Q(f,o),o.textbgcolor&&c.setAttribute("style","fill: "+o.textbgcolor+"; stroke:"+o.textbgcolor+";"),o.url&&!o.textcolor&&(o.textcolor="blue",Q(f,o)),a.appendChild(c),a.appendChild(f),a}function $(t,r,i,s,o,u){var a=e.createGroup(t);if(r.label){var f=i+o/2;r.label=n.unescapeString(r.label),r.id&&(r.id=n.unescapeString(r.id));var l=X(r.label,r.kind,o),c=s-(l.length-1)*x/2-(l.length-1)/2;for(var h=0;h<l.length;h++)a=V(a,l[h],f,c,u,r,h),c++}return a}function J(t,n){var r=0,i=w-u+f,s=e.createGroup(t);return n.from&&n.to&&(r=E[n.from],i=Math.abs(E[n.to]-E[n.from])),s.appendChild($(t,n,r,0,i)),s}function K(t,n){var r=0,i=w-u+f,s="dotted",o=e.createGroup(t);if(n.from&&n.to){var a=(b-n.depth)*2*p;r=E[n.from]-(u+2*p)/2-a,i=E[n.to]+(u+2*p)/2+a,s="striped"}var l=e.createLine(r,0,i,0,s);return o.appendChild(l),o.appendChild(J(t+"_txt",n)),n.linecolor&&l.setAttribute("style","stroke: "+n.linecolor+";"),o}function Q(e,t){if(t.textcolor){var n="";n+="fill:"+t.textcolor+";",e.setAttribute("style",n)}}function G(e,t){var n="";t.textbgcolor&&(n+="fill:"+t.textbgcolor+";"),t.linecolor&&(n+="stroke:"+t.linecolor+";"),e.setAttribute("style",n)}function Y(t,n,r,i,s){if(n>r){var o=n;n=r,r=o}var a=r-n+u-2*p,f=9,l=6,c=n-(u-2*p)/2,h=e.createGroup(t),d,m=$(t+"_txt",i,c,0,a),g=e.getBBox(m),y=s?s:Math.max(g.height+2*p,v-2*p);switch(i.kind){case"box":d=e.createRect(a,y,"box",c,0-y/2);break;case"rbox":d=e.createRect(a,y,"box",c,0-y/2,l,l);break;case"abox":d=e.createABox(a,y,"box",c,0);break;case"note":d=e.createNote(a,y,"box",c,0-y/2,f);break;default:var w=(b-i.depth)*2*p;d=e.createRect(a+w*2,y,"box",c-w,0)}return G(d,i),h.appendChild(d),h.appendChild(m),h}var s=3,o=160,u=o,a=100,f=a,l=34,c=l,h=38,p=2,d="mscgen_js$svg$",v=h,m=0,g=m,y=!1,b=0,w=0,E={},S={},x=12,T=d,N,C=[];return{clean:function(e,t){O(e,t)},renderAST:function(e,t,n,r){D(e,t,n,r)}}}),define("controller-inpage",["xuparser","msgennyparser","renderast"],function(e,t,n){function i(){var e=document.getElementsByClassName("mscgen_js"),t,n;for(var i=0;i<e.length;i++){n="mscgen";if(""===e[i].id||null===e[i].id||undefined===e[i].id)e[i].id=r+i.toString();e[i].dataset&&e[i].dataset.language&&(n=e[i].dataset.language),t=s(e[i].textContent,n),t.entities?o(t,e[i].id,e[i].textContent):e[i].innerHTML+="<div style='color: red'>ERROR: line "+t.line+", column "+t.column+": "+t.message+"</div>"}}function s(n,r){var i={};try{"msgenny"===r?i=t.parse(n):"json"===r?i=JSON.parse(n):"xu"===r?i=e.parse(n):i=e.parse(n)}catch(s){return s}return i}function o(e,t,r){document.getElementById(t).innerHTML="",n.clean(t,window),n.renderAST(e,r,t,window)}var r="mscgen_js$parent_";i()}),require(["controller-inpage"],function(e){}),define("mscgen-inpage",function(){});