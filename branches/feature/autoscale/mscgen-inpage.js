/**
 * @license almond 0.3.1 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/*
 This file is part of mscgen_js.

 mscgen_js is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 mscgen_js is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with mscgen_js.  If not, see <http://www.gnu.org/licenses/>.
 */

/**
 * @license
 * lodash 4.5.0 (Custom Build) <https://lodash.com/>
 * Build: `lodash exports="umd" include="memoize,cloneDeep,flatten,defaults" --development --output lib/lodash/lodash.custom.js`
 * Copyright 2012-2016 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2016 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 */

(function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.slice(0,v.length-1).concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){var n=p.call(arguments,0);return typeof n[0]!="string"&&n.length===1&&n.push(null),s.apply(r,n.concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){if(typeof e!="string")throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../node_modules/almond/almond",function(){}),n("lib/mscgenjs-core/parse/xuparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function Pi(){return e.substring(Li,ki)}function Hi(){return Ii(Li,ki)}function Bi(t){throw Ri(null,[{type:"other",description:t}],e.substring(Li,ki),Ii(Li,ki))}function ji(t){throw Ri(t,null,e.substring(Li,ki),Ii(Li,ki))}function Fi(t){var n=Ai[t],r,i;if(n)return n;r=t-1;while(!Ai[r])r--;n=Ai[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Ai[t]=n,n}function Ii(e,t){var n=Fi(e),r=Fi(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function qi(e){if(ki<Oi)return;ki>Oi&&(Oi=ki,Mi=[]),Mi.push(e)}function Ri(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function Ui(){var t,n,r,s,o,h,p,d,v,m;return t=ki,n=Ls(),n!==i?(r=zi(),r!==i?(s=Ls(),s!==i?(e.charCodeAt(ki)===123?(o=u,ki++):(o=i,_i===0&&qi(a)),o!==i?(h=Ls(),h!==i?(p=Wi(),p!==i?(d=Ls(),d!==i?(e.charCodeAt(ki)===125?(v=f,ki++):(v=i,_i===0&&qi(l)),v!==i?(m=Ls(),m!==i?(Li=t,n=c(n,p),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t}function zi(){var t;return e.substr(ki,3).toLowerCase()===h?(t=e.substr(ki,3),ki+=3):(t=i,_i===0&&qi(p)),t===i&&(e.substr(ki,2).toLowerCase()===d?(t=e.substr(ki,2),ki+=2):(t=i,_i===0&&qi(v))),t}function Wi(){var e,t,n,r,s;return e=ki,t=ki,n=Xi(),n!==i&&(Li=t,n=m(n)),t=n,t===i&&(t=null),t!==i?(n=ki,r=Ji(),r!==i&&(Li=n,r=g(r)),n=r,n===i&&(n=null),n!==i?(r=ki,s=Qi(),s!==i&&(Li=r,s=y(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(ki=e,e=i)):(ki=e,e=i)):(ki=e,e=i),e}function Xi(){var t,n,r,s,o,u;t=ki,n=ki,r=[],s=ki,o=Vi(),o!==i?(e.charCodeAt(ki)===44?(u=b,ki++):(u=i,_i===0&&qi(w)),u!==i?(Li=s,o=E(o),s=o):(ki=s,s=i)):(ki=s,s=i);while(s!==i)r.push(s),s=ki,o=Vi(),o!==i?(e.charCodeAt(ki)===44?(u=b,ki++):(u=i,_i===0&&qi(w)),u!==i?(Li=s,o=E(o),s=o):(ki=s,s=i)):(ki=s,s=i);return r!==i?(s=ki,o=Vi(),o!==i?(e.charCodeAt(ki)===59?(u=S,ki++):(u=i,_i===0&&qi(x)),u!==i?(Li=s,o=E(o),s=o):(ki=s,s=i)):(ki=s,s=i),s!==i?(r=[r,s],n=r):(ki=n,n=i)):(ki=n,n=i),n!==i&&(Li=t,n=T(n)),t=n,t}function Vi(){var t,n,r,s,o,u,a,f;return t=ki,n=Ls(),n!==i?(r=$i(),r!==i?(s=Ls(),s!==i?(e.charCodeAt(ki)===61?(o=N,ki++):(o=i,_i===0&&qi(C)),o!==i?(u=Ls(),u!==i?(a=ki,f=vs(),f!==i&&(Li=a,f=k(r,f)),a=f,a===i&&(a=ki,f=Ds(),f!==i&&(Li=a,f=L(r,f)),a=f,a===i&&(a=ki,f=_s(),f!==i&&(Li=a,f=A(r,f)),a=f)),a!==i?(f=Ls(),f!==i?(Li=t,n=O(r,a),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t}function $i(){var t;return e.substr(ki,6).toLowerCase()===M?(t=e.substr(ki,6),ki+=6):(t=i,_i===0&&qi(_)),t===i&&(e.substr(ki,5).toLowerCase()===D?(t=e.substr(ki,5),ki+=5):(t=i,_i===0&&qi(P)),t===i&&(e.substr(ki,11).toLowerCase()===H?(t=e.substr(ki,11),ki+=11):(t=i,_i===0&&qi(B)),t===i&&(e.substr(ki,12).toLowerCase()===j?(t=e.substr(ki,12),ki+=12):(t=i,_i===0&&qi(F)),t===i&&(e.substr(ki,9).toLowerCase()===I?(t=e.substr(ki,9),ki+=9):(t=i,_i===0&&qi(q)))))),t}function Ji(){var t,n,r,s,o,u;t=ki,n=ki,r=[],s=ki,o=Ki(),o!==i?(e.charCodeAt(ki)===44?(u=b,ki++):(u=i,_i===0&&qi(w)),u!==i?(Li=s,o=R(o),s=o):(ki=s,s=i)):(ki=s,s=i);while(s!==i)r.push(s),s=ki,o=Ki(),o!==i?(e.charCodeAt(ki)===44?(u=b,ki++):(u=i,_i===0&&qi(w)),u!==i?(Li=s,o=R(o),s=o):(ki=s,s=i)):(ki=s,s=i);return r!==i?(s=ki,o=Ki(),o!==i?(e.charCodeAt(ki)===59?(u=S,ki++):(u=i,_i===0&&qi(x)),u!==i?(Li=s,o=R(o),s=o):(ki=s,s=i)):(ki=s,s=i),s!==i?(r=[r,s],n=r):(ki=n,n=i)):(ki=n,n=i),n!==i&&(Li=t,n=U(n)),t=n,t}function Ki(){var t,n,r,s,o,u,a,f;return _i++,t=ki,n=Ls(),n!==i?(r=gs(),r!==i?(s=Ls(),s!==i?(o=ki,e.charCodeAt(ki)===91?(u=W,ki++):(u=i,_i===0&&qi(X)),u!==i?(a=hs(),a!==i?(e.charCodeAt(ki)===93?(f=V,ki++):(f=i,_i===0&&qi($)),f!==i?(Li=o,u=J(r,a),o=u):(ki=o,o=i)):(ki=o,o=i)):(ki=o,o=i),o===i&&(o=null),o!==i?(u=Ls(),u!==i?(Li=t,n=K(r,o),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),_i--,t===i&&(n=i,_i===0&&qi(z)),t}function Qi(){var t,n,r,s,o;t=[],n=ki,r=Gi(),r!==i?(s=Ls(),s!==i?(e.charCodeAt(ki)===59?(o=S,ki++):(o=i,_i===0&&qi(x)),o!==i?(Li=n,r=Q(r),n=r):(ki=n,n=i)):(ki=n,n=i)):(ki=n,n=i);if(n!==i)while(n!==i)t.push(n),n=ki,r=Gi(),r!==i?(s=Ls(),s!==i?(e.charCodeAt(ki)===59?(o=S,ki++):(o=i,_i===0&&qi(x)),o!==i?(Li=n,r=Q(r),n=r):(ki=n,n=i)):(ki=n,n=i)):(ki=n,n=i);else t=i;return t}function Gi(){var t,n,r,s,o,u,a;t=ki,n=ki,r=[],s=ki,o=Yi(),o!==i?(u=Ls(),u!==i?(e.charCodeAt(ki)===44?(a=b,ki++):(a=i,_i===0&&qi(w)),a!==i?(Li=s,o=Q(o),s=o):(ki=s,s=i)):(ki=s,s=i)):(ki=s,s=i);while(s!==i)r.push(s),s=ki,o=Yi(),o!==i?(u=Ls(),u!==i?(e.charCodeAt(ki)===44?(a=b,ki++):(a=i,_i===0&&qi(w)),a!==i?(Li=s,o=Q(o),s=o):(ki=s,s=i)):(ki=s,s=i)):(ki=s,s=i);return r!==i?(s=ki,o=Yi(),o!==i&&(Li=s,o=G(o)),s=o,s!==i?(r=[r,s],n=r):(ki=n,n=i)):(ki=n,n=i),n!==i&&(Li=t,n=Y(n)),t=n,t}function Yi(){var e;return e=Zi(),e===i&&(e=rs()),e}function Zi(){var t,n,r,s,o,u;return t=ki,n=ki,r=es(),r!==i&&(Li=n,r=Q(r)),n=r,n===i&&(n=ki,r=ns(),r!==i&&(Li=n,r=Q(r)),n=r,n===i&&(n=ki,r=ts(),r!==i&&(Li=n,r=Q(r)),n=r)),n!==i?(r=ki,e.charCodeAt(ki)===91?(s=W,ki++):(s=i,_i===0&&qi(X)),s!==i?(o=hs(),o!==i?(e.charCodeAt(ki)===93?(u=V,ki++):(u=i,_i===0&&qi($)),u!==i?(Li=r,s=Z(n,o),r=s):(ki=r,r=i)):(ki=r,r=i)):(ki=r,r=i),r===i&&(r=null),r!==i?(Li=t,n=et(n,r),t=n):(ki=t,t=i)):(ki=t,t=i),t}function es(){var e,t,n,r;return e=ki,t=Ls(),t!==i?(n=is(),n!==i?(r=Ls(),r!==i?(Li=e,t=tt(n),e=t):(ki=e,e=i)):(ki=e,e=i)):(ki=e,e=i),e}function ts(){var e,t,n,r;return e=ki,t=Ls(),t!==i?(n=ss(),n!==i?(r=Ls(),r!==i?(Li=e,t=tt(n),e=t):(ki=e,e=i)):(ki=e,e=i)):(ki=e,e=i),e}function ns(){var t,n,r,s,o,u,a,f;return t=ki,n=Ls(),n!==i?(r=gs(),r!==i?(s=Ls(),s!==i?(o=os(),o!==i?(u=Ls(),u!==i?(a=gs(),a!==i?(f=Ls(),f!==i?(Li=t,n=nt(r,o,a),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t===i&&(t=ki,n=Ls(),n!==i?(e.charCodeAt(ki)===42?(r=rt,ki++):(r=i,_i===0&&qi(it)),r!==i?(s=Ls(),s!==i?(o=fs(),o!==i?(u=Ls(),u!==i?(a=gs(),a!==i?(f=Ls(),f!==i?(Li=t,n=st(o,a),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t===i&&(t=ki,n=Ls(),n!==i?(r=gs(),r!==i?(s=Ls(),s!==i?(o=as(),o!==i?(u=Ls(),u!==i?(e.charCodeAt(ki)===42?(a=rt,ki++):(a=i,_i===0&&qi(it)),a!==i?(f=Ls(),f!==i?(Li=t,n=ot(r,o),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t===i&&(t=ki,n=Ls(),n!==i?(r=gs(),r!==i?(s=Ls(),s!==i?(o=us(),o!==i?(u=Ls(),u!==i?(e.charCodeAt(ki)===42?(a=rt,ki++):(a=i,_i===0&&qi(it)),a!==i?(f=Ls(),f!==i?(Li=t,n=ot(r,o),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)))),t}function rs(){var t,n,r,s,o,c,h,p,d,v,m,g,y,b,w,E;return t=ki,n=Ls(),n!==i?(r=gs(),r!==i?(s=Ls(),s!==i?(o=cs(),o!==i?(c=Ls(),c!==i?(h=gs(),h!==i?(p=Ls(),p!==i?(d=ki,e.charCodeAt(ki)===91?(v=W,ki++):(v=i,_i===0&&qi(X)),v!==i?(m=hs(),m!==i?(e.charCodeAt(ki)===93?(g=V,ki++):(g=i,_i===0&&qi($)),g!==i?(Li=d,v=ut(r,o,h,m),d=v):(ki=d,d=i)):(ki=d,d=i)):(ki=d,d=i),d===i&&(d=null),d!==i?(v=Ls(),v!==i?(e.charCodeAt(ki)===123?(m=u,ki++):(m=i,_i===0&&qi(a)),m!==i?(g=Ls(),g!==i?(y=Qi(),y===i&&(y=null),y!==i?(b=Ls(),b!==i?(e.charCodeAt(ki)===125?(w=f,ki++):(w=i,_i===0&&qi(l)),w!==i?(E=Ls(),E!==i?(Li=t,n=at(r,o,h,d,y),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t}function is(){var t;return e.substr(ki,3)===ft?(t=ft,ki+=3):(t=i,_i===0&&qi(lt)),t===i&&(e.substr(ki,3)===ct?(t=ct,ki+=3):(t=i,_i===0&&qi(ht))),t}function ss(){var t;return e.substr(ki,3)===pt?(t=pt,ki+=3):(t=i,_i===0&&qi(dt)),t}function os(){var e,t;return e=ki,t=us(),t===i&&(t=as(),t===i&&(t=fs(),t===i&&(t=ls()))),t!==i&&(Li=e,t=vt(t)),e=t,e}function us(){var t,n;return _i++,e.substr(ki,2)===gt?(t=gt,ki+=2):(t=i,_i===0&&qi(yt)),t===i&&(e.substr(ki,3)===bt?(t=bt,ki+=3):(t=i,_i===0&&qi(wt)),t===i&&(e.substr(ki,2)===Et?(t=Et,ki+=2):(t=i,_i===0&&qi(St)),t===i&&(e.substr(ki,5)===xt?(t=xt,ki+=5):(t=i,_i===0&&qi(Tt)),t===i&&(e.substr(ki,3)===Nt?(t=Nt,ki+=3):(t=i,_i===0&&qi(Ct)),t===i&&(e.substr(ki,2)===kt?(t=kt,ki+=2):(t=i,_i===0&&qi(Lt)),t===i&&(e.substr(ki,4)===At?(t=At,ki+=4):(t=i,_i===0&&qi(Ot)),t===i&&(e.substr(ki,2)===Mt?(t=Mt,ki+=2):(t=i,_i===0&&qi(_t)),t===i&&(e.substr(ki,3)===Dt?(t=Dt,ki+=3):(t=i,_i===0&&qi(Pt)))))))))),_i--,t===i&&(n=i,_i===0&&qi(mt)),t}function as(){var t,n;return _i++,e.substr(ki,2)===Bt?(t=Bt,ki+=2):(t=i,_i===0&&qi(jt)),t===i&&(e.substr(ki,3)===Ft?(t=Ft,ki+=3):(t=i,_i===0&&qi(It)),t===i&&(e.substr(ki,2)===qt?(t=qt,ki+=2):(t=i,_i===0&&qi(Rt)),t===i&&(e.substr(ki,2)===Ut?(t=Ut,ki+=2):(t=i,_i===0&&qi(zt)),t===i&&(e.substr(ki,2)===Wt?(t=Wt,ki+=2):(t=i,_i===0&&qi(Xt)),t===i&&(e.substr(ki,2).toLowerCase()===Vt?(t=e.substr(ki,2),ki+=2):(t=i,_i===0&&qi($t))))))),_i--,t===i&&(n=i,_i===0&&qi(Ht)),t}function fs(){var t,n;return _i++,e.substr(ki,2)===Kt?(t=Kt,ki+=2):(t=i,_i===0&&qi(Qt)),t===i&&(e.substr(ki,3)===Gt?(t=Gt,ki+=3):(t=i,_i===0&&qi(Yt)),t===i&&(e.substr(ki,2)===Zt?(t=Zt,ki+=2):(t=i,_i===0&&qi(en)),t===i&&(e.substr(ki,2)===tn?(t=tn,ki+=2):(t=i,_i===0&&qi(nn)),t===i&&(e.substr(ki,2)===rn?(t=rn,ki+=2):(t=i,_i===0&&qi(sn)),t===i&&(e.substr(ki,2).toLowerCase()===on?(t=e.substr(ki,2),ki+=2):(t=i,_i===0&&qi(un))))))),_i--,t===i&&(n=i,_i===0&&qi(Jt)),t}function ls(){var t,n;return _i++,e.substr(ki,4).toLowerCase()===fn?(t=e.substr(ki,4),ki+=4):(t=i,_i===0&&qi(ln)),t===i&&(e.substr(ki,4).toLowerCase()===cn?(t=e.substr(ki,4),ki+=4):(t=i,_i===0&&qi(hn)),t===i&&(e.substr(ki,4).toLowerCase()===pn?(t=e.substr(ki,4),ki+=4):(t=i,_i===0&&qi(dn)),t===i&&(e.substr(ki,3).toLowerCase()===vn?(t=e.substr(ki,3),ki+=3):(t=i,_i===0&&qi(mn))))),_i--,t===i&&(n=i,_i===0&&qi(an)),t}function cs(){var t,n;return _i++,t=ki,e.substr(ki,3).toLowerCase()===yn?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi(bn)),n===i&&(e.substr(ki,4).toLowerCase()===wn?(n=e.substr(ki,4),ki+=4):(n=i,_i===0&&qi(En)),n===i&&(e.substr(ki,3).toLowerCase()===Sn?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi(xn)),n===i&&(e.substr(ki,5).toLowerCase()===Tn?(n=e.substr(ki,5),ki+=5):(n=i,_i===0&&qi(Nn)),n===i&&(e.substr(ki,3).toLowerCase()===Cn?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi(kn)),n===i&&(e.substr(ki,3).toLowerCase()===Ln?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi(An)),n===i&&(e.substr(ki,6).toLowerCase()===On?(n=e.substr(ki,6),ki+=6):(n=i,_i===0&&qi(Mn)),n===i&&(e.substr(ki,3).toLowerCase()===_n?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi(Dn)),n===i&&(e.substr(ki,8).toLowerCase()===Pn?(n=e.substr(ki,8),ki+=8):(n=i,_i===0&&qi(Hn)),n===i&&(e.substr(ki,6).toLowerCase()===Bn?(n=e.substr(ki,6),ki+=6):(n=i,_i===0&&qi(jn)),n===i&&(e.substr(ki,8).toLowerCase()===Fn?(n=e.substr(ki,8),ki+=8):(n=i,_i===0&&qi(In)),n===i&&(e.substr(ki,6).toLowerCase()===qn?(n=e.substr(ki,6),ki+=6):(n=i,_i===0&&qi(Rn)),n===i&&(e.substr(ki,4).toLowerCase()===Un?(n=e.substr(ki,4),ki+=4):(n=i,_i===0&&qi(zn)),n===i&&(e.substr(ki,3).toLowerCase()===Wn?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi(Xn)),n===i&&(e.substr(ki,3).toLowerCase()===Vn?(n=e.substr(ki,3),ki+=3):(n=i,_i===0&&qi($n)))))))))))))))),n!==i&&(Li=t,n=vt(n)),t=n,_i--,t===i&&(n=i,_i===0&&qi(gn)),t}function hs(){var t,n,r,s,o,u;t=ki,n=ki,r=[],s=ki,o=ps(),o!==i?(e.charCodeAt(ki)===44?(u=b,ki++):(u=i,_i===0&&qi(w)),u!==i?(Li=s,o=Q(o),s=o):(ki=s,s=i)):(ki=s,s=i);while(s!==i)r.push(s),s=ki,o=ps(),o!==i?(e.charCodeAt(ki)===44?(u=b,ki++):(u=i,_i===0&&qi(w)),u!==i?(Li=s,o=Q(o),s=o):(ki=s,s=i)):(ki=s,s=i);return r!==i?(s=ki,o=ps(),o!==i&&(Li=s,o=Q(o)),s=o,s!==i?(r=[r,s],n=r):(ki=n,n=i)):(ki=n,n=i),n!==i&&(Li=t,n=Jn(n)),t=n,t}function ps(){var t,n,r,s,o,u,a,f;return t=ki,n=Ls(),n!==i?(r=ds(),r!==i?(s=Ls(),s!==i?(e.charCodeAt(ki)===61?(o=N,ki++):(o=i,_i===0&&qi(C)),o!==i?(u=Ls(),u!==i?(a=gs(),a!==i?(f=Ls(),f!==i?(Li=t,n=Kn(r,a),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t}function ds(){var t,n;return _i++,e.substr(ki,5).toLowerCase()===Gn?(t=e.substr(ki,5),ki+=5):(t=i,_i===0&&qi(Yn)),t===i&&(e.substr(ki,5).toLowerCase()===Zn?(t=e.substr(ki,5),ki+=5):(t=i,_i===0&&qi(er)),t===i&&(e.substr(ki,2).toLowerCase()===tr?(t=e.substr(ki,2),ki+=2):(t=i,_i===0&&qi(nr)),t===i&&(e.substr(ki,3).toLowerCase()===rr?(t=e.substr(ki,3),ki+=3):(t=i,_i===0&&qi(ir)),t===i&&(e.substr(ki,9).toLowerCase()===sr?(t=e.substr(ki,9),ki+=9):(t=i,_i===0&&qi(or)),t===i&&(e.substr(ki,10).toLowerCase()===ur?(t=e.substr(ki,10),ki+=10):(t=i,_i===0&&qi(ar)),t===i&&(e.substr(ki,9).toLowerCase()===fr?(t=e.substr(ki,9),ki+=9):(t=i,_i===0&&qi(lr)),t===i&&(e.substr(ki,10).toLowerCase()===cr?(t=e.substr(ki,10),ki+=10):(t=i,_i===0&&qi(hr)),t===i&&(e.substr(ki,11).toLowerCase()===pr?(t=e.substr(ki,11),ki+=11):(t=i,_i===0&&qi(dr)),t===i&&(e.substr(ki,12).toLowerCase()===vr?(t=e.substr(ki,12),ki+=12):(t=i,_i===0&&qi(mr)),t===i&&(e.substr(ki,12).toLowerCase()===gr?(t=e.substr(ki,12),ki+=12):(t=i,_i===0&&qi(yr)),t===i&&(e.substr(ki,13).toLowerCase()===br?(t=e.substr(ki,13),ki+=13):(t=i,_i===0&&qi(wr)),t===i&&(e.substr(ki,12).toLowerCase()===Er?(t=e.substr(ki,12),ki+=12):(t=i,_i===0&&qi(Sr)),t===i&&(e.substr(ki,13).toLowerCase()===xr?(t=e.substr(ki,13),ki+=13):(t=i,_i===0&&qi(Tr)),t===i&&(e.substr(ki,14).toLowerCase()===Nr?(t=e.substr(ki,14),ki+=14):(t=i,_i===0&&qi(Cr)),t===i&&(e.substr(ki,15).toLowerCase()===kr?(t=e.substr(ki,15),ki+=15):(t=i,_i===0&&qi(Lr)),t===i&&(e.substr(ki,7).toLowerCase()===Ar?(t=e.substr(ki,7),ki+=7):(t=i,_i===0&&qi(Or)))))))))))))))))),_i--,t===i&&(n=i,_i===0&&qi(Qn)),t}function vs(){var t,n,r,s;return t=ki,e.charCodeAt(ki)===34?(n=Mr,ki++):(n=i,_i===0&&qi(_r)),n!==i?(r=ms(),r!==i?(e.charCodeAt(ki)===34?(s=Mr,ki++):(s=i,_i===0&&qi(_r)),s!==i?(Li=t,n=Dr(r),t=n):(ki=t,t=i)):(ki=t,t=i)):(ki=t,t=i),t}function ms(){var t,n,r,s;t=[],n=ki,r=ki,_i++,e.charCodeAt(ki)===34?(s=Mr,ki++):(s=i,_i===0&&qi(_r)),_i--,s===i?r=void 0:(ki=r,r=i),r!==i?(e.substr(ki,2)===Pr?(s=Pr,ki+=2):(s=i,_i===0&&qi(Hr)),s===i&&(e.length>ki?(s=e.charAt(ki),ki++):(s=i,_i===0&&qi(Br))),s!==i?(Li=n,r=jr(s),n=r):(ki=n,n=i)):(ki=n,n=i);while(n!==i)t.push(n),n=ki,r=ki,_i++,e.charCodeAt(ki)===34?(s=Mr,ki++):(s=i,_i===0&&qi(_r)),_i--,s===i?r=void 0:(ki=r,r=i),r!==i?(e.substr(ki,2)===Pr?(s=Pr,ki+=2):(s=i,_i===0&&qi(Hr)),s===i&&(e.length>ki?(s=e.charAt(ki),ki++):(s=i,_i===0&&qi(Br))),s!==i?(Li=n,r=jr(s),n=r):(ki=n,n=i)):(ki=n,n=i);return t}function gs(){var t,n,r;_i++,t=ki,n=[],Ir.test(e.charAt(ki))?(r=e.charAt(ki),ki++):(r=i,_i===0&&qi(qr));if(r!==i)while(r!==i)n.push(r),Ir.test(e.charAt(ki))?(r=e.charAt(ki),ki++):(r=i,_i===0&&qi(qr));else n=i;return n!==i&&(Li=t,n=Rr(n)),t=n,t===i&&(t=vs()),_i--,t===i&&(n=i,_i===0&&qi(Fr)),t}function ys(){var t,n;return _i++,t=ki,zr.test(e.charAt(ki))?(n=e.charAt(ki),ki++):(n=i,_i===0&&qi(Wr)),n!==i&&(Li=t,n=jr(n)),t=n,_i--,t===i&&(n=i,_i===0&&qi(Ur)),t}function bs(){var t,n;return _i++,t=ki,Vr.test(e.charAt(ki))?(n=e.charAt(ki),ki++):(n=i,_i===0&&qi($r)),n!==i&&(Li=t,n=jr(n)),t=n,_i--,t===i&&(n=i,_i===0&&qi(Xr)),t}function ws(){var t;return e.substr(ki,2)===Jr?(t=Jr,ki+=2):(t=i,_i===0&&qi(Kr)),t}function Es(){var t;return e.substr(ki,2)===Qr?(t=Qr,ki+=2):(t=i,_i===0&&qi(Gr)),t}function Ss(){var t,n,r;return t=ki,n=ki,_i++,e.substr(ki,2)===Qr?(r=Qr,ki+=2):(r=i,_i===0&&qi(Gr)),_i--,r===i?n=void 0:(ki=n,n=i),n!==i?(e.length>ki?(r=e.charAt(ki),ki++):(r=i,_i===0&&qi(Br)),r!==i?(Li=t,n=jr(r),t=n):(ki=t,t=i)):(ki=t,t=i),t}function xs(){var e,t,n,r;e=ki,t=ws();if(t!==i){n=[],r=Ss();while(r!==i)n.push(r),r=Ss();n!==i?(r=Es(),r!==i?(Li=e,t=Yr(t,n,r),e=t):(ki=e,e=i)):(ki=e,e=i)}else ki=e,e=i;return e}function Ts(){var t;return e.substr(ki,2)===Zr?(t=Zr,ki+=2):(t=i,_i===0&&qi(ei)),t===i&&(e.charCodeAt(ki)===35?(t=ti,ki++):(t=i,_i===0&&qi(ni))),t}function Ns(){var t;return ri.test(e.charAt(ki))?(t=e.charAt(ki),ki++):(t=i,_i===0&&qi(ii)),t}function Cs(){var e,t,n,r;e=ki,t=Ts();if(t!==i){n=[],r=Ns();while(r!==i)n.push(r),r=Ns();n!==i?(Li=e,t=si(t,n),e=t):(ki=e,e=i)}else ki=e,e=i;return e}function ks(){var e,t;return _i++,e=Cs(),e===i&&(e=xs()),_i--,e===i&&(t=i,_i===0&&qi(oi)),e}function Ls(){var e,t;e=[],t=ys(),t===i&&(t=bs(),t===i&&(t=ks()));while(t!==i)e.push(t),t=ys(),t===i&&(t=bs(),t===i&&(t=ks()));return e}function As(){var e;return e=Ms(),e===i&&(e=Os()),e}function Os(){var t,n,r;_i++,t=ki,n=[],ai.test(e.charAt(ki))?(r=e.charAt(ki),ki++):(r=i,_i===0&&qi(fi));if(r!==i)while(r!==i)n.push(r),ai.test(e.charAt(ki))?(r=e.charAt(ki),ki++):(r=i,_i===0&&qi(fi));else n=i;return n!==i&&(Li=t,n=li(n)),t=n,_i--,t===i&&(n=i,_i===0&&qi(ui)),t}function Ms(){var t,n,r,s,o,u;_i++,t=ki,n=ki,r=[],ai.test(e.charAt(ki))?(s=e.charAt(ki),ki++):(s=i,_i===0&&qi(fi));if(s!==i)while(s!==i)r.push(s),ai.test(e.charAt(ki))?(s=e.charAt(ki),ki++):(s=i,_i===0&&qi(fi));else r=i;if(r!==i){e.charCodeAt(ki)===46?(s=hi,ki++):(s=i,_i===0&&qi(pi));if(s!==i){o=[],ai.test(e.charAt(ki))?(u=e.charAt(ki),ki++):(u=i,_i===0&&qi(fi));if(u!==i)while(u!==i)o.push(u),ai.test(e.charAt(ki))?(u=e.charAt(ki),ki++):(u=i,_i===0&&qi(fi));else o=i;o!==i?(r=[r,s,o],n=r):(ki=n,n=i)}else ki=n,n=i}else ki=n,n=i;return n!==i&&(Li=t,n=di(n)),t=n,_i--,t===i&&(n=i,_i===0&&qi(ci)),t}function _s(){var t,n;return _i++,e.substr(ki,4).toLowerCase()===mi?(t=e.substr(ki,4),ki+=4):(t=i,_i===0&&qi(gi)),t===i&&(e.substr(ki,5).toLowerCase()===yi?(t=e.substr(ki,5),ki+=5):(t=i,_i===0&&qi(bi)),t===i&&(e.substr(ki,2).toLowerCase()===wi?(t=e.substr(ki,2),ki+=2):(t=i,_i===0&&qi(Ei)),t===i&&(e.substr(ki,3).toLowerCase()===Si?(t=e.substr(ki,3),ki+=3):(t=i,_i===0&&qi(xi))))),_i--,t===i&&(n=i,_i===0&&qi(vi)),t}function Ds(){var t,n;return _i++,t=As(),t===i&&(e.substr(ki,4).toLowerCase()===Ni?(t=e.substr(ki,4),ki+=4):(t=i,_i===0&&qi(Ci))),_i--,t===i&&(n=i,_i===0&&qi(Ti)),t}function Ps(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function Hs(e,t){return e=e?e:{},Ps(e,t),e}function Bs(e){var t={};return e[0].forEach(function(e){t=Hs(t,e)}),Hs(t,e[1])}function js(e){return["true","on","1"].indexOf(e.toLowerCase())>-1}function Fs(e,t){return t===undefined||t==="*"||e.entities.some(function(e){return e.name===t})}function Is(e,t){return"Entity '"+e+"' in arc "+"'"+t.from+" "+t.kind+" "+t.to+"' "+"is not defined."}function qs(e,t){this.name="EntityNotDefinedError",this.message=Is(e,t),!t.location||(this.location=t.location,this.location.start.line++,this.location.end.line++)}function Rs(e,t){return e||(e={},e.entities=[]),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){if(t.from&&!Fs(e,t.from))throw new qs(t.from,t);if(t.to&&!Fs(e,t.to))throw new qs(t.to,t);!t.location||delete t.location,!t.arcs||Rs(e,t)})}),e}function Us(e){return e&&e.options?!!e.options.watermark||!!e.options.width&&e.options.width==="auto":!1}function zs(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function Ws(e,t){var n=Us(e),r=zs(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:Ui},o=Ui,u="{",a={type:"literal",value:"{",description:'"{"'},f="}",l={type:"literal",value:"}",description:'"}"'},c=function(e,t){t[1]=Rs(t[1],t[2]);var n=Hs(t[0],Hs(t[1],t[2]));return n=Hs({meta:Ws(t[0],t[2])},n),e.length>0&&(n=Hs({precomment:e},n)),n},h="msc",p={type:"literal",value:"msc",description:'"msc"'},d="xu",v={type:"literal",value:"xu",description:'"xu"'},m=function(e){return{options:e}},g=function(e){return{entities:e}},y=function(e){return{arcs:e}},b=",",w={type:"literal",value:",",description:'","'},E=function(e){return e},S=";",x={type:"literal",value:";",description:'";"'},T=function(e){return Bs(e)},N="=",C={type:"literal",value:"=",description:'"="'},k=function(e,t){return t},L=function(e,t){return t.toString().toLowerCase()},A=function(e,t){return t.toString()},O=function(e,t){var n={};return e=e.toLowerCase(),"wordwraparcs"===e?n[e]=js(t):n[e]=t,n},M="hscale",_={type:"literal",value:"hscale",description:'"hscale"'},D="width",P={type:"literal",value:"width",description:'"width"'},H="arcgradient",B={type:"literal",value:"arcgradient",description:'"arcgradient"'},j="wordwraparcs",F={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},I="watermark",q={type:"literal",value:"watermark",description:'"watermark"'},R=function(e){return e},U=function(e){return e[0].push(e[1]),e[0]},z={type:"other",description:"entity"},W="[",X={type:"literal",value:"[",description:'"["'},V="]",$={type:"literal",value:"]",description:'"]"'},J=function(e,t){return t},K=function(e,t){return Hs({name:e},t)},Q=function(e){return e},G=function(e){return[e]},Y=function(e){return e[0].push(e[1][0]),e[0]},Z=function(e,t){return t},et=function(e,t){return Hs(e,t)},tt=function(e){return{kind:e}},nt=function(e,t,n){return{kind:t,from:e,to:n,location:Hi()}},rt="*",it={type:"literal",value:"*",description:'"*"'},st=function(e,t){return{kind:e,from:"*",to:t,location:Hi()}},ot=function(e,t){return{kind:t,from:e,to:"*",location:Hi()}},ut=function(e,t,n,r){return r},at=function(e,t,n,r,i){var s={kind:t,from:e,to:n,location:Hi(),arcs:i};return Hs(s,r)},ft="|||",lt={type:"literal",value:"|||",description:'"|||"'},ct="...",ht={type:"literal",value:"...",description:'"..."'},pt="---",dt={type:"literal",value:"---",description:'"---"'},vt=function(e){return e.toLowerCase()},mt={type:"other",description:"bi-directional arrow"},gt="--",yt={type:"literal",value:"--",description:'"--"'},bt="<->",wt={type:"literal",value:"<->",description:'"<->"'},Et="==",St={type:"literal",value:"==",description:'"=="'},xt="<<=>>",Tt={type:"literal",value:"<<=>>",description:'"<<=>>"'},Nt="<=>",Ct={type:"literal",value:"<=>",description:'"<=>"'},kt="..",Lt={type:"literal",value:"..",description:'".."'},At="<<>>",Ot={type:"literal",value:"<<>>",description:'"<<>>"'},Mt="::",_t={type:"literal",value:"::",description:'"::"'},Dt="<:>",Pt={type:"literal",value:"<:>",description:'"<:>"'},Ht={type:"other",description:"left to right arrow"},Bt="->",jt={type:"literal",value:"->",description:'"->"'},Ft="=>>",It={type:"literal",value:"=>>",description:'"=>>"'},qt="=>",Rt={type:"literal",value:"=>",description:'"=>"'},Ut=">>",zt={type:"literal",value:">>",description:'">>"'},Wt=":>",Xt={type:"literal",value:":>",description:'":>"'},Vt="-x",$t={type:"literal",value:"-x",description:'"-x"'},Jt={type:"other",description:"right to left arrow"},Kt="<-",Qt={type:"literal",value:"<-",description:'"<-"'},Gt="<<=",Yt={type:"literal",value:"<<=",description:'"<<="'},Zt="<=",en={type:"literal",value:"<=",description:'"<="'},tn="<<",nn={type:"literal",value:"<<",description:'"<<"'},rn="<:",sn={type:"literal",value:"<:",description:'"<:"'},on="x-",un={type:"literal",value:"x-",description:'"x-"'},an={type:"other",description:"box"},fn="note",ln={type:"literal",value:"note",description:'"note"'},cn="abox",hn={type:"literal",value:"abox",description:'"abox"'},pn="rbox",dn={type:"literal",value:"rbox",description:'"rbox"'},vn="box",mn={type:"literal",value:"box",description:'"box"'},gn={type:"other",description:"arc spanning box"},yn="alt",bn={type:"literal",value:"alt",description:'"alt"'},wn="else",En={type:"literal",value:"else",description:'"else"'},Sn="opt",xn={type:"literal",value:"opt",description:'"opt"'},Tn="break",Nn={type:"literal",value:"break",description:'"break"'},Cn="par",kn={type:"literal",value:"par",description:'"par"'},Ln="seq",An={type:"literal",value:"seq",description:'"seq"'},On="strict",Mn={type:"literal",value:"strict",description:'"strict"'},_n="neg",Dn={type:"literal",value:"neg",description:'"neg"'},Pn="critical",Hn={type:"literal",value:"critical",description:'"critical"'},Bn="ignore",jn={type:"literal",value:"ignore",description:'"ignore"'},Fn="consider",In={type:"literal",value:"consider",description:'"consider"'},qn="assert",Rn={type:"literal",value:"assert",description:'"assert"'},Un="loop",zn={type:"literal",value:"loop",description:'"loop"'},Wn="ref",Xn={type:"literal",value:"ref",description:'"ref"'},Vn="exc",$n={type:"literal",value:"exc",description:'"exc"'},Jn=function(e){return Bs(e)},Kn=function(e,t){var n={};return e=e.toLowerCase(),e=e.replace("colour","color"),n[e]=t,n},Qn={type:"other",description:"attribute name"},Gn="label",Yn={type:"literal",value:"label",description:'"label"'},Zn="idurl",er={type:"literal",value:"idurl",description:'"idurl"'},tr="id",nr={type:"literal",value:"id",description:'"id"'},rr="url",ir={type:"literal",value:"url",description:'"url"'},sr="linecolor",or={type:"literal",value:"linecolor",description:'"linecolor"'},ur="linecolour",ar={type:"literal",value:"linecolour",description:'"linecolour"'},fr="textcolor",lr={type:"literal",value:"textcolor",description:'"textcolor"'},cr="textcolour",hr={type:"literal",value:"textcolour",description:'"textcolour"'},pr="textbgcolor",dr={type:"literal",value:"textbgcolor",description:'"textbgcolor"'},vr="textbgcolour",mr={type:"literal",value:"textbgcolour",description:'"textbgcolour"'},gr="arclinecolor",yr={type:"literal",value:"arclinecolor",description:'"arclinecolor"'},br="arclinecolour",wr={type:"literal",value:"arclinecolour",description:'"arclinecolour"'},Er="arctextcolor",Sr={type:"literal",value:"arctextcolor",description:'"arctextcolor"'},xr="arctextcolour",Tr={type:"literal",value:"arctextcolour",description:'"arctextcolour"'},Nr="arctextbgcolor",Cr={type:"literal",value:"arctextbgcolor",description:'"arctextbgcolor"'},kr="arctextbgcolour",Lr={type:"literal",value:"arctextbgcolour",description:'"arctextbgcolour"'},Ar="arcskip",Or={type:"literal",value:"arcskip",description:'"arcskip"'},Mr='"',_r={type:"literal",value:'"',description:'"\\""'},Dr=function(e){return e.join("")},Pr='\\"',Hr={type:"literal",value:'\\"',description:'"\\\\\\""'},Br={type:"any",description:"any character"},jr=function(e){return e},Fr={type:"other",description:"identifier"},Ir=/^[A-Za-z_0-9]/,qr={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},Rr=function(e){return e.join("")},Ur={type:"other",description:"whitespace"},zr=/^[ \t]/,Wr={type:"class",value:"[ \\t]",description:"[ \\t]"},Xr={type:"other",description:"lineend"},Vr=/^[\r\n]/,$r={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},Jr="/*",Kr={type:"literal",value:"/*",description:'"/*"'},Qr="*/",Gr={type:"literal",value:"*/",description:'"*/"'},Yr=function(e,t,n){return e+t.join("")+n},Zr="//",ei={type:"literal",value:"//",description:'"//"'},ti="#",ni={type:"literal",value:"#",description:'"#"'},ri=/^[^\r\n]/,ii={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},si=function(e,t){return e+t.join("")},oi={type:"other",description:"comment"},ui={type:"other",description:"integer"},ai=/^[0-9]/,fi={type:"class",value:"[0-9]",description:"[0-9]"},li=function(e){return parseInt(e.join(""),10)},ci={type:"other",description:"real"},hi=".",pi={type:"literal",value:".",description:'"."'},di=function(e){return parseFloat(e.join(""))},vi={type:"other",description:"boolean"},mi="true",gi={type:"literal",value:"true",description:'"true"'},yi="false",bi={type:"literal",value:"false",description:'"false"'},wi="on",Ei={type:"literal",value:"on",description:'"on"'},Si="off",xi={type:"literal",value:"off",description:'"off"'},Ti={type:"other",description:"size"},Ni="auto",Ci={type:"literal",value:"auto",description:'"auto"'},ki=0,Li=0,Ai=[{line:1,column:1,seenCR:!1}],Oi=0,Mi=[],_i=0,Di;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Di=o();if(Di!==i&&ki===e.length)return Di;throw Di!==i&&ki<e.length&&qi({type:"end",description:"end of input"}),Ri(null,Mi,Oi<e.length?e.charAt(Oi):null,Oi<e.length?Ii(Oi,Oi+1):Ii(Oi,Oi))}return e(t,Error),{SyntaxError:t,parse:n}}),n("lib/mscgenjs-core/parse/msgennyparser",[],function(){"use strict";function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}function n(e){function Zr(){return e.substring($r,Vr)}function ei(){return ii($r,Vr)}function ti(t){throw oi(null,[{type:"other",description:t}],e.substring($r,Vr),ii($r,Vr))}function ni(t){throw oi(t,null,e.substring($r,Vr),ii($r,Vr))}function ri(t){var n=Jr[t],r,i;if(n)return n;r=t-1;while(!Jr[r])r--;n=Jr[r],n={line:n.line,column:n.column,seenCR:n.seenCR};while(r<t)i=e.charAt(r),i==="\n"?(n.seenCR||n.line++,n.column=1,n.seenCR=!1):i==="\r"||i==="\u2028"||i==="\u2029"?(n.line++,n.column=1,n.seenCR=!0):(n.column++,n.seenCR=!1),r++;return Jr[t]=n,n}function ii(e,t){var n=ri(e),r=ri(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function si(e){if(Vr<Kr)return;Vr>Kr&&(Kr=Vr,Qr=[]),Qr.push(e)}function oi(e,n,r,i){function s(e){var t=1;e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});while(t<e.length)e[t-1]===e[t]?e.splice(t,1):t++}function o(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var r=new Array(e.length),i,s,o;for(o=0;o<e.length;o++)r[o]=e[o].description;return i=e.length>1?r.slice(0,-1).join(", ")+" or "+r[e.length-1]:r[0],s=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+s+" found."}return n!==null&&s(n),new t(e!==null?e:o(n,r),n,r,i)}function ui(){var e,t,n,r;return e=Vr,t=Vi(),t!==i?(n=ai(),n!==i?(r=Vi(),r!==i?($r=e,t=u(t,n),e=t):(Vr=e,e=i)):(Vr=e,e=i)):(Vr=e,e=i),e}function ai(){var e,t,n,r,s;return e=Vr,t=Vr,n=fi(),n!==i&&($r=t,n=a(n)),t=n,t===i&&(t=null),t!==i?(n=Vr,r=hi(),r!==i&&($r=n,r=f(r)),n=r,n===i&&(n=null),n!==i?(r=Vr,s=di(),s!==i&&($r=r,s=l(s)),r=s,r===i&&(r=null),r!==i?(t=[t,n,r],e=t):(Vr=e,e=i)):(Vr=e,e=i)):(Vr=e,e=i),e}function fi(){var t,n,r,s,o,u;t=Vr,n=Vr,r=[],s=Vr,o=li(),o!==i?(e.charCodeAt(Vr)===44?(u=c,Vr++):(u=i,Gr===0&&si(h)),u!==i?($r=s,o=p(o),s=o):(Vr=s,s=i)):(Vr=s,s=i);while(s!==i)r.push(s),s=Vr,o=li(),o!==i?(e.charCodeAt(Vr)===44?(u=c,Vr++):(u=i,Gr===0&&si(h)),u!==i?($r=s,o=p(o),s=o):(Vr=s,s=i)):(Vr=s,s=i);return r!==i?(s=Vr,o=li(),o!==i?(e.charCodeAt(Vr)===59?(u=d,Vr++):(u=i,Gr===0&&si(v)),u!==i?($r=s,o=p(o),s=o):(Vr=s,s=i)):(Vr=s,s=i),s!==i?(r=[r,s],n=r):(Vr=n,n=i)):(Vr=n,n=i),n!==i&&($r=t,n=m(n)),t=n,t}function li(){var t,n,r,s,o,u,a,f;return t=Vr,n=Vi(),n!==i?(r=ci(),r!==i?(s=Vi(),s!==i?(e.charCodeAt(Vr)===61?(o=g,Vr++):(o=i,Gr===0&&si(y)),o!==i?(u=Vi(),u!==i?(a=Vr,f=Mi(),f!==i&&($r=a,f=b(r,f)),a=f,a===i&&(a=Vr,f=Gi(),f!==i&&($r=a,f=w(r,f)),a=f,a===i&&(a=Vr,f=Qi(),f!==i&&($r=a,f=E(r,f)),a=f)),a!==i?(f=Vi(),f!==i?($r=t,n=S(r,a),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),t}function ci(){var t;return e.substr(Vr,6).toLowerCase()===x?(t=e.substr(Vr,6),Vr+=6):(t=i,Gr===0&&si(T)),t===i&&(e.substr(Vr,5).toLowerCase()===N?(t=e.substr(Vr,5),Vr+=5):(t=i,Gr===0&&si(C)),t===i&&(e.substr(Vr,11).toLowerCase()===k?(t=e.substr(Vr,11),Vr+=11):(t=i,Gr===0&&si(L)),t===i&&(e.substr(Vr,12).toLowerCase()===A?(t=e.substr(Vr,12),Vr+=12):(t=i,Gr===0&&si(O)),t===i&&(e.substr(Vr,9).toLowerCase()===M?(t=e.substr(Vr,9),Vr+=9):(t=i,Gr===0&&si(_)))))),t}function hi(){var t,n,r,s,o,u;t=Vr,n=Vr,r=[],s=Vr,o=pi(),o!==i?(e.charCodeAt(Vr)===44?(u=c,Vr++):(u=i,Gr===0&&si(h)),u!==i?($r=s,o=D(o),s=o):(Vr=s,s=i)):(Vr=s,s=i);while(s!==i)r.push(s),s=Vr,o=pi(),o!==i?(e.charCodeAt(Vr)===44?(u=c,Vr++):(u=i,Gr===0&&si(h)),u!==i?($r=s,o=D(o),s=o):(Vr=s,s=i)):(Vr=s,s=i);return r!==i?(s=Vr,o=pi(),o!==i?(e.charCodeAt(Vr)===59?(u=d,Vr++):(u=i,Gr===0&&si(v)),u!==i?($r=s,o=D(o),s=o):(Vr=s,s=i)):(Vr=s,s=i),s!==i?(r=[r,s],n=r):(Vr=n,n=i)):(Vr=n,n=i),n!==i&&($r=t,n=P(n)),t=n,t}function pi(){var t,n,r,s,o,u,a,f,l;return Gr++,t=Vr,n=Vi(),n!==i?(r=Hi(),r!==i?(s=Vi(),s!==i?(o=Vr,e.charCodeAt(Vr)===58?(u=B,Vr++):(u=i,Gr===0&&si(j)),u!==i?(a=Vi(),a!==i?(f=Oi(),f!==i?(l=Vi(),l!==i?($r=o,u=F(r,f),o=u):(Vr=o,o=i)):(Vr=o,o=i)):(Vr=o,o=i)):(Vr=o,o=i),o===i&&(o=null),o!==i?($r=t,n=I(r,o),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),Gr--,t===i&&(n=i,Gr===0&&si(H)),t}function di(){var t,n,r,s,o;t=[],n=Vr,r=vi(),r!==i?(s=Vi(),s!==i?(e.charCodeAt(Vr)===59?(o=d,Vr++):(o=i,Gr===0&&si(v)),o!==i?($r=n,r=q(r),n=r):(Vr=n,n=i)):(Vr=n,n=i)):(Vr=n,n=i);if(n!==i)while(n!==i)t.push(n),n=Vr,r=vi(),r!==i?(s=Vi(),s!==i?(e.charCodeAt(Vr)===59?(o=d,Vr++):(o=i,Gr===0&&si(v)),o!==i?($r=n,r=q(r),n=r):(Vr=n,n=i)):(Vr=n,n=i)):(Vr=n,n=i);else t=i;return t}function vi(){var t,n,r,s,o,u;t=Vr,n=Vr,r=[],s=Vr,o=mi(),o!==i?(e.charCodeAt(Vr)===44?(u=c,Vr++):(u=i,Gr===0&&si(h)),u!==i?($r=s,o=q(o),s=o):(Vr=s,s=i)):(Vr=s,s=i);while(s!==i)r.push(s),s=Vr,o=mi(),o!==i?(e.charCodeAt(Vr)===44?(u=c,Vr++):(u=i,Gr===0&&si(h)),u!==i?($r=s,o=q(o),s=o):(Vr=s,s=i)):(Vr=s,s=i);return r!==i?(s=Vr,o=mi(),o!==i&&($r=s,o=R(o)),s=o,s!==i?(r=[r,s],n=r):(Vr=n,n=i)):(Vr=n,n=i),n!==i&&($r=t,n=U(n)),t=n,t}function mi(){var e;return e=gi(),e===i&&(e=Ei()),e}function gi(){var t,n,r,s,o,u,a;return t=Vr,n=Vr,r=yi(),r!==i&&($r=n,r=z(r)),n=r,n===i&&(n=Vr,r=wi(),r!==i&&($r=n,r=W(r)),n=r,n===i&&(n=Vr,r=bi(),r!==i&&($r=n,r=X(r)),n=r)),n!==i?(r=Vr,e.charCodeAt(Vr)===58?(s=B,Vr++):(s=i,Gr===0&&si(j)),s!==i?(o=Vi(),o!==i?(u=Oi(),u!==i?(a=Vi(),a!==i?($r=r,s=V(n,u),r=s):(Vr=r,r=i)):(Vr=r,r=i)):(Vr=r,r=i)):(Vr=r,r=i),r===i&&(r=null),r!==i?($r=t,n=$(n,r),t=n):(Vr=t,t=i)):(Vr=t,t=i),t}function yi(){var e,t,n,r;return e=Vr,t=Vi(),t!==i?(n=Si(),n!==i?(r=Vi(),r!==i?($r=e,t=J(n),e=t):(Vr=e,e=i)):(Vr=e,e=i)):(Vr=e,e=i),e}function bi(){var e,t,n,r;return e=Vr,t=Vi(),t!==i?(n=xi(),n!==i?(r=Vi(),r!==i?($r=e,t=J(n),e=t):(Vr=e,e=i)):(Vr=e,e=i)):(Vr=e,e=i),e}function wi(){var t,n,r,s,o,u,a,f;return t=Vr,n=Vi(),n!==i?(r=Hi(),r!==i?(s=Vi(),s!==i?(o=Ti(),o!==i?(u=Vi(),u!==i?(a=Hi(),a!==i?(f=Vi(),f!==i?($r=t,n=K(r,o,a),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),t===i&&(t=Vr,n=Vi(),n!==i?(e.charCodeAt(Vr)===42?(r=Q,Vr++):(r=i,Gr===0&&si(G)),r!==i?(s=Vi(),s!==i?(o=ki(),o!==i?(u=Vi(),u!==i?(a=Hi(),a!==i?(f=Vi(),f!==i?($r=t,n=Y(o,a),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),t===i&&(t=Vr,n=Vi(),n!==i?(r=Hi(),r!==i?(s=Vi(),s!==i?(o=Ci(),o!==i?(u=Vi(),u!==i?(e.charCodeAt(Vr)===42?(a=Q,Vr++):(a=i,Gr===0&&si(G)),a!==i?(f=Vi(),f!==i?($r=t,n=Z(r,o),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),t===i&&(t=Vr,n=Vi(),n!==i?(r=Hi(),r!==i?(s=Vi(),s!==i?(o=Ni(),o!==i?(u=Vi(),u!==i?(e.charCodeAt(Vr)===42?(a=Q,Vr++):(a=i,Gr===0&&si(G)),a!==i?(f=Vi(),f!==i?($r=t,n=Z(r,o),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)))),t}function Ei(){var t,n,r,s,o,u,a,f,l,c,h,p,d,v,m;return t=Vr,n=Vi(),n!==i?(r=Hi(),r!==i?(s=Vi(),s!==i?(o=Ai(),o!==i?(u=Vi(),u!==i?(a=Hi(),a!==i?(f=Vi(),f!==i?(l=Vr,e.charCodeAt(Vr)===58?(c=B,Vr++):(c=i,Gr===0&&si(j)),c!==i?(h=Vi(),h!==i?(p=Oi(),p!==i?(d=Vi(),d!==i?($r=l,c=et(r,o,a,p),l=c):(Vr=l,l=i)):(Vr=l,l=i)):(Vr=l,l=i)):(Vr=l,l=i),l===i&&(l=null),l!==i?(e.charCodeAt(Vr)===123?(c=tt,Vr++):(c=i,Gr===0&&si(nt)),c!==i?(h=Vi(),h!==i?(p=di(),p===i&&(p=null),p!==i?(d=Vi(),d!==i?(e.charCodeAt(Vr)===125?(v=rt,Vr++):(v=i,Gr===0&&si(it)),v!==i?(m=Vi(),m!==i?($r=t,n=st(r,o,a,l,p),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),t}function Si(){var t;return e.substr(Vr,3)===ot?(t=ot,Vr+=3):(t=i,Gr===0&&si(ut)),t===i&&(e.substr(Vr,3)===at?(t=at,Vr+=3):(t=i,Gr===0&&si(ft))),t}function xi(){var t;return e.substr(Vr,3)===lt?(t=lt,Vr+=3):(t=i,Gr===0&&si(ct)),t}function Ti(){var e,t;return e=Vr,t=Ni(),t===i&&(t=Ci(),t===i&&(t=ki(),t===i&&(t=Li()))),t!==i&&($r=e,t=ht(t)),e=t,e}function Ni(){var t,n;return Gr++,e.substr(Vr,2)===dt?(t=dt,Vr+=2):(t=i,Gr===0&&si(vt)),t===i&&(e.substr(Vr,3)===mt?(t=mt,Vr+=3):(t=i,Gr===0&&si(gt)),t===i&&(e.substr(Vr,2)===yt?(t=yt,Vr+=2):(t=i,Gr===0&&si(bt)),t===i&&(e.substr(Vr,5)===wt?(t=wt,Vr+=5):(t=i,Gr===0&&si(Et)),t===i&&(e.substr(Vr,3)===St?(t=St,Vr+=3):(t=i,Gr===0&&si(xt)),t===i&&(e.substr(Vr,2)===Tt?(t=Tt,Vr+=2):(t=i,Gr===0&&si(Nt)),t===i&&(e.substr(Vr,4)===Ct?(t=Ct,Vr+=4):(t=i,Gr===0&&si(kt)),t===i&&(e.substr(Vr,2)===Lt?(t=Lt,Vr+=2):(t=i,Gr===0&&si(At)),t===i&&(e.substr(Vr,3)===Ot?(t=Ot,Vr+=3):(t=i,Gr===0&&si(Mt)))))))))),Gr--,t===i&&(n=i,Gr===0&&si(pt)),t}function Ci(){var t,n;return Gr++,e.substr(Vr,2)===Dt?(t=Dt,Vr+=2):(t=i,Gr===0&&si(Pt)),t===i&&(e.substr(Vr,3)===Ht?(t=Ht,Vr+=3):(t=i,Gr===0&&si(Bt)),t===i&&(e.substr(Vr,2)===jt?(t=jt,Vr+=2):(t=i,Gr===0&&si(Ft)),t===i&&(e.substr(Vr,2)===It?(t=It,Vr+=2):(t=i,Gr===0&&si(qt)),t===i&&(e.substr(Vr,2)===Rt?(t=Rt,Vr+=2):(t=i,Gr===0&&si(Ut)),t===i&&(e.substr(Vr,2).toLowerCase()===zt?(t=e.substr(Vr,2),Vr+=2):(t=i,Gr===0&&si(Wt))))))),Gr--,t===i&&(n=i,Gr===0&&si(_t)),t}function ki(){var t,n;return Gr++,e.substr(Vr,2)===Vt?(t=Vt,Vr+=2):(t=i,Gr===0&&si($t)),t===i&&(e.substr(Vr,3)===Jt?(t=Jt,Vr+=3):(t=i,Gr===0&&si(Kt)),t===i&&(e.substr(Vr,2)===Qt?(t=Qt,Vr+=2):(t=i,Gr===0&&si(Gt)),t===i&&(e.substr(Vr,2)===Yt?(t=Yt,Vr+=2):(t=i,Gr===0&&si(Zt)),t===i&&(e.substr(Vr,2)===en?(t=en,Vr+=2):(t=i,Gr===0&&si(tn)),t===i&&(e.substr(Vr,2).toLowerCase()===nn?(t=e.substr(Vr,2),Vr+=2):(t=i,Gr===0&&si(rn))))))),Gr--,t===i&&(n=i,Gr===0&&si(Xt)),t}function Li(){var t,n;return Gr++,e.substr(Vr,4).toLowerCase()===on?(t=e.substr(Vr,4),Vr+=4):(t=i,Gr===0&&si(un)),t===i&&(e.substr(Vr,4).toLowerCase()===an?(t=e.substr(Vr,4),Vr+=4):(t=i,Gr===0&&si(fn)),t===i&&(e.substr(Vr,4).toLowerCase()===ln?(t=e.substr(Vr,4),Vr+=4):(t=i,Gr===0&&si(cn)),t===i&&(e.substr(Vr,3).toLowerCase()===hn?(t=e.substr(Vr,3),Vr+=3):(t=i,Gr===0&&si(pn))))),Gr--,t===i&&(n=i,Gr===0&&si(sn)),t}function Ai(){var t,n;return Gr++,t=Vr,e.substr(Vr,3).toLowerCase()===vn?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(mn)),n===i&&(e.substr(Vr,4).toLowerCase()===gn?(n=e.substr(Vr,4),Vr+=4):(n=i,Gr===0&&si(yn)),n===i&&(e.substr(Vr,3).toLowerCase()===bn?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(wn)),n===i&&(e.substr(Vr,5).toLowerCase()===En?(n=e.substr(Vr,5),Vr+=5):(n=i,Gr===0&&si(Sn)),n===i&&(e.substr(Vr,3).toLowerCase()===xn?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(Tn)),n===i&&(e.substr(Vr,3).toLowerCase()===Nn?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(Cn)),n===i&&(e.substr(Vr,6).toLowerCase()===kn?(n=e.substr(Vr,6),Vr+=6):(n=i,Gr===0&&si(Ln)),n===i&&(e.substr(Vr,3).toLowerCase()===An?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(On)),n===i&&(e.substr(Vr,8).toLowerCase()===Mn?(n=e.substr(Vr,8),Vr+=8):(n=i,Gr===0&&si(_n)),n===i&&(e.substr(Vr,6).toLowerCase()===Dn?(n=e.substr(Vr,6),Vr+=6):(n=i,Gr===0&&si(Pn)),n===i&&(e.substr(Vr,8).toLowerCase()===Hn?(n=e.substr(Vr,8),Vr+=8):(n=i,Gr===0&&si(Bn)),n===i&&(e.substr(Vr,6).toLowerCase()===jn?(n=e.substr(Vr,6),Vr+=6):(n=i,Gr===0&&si(Fn)),n===i&&(e.substr(Vr,4).toLowerCase()===In?(n=e.substr(Vr,4),Vr+=4):(n=i,Gr===0&&si(qn)),n===i&&(e.substr(Vr,3).toLowerCase()===Rn?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(Un)),n===i&&(e.substr(Vr,3).toLowerCase()===zn?(n=e.substr(Vr,3),Vr+=3):(n=i,Gr===0&&si(Wn)))))))))))))))),n!==i&&($r=t,n=ht(n)),t=n,Gr--,t===i&&(n=i,Gr===0&&si(dn)),t}function Oi(){var e;return e=Mi(),e===i&&(e=Di()),e}function Mi(){var t,n,r,s;return t=Vr,e.charCodeAt(Vr)===34?(n=Xn,Vr++):(n=i,Gr===0&&si(Vn)),n!==i?(r=_i(),r!==i?(e.charCodeAt(Vr)===34?(s=Xn,Vr++):(s=i,Gr===0&&si(Vn)),s!==i?($r=t,n=$n(r),t=n):(Vr=t,t=i)):(Vr=t,t=i)):(Vr=t,t=i),t}function _i(){var t,n,r,s;t=[],n=Vr,r=Vr,Gr++,e.charCodeAt(Vr)===34?(s=Xn,Vr++):(s=i,Gr===0&&si(Vn)),Gr--,s===i?r=void 0:(Vr=r,r=i),r!==i?(e.substr(Vr,2)===Jn?(s=Jn,Vr+=2):(s=i,Gr===0&&si(Kn)),s===i&&(e.length>Vr?(s=e.charAt(Vr),Vr++):(s=i,Gr===0&&si(Qn))),s!==i?($r=n,r=Gn(s),n=r):(Vr=n,n=i)):(Vr=n,n=i);while(n!==i)t.push(n),n=Vr,r=Vr,Gr++,e.charCodeAt(Vr)===34?(s=Xn,Vr++):(s=i,Gr===0&&si(Vn)),Gr--,s===i?r=void 0:(Vr=r,r=i),r!==i?(e.substr(Vr,2)===Jn?(s=Jn,Vr+=2):(s=i,Gr===0&&si(Kn)),s===i&&(e.length>Vr?(s=e.charAt(Vr),Vr++):(s=i,Gr===0&&si(Qn))),s!==i?($r=n,r=Gn(s),n=r):(Vr=n,n=i)):(Vr=n,n=i);return t}function Di(){var e,t;return e=Vr,t=Pi(),t!==i&&($r=e,t=Yn(t)),e=t,e}function Pi(){var t,n,r,s;t=[],n=Vr,r=Vr,Gr++,e.charCodeAt(Vr)===44?(s=c,Vr++):(s=i,Gr===0&&si(h)),s===i&&(e.charCodeAt(Vr)===59?(s=d,Vr++):(s=i,Gr===0&&si(v)),s===i&&(e.charCodeAt(Vr)===123?(s=tt,Vr++):(s=i,Gr===0&&si(nt)))),Gr--,s===i?r=void 0:(Vr=r,r=i),r!==i?(e.length>Vr?(s=e.charAt(Vr),Vr++):(s=i,Gr===0&&si(Qn)),s!==i?($r=n,r=Gn(s),n=r):(Vr=n,n=i)):(Vr=n,n=i);while(n!==i)t.push(n),n=Vr,r=Vr,Gr++,e.charCodeAt(Vr)===44?(s=c,Vr++):(s=i,Gr===0&&si(h)),s===i&&(e.charCodeAt(Vr)===59?(s=d,Vr++):(s=i,Gr===0&&si(v)),s===i&&(e.charCodeAt(Vr)===123?(s=tt,Vr++):(s=i,Gr===0&&si(nt)))),Gr--,s===i?r=void 0:(Vr=r,r=i),r!==i?(e.length>Vr?(s=e.charAt(Vr),Vr++):(s=i,Gr===0&&si(Qn)),s!==i?($r=n,r=Gn(s),n=r):(Vr=n,n=i)):(Vr=n,n=i);return t}function Hi(){var t,n,r;Gr++,t=Vr,n=[],er.test(e.charAt(Vr))?(r=e.charAt(Vr),Vr++):(r=i,Gr===0&&si(tr));if(r!==i)while(r!==i)n.push(r),er.test(e.charAt(Vr))?(r=e.charAt(Vr),Vr++):(r=i,Gr===0&&si(tr));else n=i;return n!==i&&($r=t,n=nr(n)),t=n,t===i&&(t=Mi()),Gr--,t===i&&(n=i,Gr===0&&si(Zn)),t}function Bi(){var t,n;return Gr++,t=Vr,ir.test(e.charAt(Vr))?(n=e.charAt(Vr),Vr++):(n=i,Gr===0&&si(sr)),n!==i&&($r=t,n=Gn(n)),t=n,Gr--,t===i&&(n=i,Gr===0&&si(rr)),t}function ji(){var t,n;return Gr++,t=Vr,ur.test(e.charAt(Vr))?(n=e.charAt(Vr),Vr++):(n=i,Gr===0&&si(ar)),n!==i&&($r=t,n=Gn(n)),t=n,Gr--,t===i&&(n=i,Gr===0&&si(or)),t}function Fi(){var t;return e.substr(Vr,2)===fr?(t=fr,Vr+=2):(t=i,Gr===0&&si(lr)),t}function Ii(){var t;return e.substr(Vr,2)===cr?(t=cr,Vr+=2):(t=i,Gr===0&&si(hr)),t}function qi(){var t,n,r;return t=Vr,n=Vr,Gr++,e.substr(Vr,2)===cr?(r=cr,Vr+=2):(r=i,Gr===0&&si(hr)),Gr--,r===i?n=void 0:(Vr=n,n=i),n!==i?(e.length>Vr?(r=e.charAt(Vr),Vr++):(r=i,Gr===0&&si(Qn)),r!==i?($r=t,n=Gn(r),t=n):(Vr=t,t=i)):(Vr=t,t=i),t}function Ri(){var e,t,n,r;e=Vr,t=Fi();if(t!==i){n=[],r=qi();while(r!==i)n.push(r),r=qi();n!==i?(r=Ii(),r!==i?($r=e,t=pr(t,n,r),e=t):(Vr=e,e=i)):(Vr=e,e=i)}else Vr=e,e=i;return e}function Ui(){var t;return e.substr(Vr,2)===dr?(t=dr,Vr+=2):(t=i,Gr===0&&si(vr)),t===i&&(e.charCodeAt(Vr)===35?(t=mr,Vr++):(t=i,Gr===0&&si(gr))),t}function zi(){var t;return yr.test(e.charAt(Vr))?(t=e.charAt(Vr),Vr++):(t=i,Gr===0&&si(br)),t}function Wi(){var e,t,n,r;e=Vr,t=Ui();if(t!==i){n=[],r=zi();while(r!==i)n.push(r),r=zi();n!==i?($r=e,t=wr(t,n),e=t):(Vr=e,e=i)}else Vr=e,e=i;return e}function Xi(){var e,t;return Gr++,e=Wi(),e===i&&(e=Ri()),Gr--,e===i&&(t=i,Gr===0&&si(Er)),e}function Vi(){var e,t;e=[],t=Bi(),t===i&&(t=ji(),t===i&&(t=Xi()));while(t!==i)e.push(t),t=Bi(),t===i&&(t=ji(),t===i&&(t=Xi()));return e}function $i(){var e;return e=Ki(),e===i&&(e=Ji()),e}function Ji(){var t,n,r;Gr++,t=Vr,n=[],xr.test(e.charAt(Vr))?(r=e.charAt(Vr),Vr++):(r=i,Gr===0&&si(Tr));if(r!==i)while(r!==i)n.push(r),xr.test(e.charAt(Vr))?(r=e.charAt(Vr),Vr++):(r=i,Gr===0&&si(Tr));else n=i;return n!==i&&($r=t,n=Nr(n)),t=n,Gr--,t===i&&(n=i,Gr===0&&si(Sr)),t}function Ki(){var t,n,r,s,o,u;Gr++,t=Vr,n=Vr,r=[],xr.test(e.charAt(Vr))?(s=e.charAt(Vr),Vr++):(s=i,Gr===0&&si(Tr));if(s!==i)while(s!==i)r.push(s),xr.test(e.charAt(Vr))?(s=e.charAt(Vr),Vr++):(s=i,Gr===0&&si(Tr));else r=i;if(r!==i){e.charCodeAt(Vr)===46?(s=kr,Vr++):(s=i,Gr===0&&si(Lr));if(s!==i){o=[],xr.test(e.charAt(Vr))?(u=e.charAt(Vr),Vr++):(u=i,Gr===0&&si(Tr));if(u!==i)while(u!==i)o.push(u),xr.test(e.charAt(Vr))?(u=e.charAt(Vr),Vr++):(u=i,Gr===0&&si(Tr));else o=i;o!==i?(r=[r,s,o],n=r):(Vr=n,n=i)}else Vr=n,n=i}else Vr=n,n=i;return n!==i&&($r=t,n=Ar(n)),t=n,Gr--,t===i&&(n=i,Gr===0&&si(Cr)),t}function Qi(){var t,n;return Gr++,e.substr(Vr,4).toLowerCase()===Mr?(t=e.substr(Vr,4),Vr+=4):(t=i,Gr===0&&si(_r)),t===i&&(e.substr(Vr,5).toLowerCase()===Dr?(t=e.substr(Vr,5),Vr+=5):(t=i,Gr===0&&si(Pr)),t===i&&(e.substr(Vr,2).toLowerCase()===Hr?(t=e.substr(Vr,2),Vr+=2):(t=i,Gr===0&&si(Br)),t===i&&(e.substr(Vr,3).toLowerCase()===jr?(t=e.substr(Vr,3),Vr+=3):(t=i,Gr===0&&si(Fr)),t===i&&(e.charCodeAt(Vr)===49?(t=Ir,Vr++):(t=i,Gr===0&&si(qr)),t===i&&(e.charCodeAt(Vr)===48?(t=Rr,Vr++):(t=i,Gr===0&&si(Ur))))))),Gr--,t===i&&(n=i,Gr===0&&si(Or)),t}function Gi(){var t,n;return Gr++,t=$i(),t===i&&(e.substr(Vr,4).toLowerCase()===Wr?(t=e.substr(Vr,4),Vr+=4):(t=i,Gr===0&&si(Xr))),Gr--,t===i&&(n=i,Gr===0&&si(zr)),t}function Yi(e,t){t&&Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}function Zi(e,t){return e=e?e:{},Yi(e,t),e}function es(e){var t={};return e[0].forEach(function(e){t=Zi(t,e)}),Zi(t,e[1])}function ts(e){return["true","on","1"].indexOf(e.toLowerCase())>-1}function ns(e,t,n){return t===undefined||t==="*"?!0:e.entities.some(function(e){return e.name===t})?!0:n[t]===!0}function rs(e){var t={};return t.name=e,t}function is(e,t,n){return e||(e={},e.entities=[]),n||(n={}),t&&t.arcs&&t.arcs.forEach(function(t){t.forEach(function(t){ns(e,t.from,n)||(e.entities[e.entities.length]=rs(t.from)),t.arcs&&(n[t.to]=!0,Zi(e,is(e,t,n)),delete n[t.to]),ns(e,t.to,n)||(e.entities[e.entities.length]=rs(t.to))})}),e}function ss(e){return e&&e.options?!!e.options.watermark||!!e.options.width&&e.options.width==="auto":!1}function os(e){return e&&e.arcs?e.arcs.some(function(e){return e.some(function(e){return["alt","else","opt","break","par","seq","strict","neg","critical","ignore","consider","assert","loop","ref","exc"].indexOf(e.kind)>-1})}):!1}function us(e,t){var n=ss(e),r=os(t);return{extendedOptions:n,extendedArcTypes:r,extendedFeatures:n||r}}var n=arguments.length>1?arguments[1]:{},r=this,i={},s={program:ui},o=ui,u=function(e,t){t[1]=is(t[1],t[2]);var n=Zi(t[0],Zi(t[1],t[2]));return n=Zi({meta:us(t[0],t[2])},n),e.length>0&&(n=Zi({precomment:e},n)),n},a=function(e){return{options:e}},f=function(e){return{entities:e}},l=function(e){return{arcs:e}},c=",",h={type:"literal",value:",",description:'","'},p=function(e){return e},d=";",v={type:"literal",value:";",description:'";"'},m=function(e){return es(e)},g="=",y={type:"literal",value:"=",description:'"="'},b=function(e,t){return t},w=function(e,t){return t.toString().toLowerCase()},E=function(e,t){return t.toString()},S=function(e,t){var n={};return e=e.toLowerCase(),"wordwraparcs"===e?n[e]=ts(t):n[e]=t,n},x="hscale",T={type:"literal",value:"hscale",description:'"hscale"'},N="width",C={type:"literal",value:"width",description:'"width"'},k="arcgradient",L={type:"literal",value:"arcgradient",description:'"arcgradient"'},A="wordwraparcs",O={type:"literal",value:"wordwraparcs",description:'"wordwraparcs"'},M="watermark",_={type:"literal",value:"watermark",description:'"watermark"'},D=function(e){return e},P=function(e){return e[0].push(e[1]),e[0]},H={type:"other",description:"entity"},B=":",j={type:"literal",value:":",description:'":"'},F=function(e,t){return t},I=function(e,t){var n={};return n.name=e,!t||(n.label=t),n},q=function(e){return e},R=function(e){return[e]},U=function(e){return e[0].push(e[1][0]),e[0]},z=function(e){return e},W=function(e){return e},X=function(e){return e},V=function(e,t){return t},$=function(e,t){return t&&(e.label=t),e},J=function(e){return{kind:e}},K=function(e,t,n){return{kind:t,from:e,to:n}},Q="*",G={type:"literal",value:"*",description:'"*"'},Y=function(e,t){return{kind:e,from:"*",to:t}},Z=function(e,t){return{kind:t,from:e,to:"*"}},et=function(e,t,n,r){return r},tt="{",nt={type:"literal",value:"{",description:'"{"'},rt="}",it={type:"literal",value:"}",description:'"}"'},st=function(e,t,n,r,i){var s={kind:t,from:e,to:n,arcs:i};return r&&(s.label=r),s},ot="|||",ut={type:"literal",value:"|||",description:'"|||"'},at="...",ft={type:"literal",value:"...",description:'"..."'},lt="---",ct={type:"literal",value:"---",description:'"---"'},ht=function(e){return e.toLowerCase()},pt={type:"other",description:"bi-directional arrow"},dt="--",vt={type:"literal",value:"--",description:'"--"'},mt="<->",gt={type:"literal",value:"<->",description:'"<->"'},yt="==",bt={type:"literal",value:"==",description:'"=="'},wt="<<=>>",Et={type:"literal",value:"<<=>>",description:'"<<=>>"'},St="<=>",xt={type:"literal",value:"<=>",description:'"<=>"'},Tt="..",Nt={type:"literal",value:"..",description:'".."'},Ct="<<>>",kt={type:"literal",value:"<<>>",description:'"<<>>"'},Lt="::",At={type:"literal",value:"::",description:'"::"'},Ot="<:>",Mt={type:"literal",value:"<:>",description:'"<:>"'},_t={type:"other",description:"left to right arrow"},Dt="->",Pt={type:"literal",value:"->",description:'"->"'},Ht="=>>",Bt={type:"literal",value:"=>>",description:'"=>>"'},jt="=>",Ft={type:"literal",value:"=>",description:'"=>"'},It=">>",qt={type:"literal",value:">>",description:'">>"'},Rt=":>",Ut={type:"literal",value:":>",description:'":>"'},zt="-x",Wt={type:"literal",value:"-x",description:'"-x"'},Xt={type:"other",description:"right to left arrow"},Vt="<-",$t={type:"literal",value:"<-",description:'"<-"'},Jt="<<=",Kt={type:"literal",value:"<<=",description:'"<<="'},Qt="<=",Gt={type:"literal",value:"<=",description:'"<="'},Yt="<<",Zt={type:"literal",value:"<<",description:'"<<"'},en="<:",tn={type:"literal",value:"<:",description:'"<:"'},nn="x-",rn={type:"literal",value:"x-",description:'"x-"'},sn={type:"other",description:"box"},on="note",un={type:"literal",value:"note",description:'"note"'},an="abox",fn={type:"literal",value:"abox",description:'"abox"'},ln="rbox",cn={type:"literal",value:"rbox",description:'"rbox"'},hn="box",pn={type:"literal",value:"box",description:'"box"'},dn={type:"other",description:"arc spanning box"},vn="alt",mn={type:"literal",value:"alt",description:'"alt"'},gn="else",yn={type:"literal",value:"else",description:'"else"'},bn="opt",wn={type:"literal",value:"opt",description:'"opt"'},En="break",Sn={type:"literal",value:"break",description:'"break"'},xn="par",Tn={type:"literal",value:"par",description:'"par"'},Nn="seq",Cn={type:"literal",value:"seq",description:'"seq"'},kn="strict",Ln={type:"literal",value:"strict",description:'"strict"'},An="neg",On={type:"literal",value:"neg",description:'"neg"'},Mn="critical",_n={type:"literal",value:"critical",description:'"critical"'},Dn="ignore",Pn={type:"literal",value:"ignore",description:'"ignore"'},Hn="consider",Bn={type:"literal",value:"consider",description:'"consider"'},jn="assert",Fn={type:"literal",value:"assert",description:'"assert"'},In="loop",qn={type:"literal",value:"loop",description:'"loop"'},Rn="ref",Un={type:"literal",value:"ref",description:'"ref"'},zn="exc",Wn={type:"literal",value:"exc",description:'"exc"'},Xn='"',Vn={type:"literal",value:'"',description:'"\\""'},$n=function(e){return e.join("")},Jn='\\"',Kn={type:"literal",value:'\\"',description:'"\\\\\\""'},Qn={type:"any",description:"any character"},Gn=function(e){return e},Yn=function(e){return e.join("").trim()},Zn={type:"other",description:"identifier"},er=/^[^;, "\t\n\r=\-><:{*]/,tr={type:"class",value:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]',description:'[^;, \\"\\t\\n\\r=\\-><:\\{\\*]'},nr=function(e){return e.join("")},rr={type:"other",description:"whitespace"},ir=/^[ \t]/,sr={type:"class",value:"[ \\t]",description:"[ \\t]"},or={type:"other",description:"lineend"},ur=/^[\r\n]/,ar={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},fr="/*",lr={type:"literal",value:"/*",description:'"/*"'},cr="*/",hr={type:"literal",value:"*/",description:'"*/"'},pr=function(e,t,n){return e+t.join("")+n},dr="//",vr={type:"literal",value:"//",description:'"//"'},mr="#",gr={type:"literal",value:"#",description:'"#"'},yr=/^[^\r\n]/,br={type:"class",value:"[^\\r\\n]",description:"[^\\r\\n]"},wr=function(e,t){return e+t.join("")},Er={type:"other",description:"comment"},Sr={type:"other",description:"integer"},xr=/^[0-9]/,Tr={type:"class",value:"[0-9]",description:"[0-9]"},Nr=function(e){return parseInt(e.join(""),10)},Cr={type:"other",description:"real"},kr=".",Lr={type:"literal",value:".",description:'"."'},Ar=function(e){return parseFloat(e.join(""))},Or={type:"other",description:"boolean"},Mr="true",_r={type:"literal",value:"true",description:'"true"'},Dr="false",Pr={type:"literal",value:"false",description:'"false"'},Hr="on",Br={type:"literal",value:"on",description:'"on"'},jr="off",Fr={type:"literal",value:"off",description:'"off"'},Ir="1",qr={type:"literal",value:"1",description:'"1"'},Rr="0",Ur={type:"literal",value:"0",description:'"0"'},zr={type:"other",description:"size"},Wr="auto",Xr={type:"literal",value:"auto",description:'"auto"'},Vr=0,$r=0,Jr=[{line:1,column:1,seenCR:!1}],Kr=0,Qr=[],Gr=0,Yr;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');o=s[n.startRule]}Yr=o();if(Yr!==i&&Vr===e.length)return Yr;throw Yr!==i&&Vr<e.length&&si({type:"end",description:"end of input"}),oi(null,Qr,Kr<e.length?e.charAt(Kr):null,Kr<e.length?ii(Kr,Kr+1):ii(Kr,Kr))}return e(t,Error),{SyntaxError:t,parse:n}}),n("lib/mscgenjs-core/render/graphics/constants",[],function(){"use strict";return{SVGNS:"http://www.w3.org/2000/svg",XLINKNS:"http://www.w3.org/1999/xlink",LINE_WIDTH:2,FONT_SIZE:12}}),n("lib/mscgenjs-core/render/graphics/svgelementfactory",["./constants"],function(e){"use strict";function r(e){return t.createTextNode(e)}function i(n,r,i,s){var o=t.createElementNS(e.SVGNS,"path");return o.setAttribute("d",n),r&&o.setAttribute("class",r),u(o,i,s),o}function s(n,r){var i=t.createElementNS(e.SVGNS,"polygon");return i.setAttribute("points",n),r&&i.setAttribute("class",r),i}function o(n,r,i,s,o,a){var f=t.createElementNS(e.SVGNS,"rect");return f.setAttribute("width",n.width),f.setAttribute("height",n.height),n.x&&f.setAttribute("x",n.x),n.y&&f.setAttribute("y",n.y),o&&f.setAttribute("rx",o),a&&f.setAttribute("ry",a),r&&f.setAttribute("class",r),u(f,i,s),f}function u(e,t,n){if(!!t||!!n){var r="";n&&(r+="fill:"+n+";"),t&&(r+="stroke:"+t+";"),e.setAttribute("style",r)}}function a(e,t,n,r){var s=3;return i("M"+e.x+","+e.y+"l"+s+", -"+e.height/2+"l"+(e.width-2*s)+",0"+"l"+s+","+e.height/2+"l-"+s+","+e.height/2+"l-"+(e.width-2*s)+",0 "+"l-"+s+",-"+e.height/2,t,n,r)}function f(t,n,r,s){var o=Math.max(9,Math.min(4.5*e.LINE_WIDTH,t.height/2)),u=o.toString(10);return i("M"+t.x+","+t.y+"l"+(t.width-o)+",0 "+"l0,"+u+" l"+u+",0 m-"+u+",-"+u+" l"+u+","+u+" "+"l0,"+(t.height-o)+" "+"l-"+t.width+",0 "+"l0,-"+(t.height+e.LINE_WIDTH/2)+" ",n,r,s)}function l(e,t,n,r,s){var o=s?s:7;return i("M"+e.x+","+e.y+" l"+e.width+",0 "+" l0,"+(e.height-o)+" l-"+o.toString(10)+","+o.toString(10)+" l-"+(e.width-o)+",0 ",t,n,r)}function c(n,r){var i=t.createElementNS(e.SVGNS,"a");return i.setAttributeNS(e.XLINKNS,"xlink:href",n),i.setAttributeNS(e.XLINKNS,"xlink:title",n),i.setAttributeNS(e.XLINKNS,"xlink:show","new"),i.appendChild(r),i}function h(n,r){var i=t.createElementNS(e.SVGNS,"tspan"),s=t.createTextNode(n);return i.appendChild(s),r?c(r,i):i}function p(r,i,s,o,u,a,f){var l=t.createElementNS(e.SVGNS,"text");if(!!r&&r!==""){l.setAttribute("x",i.toString()),l.setAttribute("y",s.toString()),o&&l.setAttribute("class",o),l.appendChild(h(r,u));if(a){var c=h(" ["+a+"]",f);c.setAttribute("style",n),l.appendChild(c)}}return l}function d(e,t){var n=p(e,t.width/2,t.height/2,"watermark"),r=0-Math.atan(t.height/t.width)*360/(2*Math.PI);return n.setAttribute("transform","rotate("+r.toString()+" "+(t.width/2).toString()+" "+(t.height/2).toString()+")"),n}function v(n,r){var i=t.createElementNS(e.SVGNS,"line");return i.setAttribute("x1",n.xFrom.toString()),i.setAttribute("y1",n.yFrom.toString()),i.setAttribute("x2",n.xTo.toString()),i.setAttribute("y2",n.yTo.toString()),r&&i.setAttribute("class",r),i}function m(e){var t=-1;return e.xTo>e.xFrom&&(t=1),{dx:t,dy:t*(e.yTo-e.yFrom)/(e.xTo-e.xFrom)}}function g(t,n){var r=0;return n!=="nodi"&&(r=t.xTo>t.xFrom?-7.5*e.LINE_WIDTH:7.5*e.LINE_WIDTH),r}function y(t,n){var r=0;return n!=="nodi"&&(r=n==="bidi"?t.xTo>t.xFrom?7.5*e.LINE_WIDTH:-7.5*e.LINE_WIDTH:0),r}function b(t,n){var r=e.LINE_WIDTH,s=m(t),o=g(t,n),u=y(t,n),a=(t.xTo-t.xFrom+o-u).toString(),f=(t.yTo-t.yFrom).toString(),l="l"+s.dx.toString()+","+s.dy.toString(),c=" l"+a+","+f;return i("M"+t.xFrom.toString()+","+(t.yFrom-7.5*e.LINE_WIDTH*s.dy).toString()+l+"M"+(t.xFrom+u).toString()+","+(t.yFrom-r).toString()+c+"M"+(t.xFrom+u).toString()+","+(t.yFrom+r).toString()+c+"M"+(t.xTo-s.dx).toString()+","+(t.yTo+7.5*e.LINE_WIDTH*s.dy).toString()+l,n)}function w(e,t,n){return n?b(e,t):v(e,t)}function E(t,n,r,s){var o=s?t.x+7.5*e.LINE_WIDTH:t.x;return i("M"+t.x.toString()+", -"+t.y.toString()+" C"+(t.x+r).toString()+","+(t.y-7.5*e.LINE_WIDTH).toString()+" "+(t.x+r).toString()+","+(n+0).toString()+" "+o.toString()+","+n.toString())}function S(n){var r=t.createElementNS(e.SVGNS,"g");return!n||r.setAttribute("id",n),r}function x(n,r,i){var s=t.createElementNS(e.SVGNS,"use");return s.setAttribute("x",n.toString()),s.setAttribute("y",r.toString()),s.setAttributeNS(e.XLINKNS,"xlink:href","#"+i),s}function T(n,r,i,s){var o=s?s:"0 0 10 10",u=t.createElementNS(e.SVGNS,"marker");return u.setAttribute("orient",i),u.setAttribute("id",n),u.setAttribute("class",r),u.setAttribute("viewBox",o),u.setAttribute("refX","9"),u.setAttribute("refY","3"),u.setAttribute("markerUnits","strokeWidth"),u.setAttribute("markerWidth","10"),u.setAttribute("markerHeight","10"),u}function N(e,t,n){var r=T(e,"arrow-marker","auto"),s=i(t,"arrow-style");return s.setAttribute("style","stroke-dasharray:100,1; stroke : "+n||"black"),r.appendChild(s),r}function C(e,t,n){var r=T(e,"arrow-marker","auto"),i=s(t,"arrow-style");return i.setAttribute("stroke",n||"black"),i.setAttribute("fill",n||"black"),r.appendChild(i),r}var t,n="vertical-align : text-top;";return n+="font-size: 0.7em; text-anchor: start;",{init:function(e){t=e},createTextNode:r,createRect:o,createABox:a,createNote:f,createEdgeRemark:l,createText:p,createDiagonalText:d,createLine:w,createUTurn:E,createGroup:S,createUse:x,createMarkerPath:N,createMarkerPolygon:C}}),n("lib/mscgenjs-core/render/graphics/idmanager",[],function(){"use strict";var e="mscgen_js-svg-",t=e;return{setPrefix:function(n){t=e+n},get:function(e){return e?t+e:t}}}),function(){function et(e,t){return e.set(t[0],t[1]),e}function tt(e,t){return e.add(t),e}function nt(e,t,n){var r=n.length;switch(r){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function rt(e,t){var n=-1,r=e.length;while(++n<r)if(t(e[n],n,e)===!1)break;return e}function it(e,t){var n=-1,r=t.length,i=e.length;while(++n<r)e[i+n]=t[n];return e}function st(e,t,n,r){var i=-1,s=e.length;r&&s&&(n=e[++i]);while(++i<s)n=t(n,e[i],i,e);return n}function ot(e,t){var n=-1,r=Array(e);while(++n<e)r[n]=t(n);return r}function ut(e){return e&&e.Object===Object?e:null}function at(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch(n){}return t}function ft(e,t){return e=typeof e=="number"||U.test(e)?+e:-1,t=t==null?u:t,e>-1&&e%1==0&&e<t}function lt(e){var t,n=[];while(!(t=e.next()).done)n.push(t.value);return n}function ct(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function ht(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Rt(){}function Ut(){}function zt(e,t){return Xt(e,t)&&delete e[t]}function Wt(t,n){if(Pt){var r=t[n];return r===s?e:r}return mt.call(t,n)?t[n]:e}function Xt(t,n){return Pt?t[n]!==e:mt.call(t,n)}function Vt(t,n,r){t[n]=Pt&&r===e?s:r}function $t(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function Jt(){this.__data__={hash:new Ut,map:Mt?new Mt:[],string:new Ut}}function Kt(e){var t=this.__data__;return Xn(e)?zt(typeof e=="string"?t.string:t.hash,e):Mt?t.map["delete"](e):on(t.map,e)}function Qt(e){var t=this.__data__;return Xn(e)?Wt(typeof e=="string"?t.string:t.hash,e):Mt?t.map.get(e):un(t.map,e)}function Gt(e){var t=this.__data__;return Xn(e)?Xt(typeof e=="string"?t.string:t.hash,e):Mt?t.map.has(e):an(t.map,e)}function Yt(e,t){var n=this.__data__;return Xn(e)?Vt(typeof e=="string"?n.string:n.hash,e,t):Mt?n.map.set(e,t):ln(n.map,e,t),this}function Zt(e){var t=-1,n=e?e.length:0;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}function en(){this.__data__={array:[],map:null}}function tn(e){var t=this.__data__,n=t.array;return n?on(n,e):t.map["delete"](e)}function nn(e){var t=this.__data__,n=t.array;return n?un(n,e):t.map.get(e)}function rn(e){var t=this.__data__,n=t.array;return n?an(n,e):t.map.has(e)}function sn(e,t){var n=this.__data__,i=n.array;i&&(i.length<r-1?ln(i,e,t):(n.array=null,n.map=new $t(i)));var s=n.map;return s&&s.set(e,t),this}function on(e,t){var n=fn(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Lt.call(e,n,1),!0}function un(t,n){var r=fn(t,n);return r<0?e:t[r][1]}function an(e,t){return fn(e,t)>-1}function fn(e,t){var n=e.length;while(n--)if(Gn(e[n][0],t))return n;return-1}function ln(e,t,n){var r=fn(e,t);r<0?e.push([t,n]):e[r][1]=n}function cn(t,n,r,i){return t===e||Gn(t,dt[r])&&!mt.call(i,r)?n:t}function hn(t,n,r){var i=t[n];if(!Gn(i,r)||Gn(i,dt[n])&&!mt.call(t,n)||r===e&&!(n in t))t[n]=r}function pn(e,t){return e&&Mn(t,pr(t),e)}function dn(t,n,r,i,s,o){var u;r&&(u=s?r(t,i,s,o):r(t));if(u!==e)return u;if(!sr(t))return t;var a=Zn(t);if(a){u=qn(t);if(!n)return On(t,u)}else{var f=In(t),c=f==v||f==m;if(nr(t))return xn(t,n);if(f==b||f==l||c&&!s){if(at(t))return s?t:{};u=Rn(c?{}:t);if(!n)return Dn(t,pn(u,t))}else{if(!z[f])return s?t:{};u=Un(t,f,n)}}o||(o=new Zt);var h=o.get(t);return h?h:(o.set(t,u),(a?rt:yn)(t,function(e,i){hn(u,i,dn(e,n,r,i,t,o))}),a?u:Dn(t,u))}function vn(e){return sr(e)?Ct(e):{}}function mn(e,t,n,r){r||(r=[]);var i=-1,s=e.length;while(++i<s){var o=e[i];t>0&&tr(o)&&(n||Zn(o)||Yn(o))?t>1?mn(o,t-1,n,r):it(r,o):n||(r[r.length]=o)}return r}function yn(e,t){return e&&gn(e,t,pr)}function bn(e,t){return mt.call(e,t)||typeof e=="object"&&t in e&&Tt(e)===null}function wn(e){return At(Object(e))}function En(e){e=e==null?e:Object(e);var t=[];for(var n in e)t.push(n);return t}function Sn(t){return function(n){return n==null?e:n[t]}}function xn(e,t){if(t)return e.slice();var n=e.constructor,r=new n(e.length);return e.copy(r),r}function Tn(e){var t=e.constructor,n=new t(e.byteLength),r=new St(n);return r.set(new St(e)),n}function Nn(e){var t=e.constructor;return st(ct(e),et,new t)}function Cn(e){var t=e.constructor,n=new t(e.source,j.exec(e));return n.lastIndex=e.lastIndex,n}function kn(e){var t=e.constructor;return st(ht(e),tt,new t)}function Ln(e){return Et?Object(It.call(e)):{}}function An(e,t){var n=e.buffer,r=t?Tn(n):n,i=e.constructor;return new i(r,e.byteOffset,e.length)}function On(e,t){var n=-1,r=e.length;t||(t=Array(r));while(++n<r)t[n]=e[n];return t}function Mn(e,t,n){return _n(e,t,n)}function _n(e,t,n,r){n||(n={});var i=-1,s=t.length;while(++i<s){var o=t[i],u=r?r(n[o],e[o],o,n,e):e[o];hn(n,o,u)}return n}function Dn(e,t){return Mn(e,Fn(e),t)}function Pn(t){return Kn(function(n,r){var i=-1,s=r.length,o=s>1?r[s-1]:e,u=s>2?r[2]:e;o=typeof o=="function"?(s--,o):e,u&&Wn(r[0],r[1],u)&&(o=s<3?e:o,s=1),n=Object(n);while(++i<s){var a=r[i];a&&t(n,a,i,o)}return n})}function Hn(e){return function(t,n,r){var i=-1,s=Object(t),o=r(t),u=o.length;while(u--){var a=o[e?u:++i];if(n(s[a],a,s)===!1)break}return t}}function jn(t,n){var r=t==null?e:t[n];return ur(r)?r:e}function In(e){return gt.call(e)}function qn(e){var t=e.length,n=e.constructor(t);return t&&typeof e[0]=="string"&&mt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Rn(t){if(Vn(t))return{};var n=t.constructor;return vn(rr(n)?n.prototype:e)}function Un(e,t,n){var r=e.constructor;switch(t){case N:return Tn(e);case h:case p:return new r(+e);case C:case k:case L:case A:case O:case M:case _:case D:case P:return An(e,n);case g:return Nn(e);case y:case S:return new r(e);case w:return Cn(e);case E:return kn(e);case x:return Ln(e)}}function zn(t){var n=t?t.length:e;return ir(n)&&(Zn(t)||ar(t)||Yn(t))?ot(n,String):null}function Wn(e,t,n){if(!sr(n))return!1;var r=typeof t;return(r=="number"?er(n)&&ft(t,n.length):r=="string"&&t in n)?Gn(n[t],e):!1}function Xn(e){var t=typeof e;return t=="number"||t=="boolean"||t=="string"&&e!="__proto__"||e==null}function Vn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||dt;return e===n}function $n(e){var t=e?e.length:0;return t?mn(e,1):[]}function Jn(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o),o};return n.cache=new Jn.Cache,n}function Kn(t,n){if(typeof t!="function")throw new TypeError(i);return n=Ot(n===e?t.length-1:fr(n),0),function(){var e=arguments,r=-1,i=Ot(e.length-n,0),s=Array(i);while(++r<i)s[r]=e[n+r];switch(n){case 0:return t.call(this,s);case 1:return t.call(this,e[0],s);case 2:return t.call(this,e[0],e[1],s)}var o=Array(n+1);r=-1;while(++r<n)o[r]=e[r];return o[n]=s,nt(t,this,o)}}function Qn(e){return dn(e,!0)}function Gn(e,t){return e===t||e!==e&&t!==t}function Yn(e){return tr(e)&&mt.call(e,"callee")&&(!kt.call(e,"callee")||gt.call(e)==l)}function er(e){return e!=null&&(typeof e!="function"||!rr(e))&&ir(Bn(e))}function tr(e){return or(e)&&er(e)}function rr(e){var t=sr(e)?gt.call(e):"";return t==v||t==m}function ir(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=u}function sr(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function or(e){return!!e&&typeof e=="object"}function ur(e){return e==null?!1:rr(e)?yt.test(vt.call(e)):or(e)&&(at(e)?yt:q).test(e)}function ar(e){return typeof e=="string"||!Zn(e)&&or(e)&&gt.call(e)==S}function fr(e){if(!e)return e===0?e:0;e=lr(e);if(e===o||e===-o){var t=e<0?-1:1;return t*a}var n=e%1;return e===e?n?e-n:e:0}function lr(e){if(sr(e)){var t=rr(e.valueOf)?e.valueOf():e;e=sr(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(B,"");var n=I.test(e);return n||R.test(e)?X(e.slice(2),n?2:8):F.test(e)?f:+e}function pr(e){var t=Vn(e);if(!t&&!er(e))return wn(e);var n=zn(e),r=!!n,i=n||[],s=i.length;for(var o in e)bn(e,o)&&(!r||o!="length"&&!ft(o,s))&&(!t||o!="constructor")&&i.push(o);return i}function dr(e){var t=-1,n=Vn(e),r=En(e),i=r.length,s=zn(e),o=!!s,u=s||[],a=u.length;while(++t<i){var f=r[t];(!o||f!="length"&&!ft(f,a))&&(f!="constructor"||!n&&!!mt.call(e,f))&&u.push(f)}return u}function vr(e){return function(){return e}}var e,t="4.5.0",r=200,i="Expected a function",s="__lodash_hash_undefined__",o=1/0,u=9007199254740991,a=1.7976931348623157e308,f=0/0,l="[object Arguments]",c="[object Array]",h="[object Boolean]",p="[object Date]",d="[object Error]",v="[object Function]",m="[object GeneratorFunction]",g="[object Map]",y="[object Number]",b="[object Object]",w="[object RegExp]",E="[object Set]",S="[object String]",x="[object Symbol]",T="[object WeakMap]",N="[object ArrayBuffer]",C="[object Float32Array]",k="[object Float64Array]",L="[object Int8Array]",A="[object Int16Array]",O="[object Int32Array]",M="[object Uint8Array]",_="[object Uint8ClampedArray]",D="[object Uint16Array]",P="[object Uint32Array]",H=/[\\^$.*+?()[\]{}|]/g,B=/^\s+|\s+$/g,j=/\w*$/,F=/^[-+]0x[0-9a-f]+$/i,I=/^0b[01]+$/i,q=/^\[object .+?Constructor\]$/,R=/^0o[0-7]+$/i,U=/^(?:0|[1-9]\d*)$/,z={};z[l]=z[c]=z[N]=z[h]=z[p]=z[C]=z[k]=z[L]=z[A]=z[O]=z[g]=z[y]=z[b]=z[w]=z[E]=z[S]=z[x]=z[M]=z[_]=z[D]=z[P]=!0,z[d]=z[v]=z[T]=!1;var W={"function":!0,object:!0},X=parseInt,V=W[typeof exports]&&exports&&!exports.nodeType?exports:e,$=W[typeof module]&&module&&!module.nodeType?module:e,J=$&&$.exports===V?V:e,K=ut(V&&$&&typeof global=="object"&&global),Q=ut(W[typeof self]&&self),G=ut(W[typeof window]&&window),Y=ut(W[typeof this]&&this),Z=K||G!==(Y&&Y.window)&&G||Q||Y||Function("return this")(),pt=Array.prototype,dt=Object.prototype,vt=Function.prototype.toString,mt=dt.hasOwnProperty,gt=dt.toString,yt=RegExp("^"+vt.call(mt).replace(H,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=J?Z.Buffer:e,wt=Z.Reflect,Et=Z.Symbol,St=Z.Uint8Array,xt=wt?wt.enumerate:e,Tt=Object.getPrototypeOf,Nt=Object.getOwnPropertySymbols,Ct=Object.create,kt=dt.propertyIsEnumerable,Lt=pt.splice,At=Object.keys,Ot=Math.max,Mt=jn(Z,"Map"),_t=jn(Z,"Set"),Dt=jn(Z,"WeakMap"),Pt=jn(Object,"create"),Ht=Mt?vt.call(Mt):"",Bt=_t?vt.call(_t):"",jt=Dt?vt.call(Dt):"",Ft=Et?Et.prototype:e,It=Et?Ft.valueOf:e,qt={},gn=Hn();xt&&!kt.call({valueOf:1},"valueOf")&&(En=function(e){return lt(xt(e))});var Bn=Sn("length"),Fn=Nt||function(){return[]};if(Mt&&In(new Mt)!=g||_t&&In(new _t)!=E||Dt&&In(new Dt)!=T)In=function(e){var t=gt.call(e),n=t==b?e.constructor:null,r=typeof n=="function"?vt.call(n):"";if(r)switch(r){case Ht:return g;case Bt:return E;case jt:return T}return t};var Zn=Array.isArray,nr=bt?function(e){return e instanceof bt}:vr(!1),cr=Pn(function(e,t,n,r){_n(t,dr(t),e,r)}),hr=Kn(function(t){return t.push(e,cn),nt(cr,e,t)});Ut.prototype=Pt?Pt(null):dt,$t.prototype.clear=Jt,$t.prototype["delete"]=Kt,$t.prototype.get=Qt,$t.prototype.has=Gt,$t.prototype.set=Yt,Zt.prototype.clear=en,Zt.prototype["delete"]=tn,Zt.prototype.get=nn,Zt.prototype.has=rn,Zt.prototype.set=sn,Jn.Cache=$t,Rt.assignInWith=cr,Rt.constant=vr,Rt.defaults=hr,Rt.flatten=$n,Rt.keys=pr,Rt.keysIn=dr,Rt.memoize=Jn,Rt.rest=Kn,Rt.extendWith=cr,Rt.cloneDeep=Qn,Rt.eq=Gn,Rt.isArguments=Yn,Rt.isArray=Zn,Rt.isArrayLike=er,Rt.isArrayLikeObject=tr,Rt.isBuffer=nr,Rt.isFunction=rr,Rt.isLength=ir,Rt.isNative=ur,Rt.isObject=sr,Rt.isObjectLike=or,Rt.isString=ar,Rt.toInteger=fr,Rt.toNumber=lr,Rt.VERSION=t,(G||Q||{})._=Rt,typeof n=="function"&&typeof n.amd=="object"&&n.amd?n("lib/mscgenjs-core/lib/lodash/lodash.custom",[],function(){return Rt}):V&&$?(J&&(($.exports=Rt)._=Rt),V._=Rt):Z._=Rt}.call(this),n("lib/mscgenjs-core/render/graphics/svgutensils",["./constants","./idmanager","../../lib/lodash/lodash.custom"],function(e,t,n){"use strict";function s(t){var n=r.createElementNS(e.SVGNS,"svg");return n.setAttribute("version","1.1"),n.setAttribute("xmlns",e.SVGNS),n.setAttribute("xmlns:xlink",e.XLINKNS),n.setAttribute("id",t),n.setAttribute("width",0),n.setAttribute("height",0),r.body.appendChild(n),n}function o(e){var t=r.getElementById(i);t=t?t:s(i),t.appendChild(e);var n=e.getBBox();return t.removeChild(e),n}function u(e){var t=1e5;return Math.abs(e.height)>t||Math.abs(e.width)>t?{height:0,width:0,x:0,y:0}:e}function a(e){return typeof e.getBBox=="function"?u(o(e)):{height:15,width:15,x:2,y:2}}function f(t){var n=r.createElementNS(e.SVGNS,"tspan");return n.appendChild(r.createTextNode(t)),n}function l(t){var n=r.createElementNS(e.SVGNS,"text");return n.setAttribute("x","0"),n.setAttribute("y","0"),n.appendChild(f(t)),n}function c(){return a(l("jy9@")).height}function h(e){t.setPrefix(e);var n=r.getElementById(t.get());if(!!n){var i=r.getElementById(e);i?i.removeChild(n):r.body.removeChild(n)}}var r,i=t.get("bboxer");return{init:function(e){r=e},removeRenderedSVGFromElement:h,getBBox:a,calculateTextHeight:n.memoize(c),webkitNamespaceBugWorkaround:function(e){return e.replace(/\ xlink=/g," xmlns:xlink=","g").replace(/\ href=/g," xlink:href=","g")}}}),n("lib/mscgenjs-core/render/graphics/renderutensils",[],function(){"use strict";function e(e,t){t.scale=e/t.width,t.width*=t.scale,t.height*=t.scale,t.horizontaltransform*=t.scale,t.verticaltransform*=t.scale,t.x=0-t.horizontaltransform,t.y=0-t.verticaltransform}function t(e,t){return e?2*(e+1)*2*t:0}function n(e,t,n){return"-x"===e?t+(n-t)*.75:n}return{scaleCanvasToWidth:e,determineDepthCorrection:t,determineArcXTo:n}}),n("lib/mscgenjs-core/render/graphics/renderskeleton",["./svgelementfactory","./constants"],function(e,t){"use strict";function r(t,n){return n.forEach(function(n){n.type==="method"?t.appendChild(e.createMarkerPolygon(n.name,n.path,n.color)):t.appendChild(e.createMarkerPath(n.name,n.path,n.color))}),t}function i(){var e=n.createElement("style");return e.setAttribute("type","text/css"),e.appendChild(n.createTextNode(c())),e}function s(e){var r=n.createElementNS(t.SVGNS,"svg");return r.setAttribute("version","1.1"),r.setAttribute("id",e),r.setAttribute("xmlns",t.SVGNS),r.setAttribute("xmlns:xlink",t.XLINKNS),r}function o(s,o){var u=n.createElementNS(t.SVGNS,"defs");return u.appendChild(i()),u=r(u,o),u.appendChild(e.createGroup(s+"__defs")),u}function u(e){var r=n.createElementNS(t.SVGNS,"desc");return r.setAttribute("id",e+"__msc_source"),r}function a(t){var n=e.createGroup(t+"__body");return n.appendChild(e.createGroup(t+"__background")),n.appendChild(e.createGroup(t+"__arcspanlayer")),n.appendChild(e.createGroup(t+"__lifelinelayer")),n.appendChild(e.createGroup(t+"__sequencelayer")),n.appendChild(e.createGroup(t+"__notelayer")),n.appendChild(e.createGroup(t+"__watermark")),n}function f(t){return e.init(t.document),t.document}function l(e,t,r,i){n=f(i);var l=n.getElementById(e);l===null&&(l=n.body);var c=s(t);return c.appendChild(u(t)),c.appendChild(o(t,r)),c.appendChild(a(t)),l.appendChild(c),n}function c(){return"svg{  font-family:Helvetica,sans-serif;  font-size:"+t.FONT_SIZE+"px;  font-weight:normal;  font-style:normal;  text-decoration:none;  background-color:white;  stroke:black;  color:black;}rect{  fill:none;  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.bglayer{  fill:white;  stroke:white;  stroke-width:0;}rect.textbg{  fill:white;  stroke:white;  stroke-width:0;  opacity:0.9;}line{  stroke:black;  stroke-width:"+t.LINE_WIDTH+";}.arcrowomit{  stroke-dasharray:2,2;}text{  color:inherit;  stroke:none;  text-anchor:middle;}text.entity{  text-decoration:underline;}text.anchor-start{  text-anchor:start;}path{  stroke:black;  color:black;  stroke-width:"+t.LINE_WIDTH+";  fill:none;}.dotted{  stroke-dasharray:5,2;}.striped{  stroke-dasharray:10,5;}.arrow-marker{  overflow:visible;}.arrow-style{  stroke-width:1;}.arcrowomit{  stroke-dasharray:2,2;}.box{  /* fill: #ffc;  no-inherit */  fill:white;  opacity:0.9;}.boxtext, .arctext{  font-size:0.8em;  text-anchor:middle;}.comment{  stroke-dasharray:5,2;} .inherit{  stroke:inherit;  color:inherit;} .inherit-fill{  fill:inherit;}.watermark{  stroke:black;  color:black;  fill:black;  font-size: 48pt;  font-weight:bold;  opacity:0.14;}"}var n;return{bootstrap:l,init:f}}),n("lib/mscgenjs-core/render/text/asttransform",[],function(){"use strict";function e(e,t){e&&t&&e.forEach(function(e){t.forEach(function(t){t(e)})})}function t(e,t,n,r){r&&r.forEach(function(r){r(n,e,t)})}function n(e,n,i){n.forEach(function(s){t(e,n,s,i),s.arcs&&r(e,s.arcs,i)})}function r(e,t,r){e&&t&&r&&t.forEach(function(t){n(e,t,r)})}function i(t,n,i){return e(t.entities,n),r(t.entities,t.arcs,i),t}return{transform:i}}),n("lib/mscgenjs-core/render/text/arcmappings",[],function(){"use strict";var e={"->":"rvee","<->":"rvee","=>":"normal","<=>":"normal","-x":"oinvonormal"},t={box:"box",abox:"hexagon",rbox:"box",note:"note"},n={">>":"dashed","<<>>":"dashed","..":"dashed",":>":"bold","<:>":"bold","::":"bold",rbox:"rounded"},r={"|||":"emptyarc","...":"emptyarc","---":"emptyarc","->":"directional","=>":"directional","=>>":"directional",">>":"directional",":>":"directional","-x":"directional","<-":"directional","<=":"directional","<<=":"directional","<<":"directional","<:":"directional","x-":"directional",note:"box",box:"box",abox:"box",rbox:"box","<->":"bidirectional","<=>":"bidirectional","<<=>>":"bidirectional","<<>>":"bidirectional","<:>":"bidirectional","--":"nondirectional","==":"nondirectional","..":"nondirectional","::":"nondirectional",alt:"inline_expression","else":"inline_expression",opt:"inline_expression","break":"inline_expression",par:"inline_expression",seq:"inline_expression",strict:"inline_expression",neg:"inline_expression",critical:"inline_expression",ignore:"inline_expression",consider:"inline_expression",assert:"inline_expression",loop:"inline_expression",ref:"inline_expression",exc:"inline_expression"},i={"<-":"->","<=":"=>","<<=":"=>>","<<":">>","<:":":>","x-":"-x"};return{getArrow:function(t){return e[t]},getShape:function(e){return t[e]},getStyle:function(e){return n[e]},getAggregate:function(e){return r[e]},getNormalizedKind:function(e){return i[e]||e}}}),n("lib/mscgenjs-core/render/text/textutensils",[],function(){"use strict";return{wrap:function(e,t){var n=0,r=[],i=0,s=0,o=0,u=0,a=e.replace(/[\t\n]+/g," ").replace(/\\n/g,"\n");while(u<=a.length)u>=a.length?r.push(a.substring(i,u)):a[u]==="\n"?(n=0,o=u,r.push(a.substring(i,o)),i=o+1):n++>=t&&(o=a.substring(0,u).lastIndexOf(" "),o===-1||o<i?(n=1,o=u,s=u):(n=0,s=o+1),r.push(a.substring(i,o)),i=s),u++;return r},unescapeString:function(e){return e.replace(/\\\"/g,'"')},escapeString:function(e){return e.replace(/\\\"/g,'"').replace(/\"/g,'\\"')}}}),n("lib/mscgenjs-core/render/text/flatten",["./asttransform","./arcmappings","../../lib/lodash/lodash.custom","./textutensils"],function(e,t,n,r){"use strict";function s(e){e.label===undefined&&(e.label=e.name)}function o(e){!e.label||(e.label=r.unescapeString(e.label)),!e.id||(e.id=r.unescapeString(e.id))}function u(e){e.label=e.label?e.label:""}function a(e){if(e.kind&&t.getNormalizedKind(e.kind)!==e.kind){e.kind=t.getNormalizedKind(e.kind);var n=e.from;e.from=e.to,e.to=n}return e}function f(e,t){!e.linecolor&&t.arclinecolor&&(e.linecolor=t.arclinecolor),!e.textcolor&&t.arctextcolor&&(e.textcolor=t.arctextcolor),!e.textbgcolor&&t.arctextbgcolor&&(e.textbgcolor=t.arctextbgcolor)}function l(e,t){if(e&&e.from){var n=t.filter(function(t){return t.name===e.from});n.length>0&&f(e,n[0])}}function c(e){return e.arcs.reduce(function(e,t){return e+(t[0].arcs?c(t[0])+1:0)},e.arcs.length)}function h(e,r,s,o,u){var a={};"inline_expression"===t.getAggregate(e[0].kind)?(a=n.cloneDeep(e[0]),a.arcs?(a.numberofrows=c(a),delete a.arcs,r.arcs.push([a]),e[0].arcs.forEach(function(e){h(e,r,s+1,a.from,a.to),e.forEach(function(e){f(e,a)})}),s>i&&(i=s)):r.arcs.push([a]),r.arcs.push([{kind:"|||",from:a.from,to:a.to}]),a.depth=s):(o&&u&&e.filter(function(e){return"emptyarc"===t.getAggregate(e.kind)}).forEach(function(e){e.from=o,e.to=u,e.depth=s}),r.arcs.push(e))}function p(e){var t={};return i=0,!e.options||(t.options=n.cloneDeep(e.options)),!e.entities||(t.entities=n.cloneDeep(e.entities)),t.arcs=[],e&&e.arcs&&e.arcs.forEach(function(e){h(e,t,0)}),t.depth=i+1,t}function d(e,t){return e.filter(function(e){return t.from!==e.name}).map(function(e){return t.to=e.name,n.cloneDeep(t)})}function v(e){if(e.entities&&e.arcs){var t=[],r={};e.arcs.forEach(function(i,s){i.filter(function(e){return e.to==="*"}).forEach(function(o,u){r=n.cloneDeep(o),delete e.arcs[s][u],t=d(e.entities,r),i[u]=t.shift(),e.arcs[s]=i.concat(t)})})}return e}var i=0;return{swapRTLArc:a,unwind:p,explodeBroadcasts:v,flatten:function(t){return e.transform(p(t),[s,o],[a,l,o,u])},dotFlatten:function(t){return v(e.transform(t,[s],[a,l]))}}}),n("lib/mscgenjs-core/render/graphics/swap",[],function(){"use strict";function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}return{swapfromto:function(t){e(t,"from","to")}}}),n("lib/mscgenjs-core/render/graphics/rowmemory",[],function(){"use strict";function r(r,i){e=[],t=r,n=i}function i(r){return e[r]?e[r]:{y:t+1.5*n+r*n,height:n}}function s(){return i(e.length-1)}function o(t,r,s){if(r===undefined||r<n)r=n;if(s===undefined){var o=i(t-1);o&&o.y>0&&(s=o.y+(o.height+r)/2)}e[t]={y:s,height:r}}var e=[],t=0,n=0;return{clear:r,get:i,getLast:s,set:o}}),n("lib/mscgenjs-core/render/graphics/markermanager",["../../lib/lodash/lodash.custom","../text/arcmappings"],function(e,t){"use strict";function i(e,t,n){if(t&&n&&["<->","->"].indexOf(e>-1))return t<n?"signal":"signal-u"}function s(e,t,n){return"<->"===e&&t<=n?"signal-l":"signal-lu"}function o(e,t,r,o,u){var a=[];return n[t]&&n[t].attributes&&(a=n[t].attributes.map(function(n){return{name:n.name,value:n.value.replace(/\{\{signal-marker-end\}\}/g,i(t,o,u)).replace(/\{\{signal-marker-start\}\}/g,s(t,o,u)).replace(/\{\{id\}\}/g,e).replace(/\{\{color\}\}/g,r||"black")}})),a}function u(e,r){return n[t.getNormalizedKind(e)].marker.name+(r?" "+r:" black")}function a(e,r){function i(t){a(e,t)}return Array.isArray(r)&&r.forEach(i),!r.arcs||r.arcs.forEach(i),!!r.kind&&!!n[t.getNormalizedKind(r.kind)]&&!!n[t.getNormalizedKind(r.kind)].marker&&e.indexOf(u(r.kind,r.linecolor))<0&&e.push(u(r.kind,r.linecolor)),e}function f(e){return{kind:e.split(" ")[0],color:e.split(" ")[1]}}function l(e){return e.arcs.reduce(a,[]).sort().map(f)}var n={"->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"}],marker:{name:"signal"}},"<->":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}{{signal-marker-end}}-{{color}})"},{name:"marker-start",value:"url(#{{id}}{{signal-marker-start}}-{{color}})"}],marker:{name:"signal"}},"=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<=>>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},">>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"}],marker:{name:"callback",end:""}},"<<>>":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"},{name:"marker-end",value:"url(#{{id}}callback-{{color}})"},{name:"marker-start",value:"url(#{{id}}callback-l-{{color}})"}],marker:{name:"callback",end:"",start:"-l"}},"..":{attributes:[{name:"style",value:"stroke:{{color}};stroke-dasharray:5,2;"}]},"--":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"==":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"::":{attributes:[{name:"style",value:"stroke:{{color}};"}]},"=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<=>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},":>":{attributes:[{name:"style",value:"stroke:{{color}};"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"}],marker:{name:"method",end:""}},"<:>":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}method-{{color}})"},{name:"marker-start",value:"url(#{{id}}method-l-{{color}})"}],marker:{name:"method",end:"",start:"-l"}},"-x":{attributes:[{name:"style",value:"stroke:{{color}}"},{name:"marker-end",value:"url(#{{id}}lost-{{color}})"}],marker:{name:"lost",end:""}}},r={signal:{variants:[{name:"",path:"M9,3 l-8, 2"},{name:"-u",path:"M9,3 l-8,-2"},{name:"-l",path:"M9,3 l 8, 2"},{name:"-lu",path:"M9,3 l 8,-2"}]},method:{variants:[{name:"",path:"1,1  9,3  1,5"},{name:"-l",path:"17,1 9,3 17,5"}]},callback:{variants:[{name:"",path:"M 1,1 l 8,2 l-8,2"},{name:"-l",path:"M17,1 l-8,2 l 8,2"}]},lost:{variants:[{name:"",path:"M7,0 l5,6 M7,6 l5,-6"}]}};return{getAttributes:o,getMarkerDefs:function(t,n){return e.flatten(l(n).map(function(e){return r[e.kind].variants.map(function(n){return{name:t+e.kind+n.name+"-"+e.color,path:n.path,color:e.color,type:e.kind}})}))}}}),n("lib/mscgenjs-core/render/graphics/renderlabels",["./svgelementfactory","./svgutensils","./constants","../text/textutensils","../text/arcmappings"],function(e,t,n,r,i){"use strict";function s(e,t){t&&e.setAttribute("style","fill:"+t+";")}function o(e,t,n){s(e,t&&!n?"blue":n)}function u(n,r){var i=e.createRect(t.getBBox(n),"textbg");return r&&i.setAttribute("style","fill: "+r+"; stroke:"+r+";"),i}function a(t,n,r,i,s,o){var u={};return t===0?u=e.createText(n,r,i,s,o.url,o.id,o.idurl):u=e.createText(n,r,i,s,o.url),u}function f(e,r,i,u,f,l){var c=i+(f+.25)*t.calculateTextHeight(),h;!l||(l.underline&&(h="entity"),l.alignLeft&&(h="anchor-start"),l.alignAround&&(c=i+(f+.25)*(t.calculateTextHeight()+n.LINE_WIDTH)));var p=a(f,e,r,c,h,u);return s(p,u.textcolor),o(p,u.url,u.textcolor),p}function l(r,i,s,o){var a=e.createGroup(o);if(r.label){var l=i.x+i.width/2,c=h(r.label,r.kind,i.width,n.FONT_SIZE,s?s.wordWrapArcs:!1),p={};!!s&&s.alignAbove&&c.forEach(function(){c.push("")});var d=i.y-(c.length-1)/2*(t.calculateTextHeight()+1);!!s&&s.alignAround&&(c.length===1&&c.push(""),d=i.y-(c.length-1)/2*(t.calculateTextHeight()+n.LINE_WIDTH+1)),c.forEach(function(e,t){e!==""&&(p=f(e,l,d,r,t,s),!!s&&s.ownBackground&&a.appendChild(u(p,r.textbgcolor)),a.appendChild(p)),d++})}return a}function c(e,t){var n=Math.abs(e),r=12;return n<=160?n/(t/r*8):n<=320?n/(t/r*6.4):n<=480?n/(t/r*5.9):n/(t/r*5.6)}function h(e,t,n,s,o){return"box"===i.getAggregate(t)||undefined===t||o?r.wrap(e,c(n,s)):e.split("\\n")}return{createLabel:l,splitLabel:h}}),n("lib/mscgenjs-core/render/graphics/entities",["./renderlabels","./constants"],function(e,t){"use strict";function u(e){s.interEntitySpacing=n,s.height=i,s.width=r,e&&e.hscale&&(s.interEntitySpacing=e.hscale*n,s.width=e.hscale*r),o={}}function a(e,t){return{from:f(e),to:f(t)}}function f(e){return o[e]}function l(e,t){o[e.name]=t+s.width/2}function c(){return s}function h(e){s.height=e}var n=160,r=100,i=34,s={interEntitySpacing:n,height:i,width:r},o={};return{init:u,getX:f,setX:l,getOAndD:a,setHeight:h,getDims:c,getNoEntityLines:function(n){return e.splitLabel(n,"box",s.width,t.FONT_SIZE).length}}}),n("lib/mscgenjs-core/render/graphics/renderast",["./svgelementfactory","./svgutensils","./renderutensils","./renderskeleton","../text/flatten","../text/arcmappings","./swap","./rowmemory","./idmanager","./markermanager","./entities","./renderlabels","./constants"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";function y(e,n,r,s){var o=i.flatten(e);b(o,n,r,s),w(o),E(o);var u=s.document.getElementById(r);return u?t.webkitNamespaceBugWorkaround(u.innerHTML):t.webkitNamespaceBugWorkaround(s.document.body.innerHTML)}function b(e,n,i,s){a.setPrefix(i),m.document=r.bootstrap(i,a.get(),f.getMarkerDefs(a.get(),e),s),t.init(m.document),S(m,e.depth),N(m,e.options),C(m,n)}function w(e){H(e.entities),u.clear(l.getDims().height,m.arcRowHeight),j(e.arcs,e.entities)}function E(e){var t=k(e);L(m,t),O(e.options,t),M(t)}function S(e,t){x(e.layer,e.document),e.maxDepth=t?t:0}function x(e,t){e.defs=t.getElementById(a.get("__defs")),e.lifeline=t.getElementById(a.get("__lifelinelayer")),e.sequence=t.getElementById(a.get("__sequencelayer")),e.notes=t.getElementById(a.get("__notelayer")),e.inline=t.getElementById(a.get("__arcspanlayer")),e.watermark=t.getElementById(a.get("__watermark"))}function T(e,t){e.arcRowHeight=d,e.arcGradient=v,e.wordWrapArcs=!1,t&&(t.arcgradient&&(e.arcRowHeight=parseInt(t.arcgradient,10)+d,e.arcGradient=parseInt(t.arcgradient,10)+v),t.wordwraparcs&&(e.wordWrapArcs=t.wordwraparcs))}function N(e,t){l.init(t),T(e,t)}function C(t,n){if(n){var r=e.createTextNode("\n\n# Generated by mscgen_js - https://sverweij.github.io/mscgen_js\n"+n);t.document.getElementById(a.get("__msc_source")).appendChild(r)}}function k(e){var t=n.determineDepthCorrection(e.depth,h.LINE_WIDTH),r=u.getLast(),i={width:e.entities.length*l.getDims().interEntitySpacing+t,height:r.y+r.height/2+2*p,horizontaltransform:(l.getDims().interEntitySpacing+t-l.getDims().width)/2,autoscale:!!e.options&&!!e.options.width&&e.options.width==="auto",verticaltransform:p,scale:1};return i.x=0-i.horizontaltransform,i.y=0-i.verticaltransform,i}function L(t,n){var r=e.createRect(n,"bglayer");t.document.getElementById(a.get("__background")).appendChild(r)}function A(t,n){m.layer.watermark.appendChild(e.createDiagonalText(t,n))}function O(e,t){e&&(e.watermark&&A(e.watermark,t),e.width&&e.width!=="auto"&&n.scaleCanvasToWidth(e.width,t))}function M(e){var t=m.document.getElementById(a.get()),n=m.document.getElementById(a.get("__body"));n.setAttribute("transform","translate("+e.horizontaltransform+","+e.verticaltransform+")"+" scale("+e.scale+","+e.scale+")"),!e.autoscale||e.autoscale!==!0?(t.setAttribute("width",e.width.toString()),t.setAttribute("height",e.height.toString())):(t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 "+e.width.toString()+" "+e.height.toString()))}function _(e){var n=e[0],r=2;return e.forEach(function(e){var t=l.getNoEntityLines(e.label);t>r&&(r=t,n=e)}),r>2?Math.max(l.getDims().height,t.getBBox(D(n)).height):l.getDims().height}function D(t){var n=e.createGroup(a.get(t.name)),r=l.getDims(),i=c.createLabel(t,{x:0,y:r.height/2,width:r.width},{underline:!0}),s=e.createRect(r,null,t.linecolor,t.textbgcolor);return n.appendChild(s),n.appendChild(i),n}function P(t,n){m.layer.defs.appendChild(D(t)),m.layer.sequence.appendChild(e.createUse(n,0,a.get(t.name)))}function H(e){var t=0;e&&(l.setHeight(_(e)+h.LINE_WIDTH*2),e.forEach(function(e){P(e,t),l.setX(e,t),t+=l.getDims().interEntitySpacing})),m.arcEndX=t-l.getDims().interEntitySpacing+l.getDims().width}function B(n,r,i){var o=!1,f=[];u.set(r),n.forEach(function(e,n){var p=a.get(r.toString()+"_"+n.toString()),d;switch(s.getAggregate(e.kind)){case"emptyarc":d=z(e,p),o="..."===e.kind,f.push({id:p,layer:m.layer.sequence});break;case"box":d=J(p,l.getOAndD(e.from,e.to),e),f.push({id:p,layer:m.layer.notes});break;case"inline_expression":d=F(p+"_label",e),f.push({id:p+"_label",layer:m.layer.notes}),g.push({id:p,arc:e,rownum:r});break;default:if(e.from&&e.to){var v=0,y=0;if(e.to==="*"){var b=e.label;y=l.getX(e.from),i.forEach(function(t,n){t.name!==e.from&&(v=l.getX(t.name),e.label="",m.layer.defs.appendChild(X(p+"bc"+n,e,y,v)),f.push({id:p+"bc"+n,layer:m.layer.sequence}))}),e.label=b,d=c.createLabel(e,{x:0,y:0,width:m.arcEndX},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs},p+"_lbl"),f.push({id:p+"_lbl",layer:m.layer.sequence})}else d=X(p,e,l.getX(e.from),l.getX(e.to)),f.push({id:p,layer:m.layer.sequence})}}d&&(u.set(r,Math.max(u.get(r).height,t.getBBox(d).height+2*h.LINE_WIDTH)),m.layer.defs.appendChild(d))});var p="arcrow_"+r.toString(),d="arcrow";o&&(d="arcrowomit"),m.layer.defs.appendChild(R(i,d,u.get(r).height,a.get(p))),m.layer.lifeline.appendChild(e.createUse(0,u.get(r).y,a.get(p))),f.forEach(function(t){t.layer.appendChild(e.createUse(0,u.get(r).y,t.id))})}function j(t,n){g=[],m.layer.defs.appendChild(R(n,a.get("arcrow"))),m.layer.lifeline.appendChild(e.createUse(0,u.get(-1).y,a.get("arcrow")));if(t){for(var r=0;r<t.length;r++)B(t[r],r,n);I(g)}}function F(n,r){var i={from:l.getX(r.from),to:l.getX(r.to)},s=7;i.from>i.to&&o.swapfromto(i);var u=i.to-i.from+(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)-s-h.LINE_WIDTH,a=i.from-(l.getDims().interEntitySpacing-3*h.LINE_WIDTH)/2-(m.maxDepth-r.depth)*2*h.LINE_WIDTH,f=e.createGroup(n);r.label=r.kind+(r.label?": "+r.label:"");var p=c.createLabel(r,{x:a+h.LINE_WIDTH-u/2,y:m.arcRowHeight/4,width:u},{alignLeft:!0,ownBackground:!1,wordWrapArcs:m.wordWrapArcs}),d=t.getBBox(p),v=Math.max(d.height+2*h.LINE_WIDTH,m.arcRowHeight/2-2*h.LINE_WIDTH),g=Math.min(d.width+2*h.LINE_WIDTH,u),y=e.createEdgeRemark({width:g-h.LINE_WIDTH+s,height:v,x:a,y:0},"box",r.linecolor,r.textbgcolor,s);return f.appendChild(y),f.appendChild(p),f}function I(t){t.forEach(function(t){m.layer.defs.appendChild(q(t)),m.layer.inline.appendChild(e.createUse(0,u.get(t.rownum).y,t.id))})}function q(e){var t=u.get(e.rownum).y,n=u.get(e.rownum+e.arc.numberofrows+1).y,r=n-t;return e.arc.label="",J(e.id,l.getOAndD(e.arc.from,e.arc.to),e.arc,r)}function R(t,n,r,i){i||(i=n);if(!r||r<m.arcRowHeight)r=m.arcRowHeight;var s=e.createGroup(i);return t.forEach(function(t){var i=e.createLine({xFrom:l.getX(t.name),yFrom:0-r/2,xTo:l.getX(t.name),yTo:r/2},n);t.linecolor&&i.setAttribute("style","stroke : "+t.linecolor+";"),s.appendChild(i)}),s}function U(t,n,r,i,s){var o=2*(m.arcRowHeight/5),u=l.getDims().interEntitySpacing/2,c={};if(i){c=e.createGroup();var p=e.createUTurn({x:n,y:o/2},r+o-2*h.LINE_WIDTH,u-2*h.LINE_WIDTH,t!=="::"),d=e.createUTurn({x:n,y:o/2},r+o-h.LINE_WIDTH,u),v=e.createUTurn({x:n,y:o/2},r+o,u,t!=="::");p.setAttribute("style","stroke:"+s),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){d.setAttribute(e.name,e.value)}),d.setAttribute("style","stroke:transparent;"),v.setAttribute("style","stroke:"+s),c.appendChild(p),c.appendChild(v),c.appendChild(d)}else c=e.createUTurn({x:n,y:o/2},r+o,u,t==="-x"),f.getAttributes(a.get(),t,s,n,n).forEach(function(e){c.setAttribute(e.name,e.value)});return c}function z(e,t){var n;e.from&&e.to&&l.getX(e.from)>l.getX(e.to)&&o.swapfromto(e);switch(e.kind){case"...":case"|||":n=V(t,e);break;case"---":n=$(t,e)}return n}function W(e){return e.arcskip?e.arcskip*m.arcRowHeight:0}function X(t,r,i,s){var o=e.createGroup(t),u=r.kind==="<:>"?"bidi":r.kind==="::"?"nodi":"",p=[":>","::","<:>"].indexOf(r.kind)>-1,d=W(r),v=d===0?m.arcGradient:d;s=n.determineArcXTo(r.kind,i,s);if(i===s){o.appendChild(U(r.kind,i,d,p,r.linecolor));var g=2*l.getDims().interEntitySpacing/3;o.appendChild(c.createLabel(r,{x:i+1.5*h.LINE_WIDTH-g/2,y:0-m.arcRowHeight/5-h.LINE_WIDTH/2,width:g},{alignLeft:!0,alignAbove:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}else{var y=e.createLine({xFrom:i,yFrom:0,xTo:s,yTo:v},u,p);f.getAttributes(a.get(),r.kind,r.linecolor,i,s).forEach(function(e){y.setAttribute(e.name,e.value)}),o.appendChild(y),o.appendChild(c.createLabel(r,{x:i,y:0,width:s-i},{alignAround:!0,ownBackground:!0,wordWrapArcs:m.wordWrapArcs}))}return o}function V(t,n){var r=0,i=m.arcEndX,s=e.createGroup(t);return n.from&&n.to&&(r=l.getX(n.from),i=Math.abs(l.getX(n.to)-l.getX(n.from))),s.appendChild(c.createLabel(n,{x:r,y:0,width:i},{ownBackground:!0,wordWrapArcs:m.wordWrapArcs},t+"_lbl")),s}function $(t,n){var r=0,i=m.arcEndX,s="dotted",o=e.createGroup(t);if(n.from&&n.to){var u=(m.maxDepth-n.depth)*2*h.LINE_WIDTH;r=l.getX(n.from)-(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2-u,i=l.getX(n.to)+(l.getDims().interEntitySpacing+2*h.LINE_WIDTH)/2+u,s="striped"}var a=e.createLine({xFrom:r,yFrom:0,xTo:i,yTo:0},s);return o.appendChild(a),o.appendChild(V(t+"_txt",n)),n.linecolor&&a.setAttribute("style","stroke: "+n.linecolor+";"),o}function J(n,r,i,s){r.from>r.to&&o.swapfromto(r);var u=r.to-r.from+l.getDims().interEntitySpacing-2*h.LINE_WIDTH,a=6,f=r.from-(l.getDims().interEntitySpacing-2*h.LINE_WIDTH)/2,p=e.createGroup(n),d,v=c.createLabel(i,{x:f,y:0,width:u}),g=t.getBBox(v),y=s?s:Math.max(g.height+2*h.LINE_WIDTH,m.arcRowHeight-2*h.LINE_WIDTH),b={width:u,height:y,x:f,y:0-y/2};switch(i.kind){case"box":d=e.createRect(b,"box",i.linecolor,i.textbgcolor);break;case"rbox":d=e.createRect(b,"box",i.linecolor,i.textbgcolor,a,a);break;case"abox":b.y=0,d=e.createABox(b,"box",i.linecolor,i.textbgcolor);break;case"note":d=e.createNote(b,"box",i.linecolor,i.textbgcolor);break;default:var w=(m.maxDepth-i.depth)*2*h.LINE_WIDTH;d=e.createRect({width:u+w*2,height:y,x:f-w,y:0},"box",i.linecolor,i.textbgcolor)}return p.appendChild(d),p.appendChild(v),p}function K(e,n){m.document=r.init(n),t.init(m.document),t.removeRenderedSVGFromElement(e)}var p=3,d=38,v=0,m={arcRowHeight:d,arcGradient:v,arcEndX:0,wordWrapArcs:!1,maxDepth:0,document:{},layer:{defs:{},lifeline:{},sequence:{},notes:{},inline:{}}},g=[];return{clean:K,renderAST:y}}),n("utl/exporter",[],function(){"use strict";function t(e,t,n){return e.pathname+"?lang="+n+"&msc="+encodeURIComponent(t)}function n(n,r,i){return t(n,r,i).length<e}var e=4094;return{toLocationString:function(e,r,i){var s="# source too long for an URL";return n(e,r,i)&&(s=r),t(e,s,i)}}}),n("embedding/config",[],function(){"use strict";function t(e,t){Object.getOwnPropertyNames(t).forEach(function(n){e[n]=t[n]})}var e={defaultLanguage:"mscgen",parentElementPrefix:"mscgen_js-parent_",clickable:!1,clickURL:"https://sverweij.github.io/mscgen_js/",loadFromSrcAttribute:!1};return{getConfig:function(){return"undefined"!=typeof mscgen_js_config&&mscgen_js_config&&"object"==typeof mscgen_js_config&&t(e,mscgen_js_config),e}}}),n("utl/tpl",[],function(){"use strict";return{applyTemplate:function(t,n){var r=t;return!n||Object.keys(n).forEach(function(e){r=r.replace(new RegExp("{"+e+"}","g"),n[e])}),r}}}),n("embedding/error-rendering",["../utl/tpl"],function(e){"use strict";function s(e,t){var n=e.toString(),r=t-n.length;for(var i=0;i<r;i++)n=" "+n;return n}function o(e,t){return s(t,3)+" "+e}function u(t,n){return t.split("").reduce(function(t,r,s){return s===n?t+e.applyTemplate(i,{"char":a(r)}):t+a(r)},"")}function a(e){return e.replace(/</g,"&lt;")}var t="<pre><div style='color: red'># ERROR on line {line}, column {col} - {message}</div>",n="<pre><div style='color: red'># ERROR {message}</div>",r="<mark>{line}\n</mark>",i="<span style='text-decoration:underline'>{char}</span>";return{formatNumber:s,deHTMLize:a,renderError:function(s,f,l){var c=f?e.applyTemplate(t,{message:l,line:f.start.line,col:f.start.column}):e.applyTemplate(n,{message:l});return s.split("\n").reduce(function(t,n,i){return!f||i!==f.start.line-1?t+a(o(n,i+1))+"\n":t+e.applyTemplate(r,{line:o(u(n,f.start.column-1),i+1)})},c)+"</pre>"}}}),n("utl/domutl",[],function(){"use strict";return{ajax:function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(i){i.target.readyState===XMLHttpRequest.DONE&&(200===r.status?t(i):n(i))},r.open("GET",e),r.responseType="text";try{r.send()}catch(i){n(i)}}}}),t(["lib/mscgenjs-core/parse/xuparser","lib/mscgenjs-core/parse/msgennyparser","lib/mscgenjs-core/render/graphics/renderast","utl/exporter","embedding/config","embedding/error-rendering","utl/domutl","utl/tpl"],function(e,t,n,r,i,s,o,u){"use strict";function p(){d();var e=document.getElementsByClassName("mscgen_js");v(e,0),v(document.getElementsByTagName("mscgen"),e.length)}function d(){var e=document.scripts;for(var t=0;t<e.length;t++)!!h[e[t].type]&&!e[t].hasAttribute("data-renderedby")&&(e[t].insertAdjacentHTML("afterend",u.applyTemplate(a,{src:e[t].src?u.applyTemplate(f,{src:e[t].src}):"",lang:h[e[t].type]||i.getConfig().defaultLanguage,msc:e[t].textContent.replace(/</g,"&lt;")})),e[t].setAttribute("data-renderedby","mscgen_js"))}function v(e,t){for(var n=0;n<e.length;n++)m(e[n],t+n)}function m(e,t){e.hasAttribute("data-renderedby")||y(e,t)}function g(e,t){e.innerHTML=u.applyTemplate("<div style='color: red'>{string}</div>",{string:t})}function y(e,t){E(e,t),e.setAttribute("data-renderedby","mscgen_js"),i.getConfig().loadFromSrcAttribute&&!!e.getAttribute("data-src")?o.ajax(e.getAttribute("data-src"),function(n){b(e,n.target.response)},function(){g(e,u.applyTemplate(l,{url:e.getAttribute("data-src")}))}):!i.getConfig().loadFromSrcAttribute&&!!e.getAttribute("data-src")?g(e,u.applyTemplate(c,{url:e.getAttribute("data-src")})):b(e,e.textContent)}function b(e,t){var n=S(e),r=x(t,n);r.entities?T(r,e.id,t,n):e.innerHTML=s.renderError(t,r.location,r.message)}function w(e,t,n){var s={pathname:"index.html"},o=document.createElement("a");return o.setAttribute("href",i.getConfig().clickURL+r.toLocationString(s,e,t)),o.setAttribute("id",n+"link"),o.setAttribute("style","text-decoration: none;"),o.setAttribute("title","click to edit in the mscgen_js interpreter"),o}function E(e,t){e.id||(e.id=i.getConfig().parentElementPrefix+t.toString())}function S(e){var t=e.getAttribute("data-language");return t||(t=i.getConfig().defaultLanguage),t}function x(n,r){var i={};try{"msgenny"===r?i=t.parse(n):"json"===r?i=JSON.parse(n):i=e.parse(n)}catch(s){return s}return i}function T(e,t,r,s){var o=document.getElementById(t);o.innerHTML="",!0===i.getConfig().clickable&&(o.appendChild(w(r,s,t)),t+="link"),n.clean(t,window),n.renderAST(e,r,t,window)}var a="<span class='mscgen_js' {src} data-language='{lang}'>{msc}<span>",f="data-src='{src}' ",l="ERROR: Could not find or open the URL '{url}' specified in the <code>data-src</code> attribute.",c="ERROR: Won't load the chart specified in <code>data-src='{url}'</code>, because loading from separate files is switched off in the mscgen_js configuration. <br><br>See <a href='https://sverweij.github.io/mscgen_js/embed.html#loading-from-separate-files'>Loading charts from separate files</a> in the mscgen_js embedding guide how to enable it.",h={"text/x-mscgen":"mscgen","text/x-msgenny":"msgenny","text/x-xu":"xu"};p()}),n("mscgen-inpage",function(){})})();